# PENETRATION TESTING REPORT

## Information Gathering Web Assessment - inlanefreight.htb

**Formal Engagement Title:** External Web Reconnaissance and Information Gathering Assessment - inlanefreight.htb Lab Environment

---

## DATE_OF_TEST_EVENT

**Assessment Period:** January 3-4, 2026 (EST/UTC-5)

---

## TABLE_OF_CONTENTS

1. [Document Revision History](#document-revision-history)
2. [Statement of Confidentiality](#statement-of-confidentiality)
3. [Engagement Contacts](#engagement-contacts)
4. [Executive Summary](#executive-summary)
   - [Scenarios Included](#scenarios-included)
   - [Approach](#approach)
   - [Scope and Duration](#scope-and-duration)
   - [Assessment Overview and Recommendations](#assessment-overview-and-recommendations)
5. [Network Penetration Test Assessment Summary](#network-penetration-test-assessment-summary)
   - [Summary of Findings](#summary-of-findings)
6. [Technical Findings](#technical-findings)
   - [PT-001: Exposed API Key in Hidden Administrative Directory](#finding-id-pt-001)
   - [PT-002: Future API Key Disclosed in HTML Source Comments](#finding-id-pt-002)
   - [PT-003: Sensitive Directory Paths Disclosed in robots.txt](#finding-id-pt-003)
   - [PT-004: Missing Security Headers](#finding-id-pt-004)
   - [PT-005: Email Address Disclosure via Web Crawling](#finding-id-pt-005)
   - [PT-006: Undocumented Virtual Hosts and Development Environments](#finding-id-pt-006)
   - [PT-007: No Web Application Firewall Detected](#finding-id-pt-007)
7. [Internal Network Compromise Walkthrough](#internal-network-compromise-walkthrough)
8. [Remediation Summary](#remediation-summary)
   - [Short Term](#short-term)
   - [Medium Term](#medium-term)
   - [Long Term](#long-term)
9. [Answers to Assessment Questions](#answers-to-assessment-questions)
10. [Appendices](#appendices)
    - [Appendix A: Finding Severities](#appendix-a--finding-severities)
    - [Appendix B: Tools Used](#appendix-b--tools-used)
    - [Appendix C: Log File References](#appendix-c--log-file-references)
    - [Appendix D: Host Cleanup](#appendix-d--changeshost-cleanup)

---

## Document Revision History

| Author | Date | Version | Comment |
| ------ | ---- | ------- | ------- |
| Security Analyst | 2026-01-03 | 0.1 | Initial scan execution and data collection |
| Security Analyst | 2026-01-04 | 1.0 | Final report generation with all findings |

---

## STATEMENT OF CONFIDENTIALITY

This document contains sensitive security information, including system architecture details, vulnerabilities, and exploitation techniques. Distribution is restricted to authorized personnel only.

**Classification:** CONFIDENTIAL

The information contained within this report is intended solely for the use of the client organization. Unauthorized disclosure, copying, or distribution of this document or any of its contents is strictly prohibited.

**[STANDARD - Industry Best Practice]**

---

## ENGAGEMENT CONTACTS

| Contact | Title | Phone | Email |
| ------- | ----- | ----- | ----- |
| [Redacted] | Lead Penetration Tester | [Redacted] | [Redacted] |
| [Redacted] | Security Analyst | [Redacted] | [Redacted] |

**[NOTE]:** Contact information redacted for lab environment documentation purposes.

---

## EXECUTIVE SUMMARY

**[SOURCE: Expert Analysis based on scan logs]**

This section provides a high-level, non-technical overview of the penetration testing engagement, suitable for executive leadership and stakeholders without a security background.

The assessment evaluated the security posture of the `inlanefreight.htb` web environment against real-world information gathering attack scenarios. Testing focused on identifying exposed information, hidden resources, and misconfigurations that could lead to unauthorized access, data exposure, or service compromise.

**Overall Assessment:** The engagement identified **7 distinct findings** ranging from **High** to **Informational** severity. The most critical discoveries include **two exposed API keys** - one currently active in a hidden administrative directory and one planned future key disclosed in HTML source code comments. These findings indicate significant gaps in secrets management and code review practices.

**[FINDING - From Logs]:** API key `e963d863ee0e82ba7080fbf558ca0d3f` discovered in hidden admin directory (Source: [curl.log](scans/curl.log))

**[FINDING - From Logs]:** Future API key `ba988b835be4aa97d068941dc852ff33` discovered in HTML comments (Source: [spider_results.json](scans/spider_results.json))

While no active exploitation was performed during this reconnaissance-focused engagement, the presence of exploitable weaknesses indicates an elevated risk profile that should be addressed immediately.

---

### SCENARIOS INCLUDED

**[SOURCE: Executed scan logs and tasks.md scope definition]**

* **Passive Reconnaissance** – WHOIS lookup and domain registration information gathering for the production domain `inlanefreight.com` to obtain registrar details (Source: [final_recon.log](scans/final_recon.log))

* **Active Port Scanning** – Nmap service version detection and OS fingerprinting against target infrastructure (Source: [nmap.log](scans/nmap.log))

* **Web Server Fingerprinting** – HTTP header analysis and technology stack identification using WhatWeb, Nikto, and curl (Source: [whatweb.log](scans/whatweb.log), [nikto.log](scans/nikto.log), [curl.log](scans/curl.log))

* **Virtual Host Discovery** – Subdomain and virtual host brute-forcing using Gobuster to identify additional attack surface (Source: [gobuster.log](scans/gobuster.log))

* **Web Application Firewall Detection** – WAF fingerprinting using wafw00f (Source: [wafw00f.log](scans/wafw00f.log))

* **Web Crawling and Spidering** – Automated content discovery using ReconSpider to extract emails, comments, links, and sensitive data (Source: [recon_spider.log](scans/recon_spider.log), [spider_results.json](scans/spider_results.json))

---

### APPROACH

**[SOURCE: Industry Best Practice - OWASP Testing Guide, PTES]**

The assessment followed an industry-recognized penetration testing methodology combining automated tooling with manual validation and analysis.

Testing was conducted in phased stages:

1. **Reconnaissance Phase:** Passive information gathering via WHOIS and DNS lookups
2. **Enumeration Phase:** Active port scanning and service identification
3. **Fingerprinting Phase:** Web server and technology stack identification
4. **Discovery Phase:** Virtual host enumeration and directory brute-forcing
5. **Crawling Phase:** Automated web spidering for sensitive data extraction
6. **Analysis Phase:** Manual review and correlation of findings

All findings were manually verified against tool outputs. No active exploitation was performed during this information gathering engagement.

---

### SCOPE AND DURATION

**[SOURCE: tasks.md and scan log timestamps]**

| Host/IP/URL | Duration | Description |
| ----------- | -------- | ----------- |
| 83.136.249.34:37666 | Primary target | Main web application endpoint |
| 83.136.249.34:34778 | Secondary target | Development/secondary web endpoint |
| inlanefreight.htb | Virtual host | Primary virtual host domain |
| web1337.inlanefreight.htb | Virtual host (discovered) | Discovered subdomain virtual host |
| dev.web1337.inlanefreight.htb | Virtual host (discovered) | Development subdomain virtual host |
| inlanefreight.com | WHOIS only | Production domain for registrar lookup |

**Assessment Timeline:**
- **Scan Start:** 2026-01-03 19:14 EST (Source: [final_recon.log](scans/final_recon.log))
- **Scan End:** 2026-01-03 20:35 EST (Source: [nikto.log](scans/nikto.log))
- **Total Active Scan Duration:** Approximately 1 hour 21 minutes

**[CAVEAT]:** Systems explicitly listed were considered in-scope. The `.htb` TLD is a non-routable lab domain; WHOIS data was gathered from the production `inlanefreight.com` domain for reference purposes.

---

### ASSESSMENT OVERVIEW AND RECOMMENDATIONS

**[SOURCE: Expert Analysis based on aggregated findings]**

The assessment revealed several recurring themes requiring immediate attention:

**Critical Issues Identified:**
1. **Secrets Exposure:** Two API keys discovered through basic reconnaissance techniques, indicating complete lack of secrets management
2. **Development Environment Exposure:** Production-accessible development subdomain with sensitive comments in source code
3. **Information Disclosure:** robots.txt file actively advertising hidden administrative paths

**[RECOMMENDATION - Industry Best Practice]:**
- Implement a centralized secrets management solution (e.g., HashiCorp Vault, AWS Secrets Manager)
- Establish mandatory code review processes with automated secret scanning (e.g., git-secrets, truffleHog)
- Segment development environments from production-accessible infrastructure
- Implement security headers across all web properties
- Deploy a Web Application Firewall for defense-in-depth

---

## NETWORK PENETRATION TEST ASSESSMENT SUMMARY

**[SOURCE: nmap.log scan results]**

This section summarizes findings related specifically to network-level testing, including exposed services and service versions.

### Port Scan Results

**[FINDING - From nmap.log]:**

```
Target: inlanefreight.htb (83.136.249.34)
Scan Type: -sC -sV (Default scripts, Version detection)
Scan Date: 2026-01-03 20:26 EST
```

| Port | State | Service | Version | Notes |
| ---- | ----- | ------- | ------- | ----- |
| 19/tcp | filtered | chargen | - | Filtered by firewall |
| 22/tcp | open | ssh | OpenSSH 9.2p1 Debian 2+deb12u3 | Protocol 2.0 |
| 111/tcp | open | rpcbind | 2-4 (RPC #100000) | RPC service exposed |
| 139/tcp | filtered | netbios-ssn | - | Filtered by firewall |
| 445/tcp | filtered | microsoft-ds | - | Filtered by firewall |
| 44443/tcp | open | http | Apache httpd 2.4.41 | Ubuntu server |
| 50000/tcp | open | http | Apache httpd 2.4.41 | Ubuntu server |

**[FINDING - From nmap.log - OS Detection]:**
```
Aggressive OS guesses: Linux 5.0 - 5.14 (96%), MikroTik RouterOS 7.2 - 7.5 (Linux 5.6.3) (95%)
Network Distance: 15 hops
Service Info: Host: 192.168.94.62; OS: Linux; CPE: cpe:/o:linux:linux_kernel
```

**[CAVEAT]:** The nmap scan detected Apache httpd 2.4.41 on ports 44443 and 50000, while the in-scope web applications on ports 37666 and 34778 are running nginx/1.26.1. This suggests the target infrastructure hosts multiple web server configurations.

### SUMMARY OF FINDINGS

**[SOURCE: Aggregated from all scan logs]**

* **Web Server Software:** nginx/1.26.1 powering the primary virtual hosts (Source: [curl.log](scans/curl.log), [whatweb.log](scans/whatweb.log))
* **No WAF Detected:** All tested endpoints lack Web Application Firewall protection (Source: [wafw00f.log](scans/wafw00f.log))
* **Missing Security Headers:** X-Frame-Options and X-Content-Type-Options headers absent (Source: [nikto.log](scans/nikto.log))
* **Hidden Directories Disclosed:** robots.txt reveals sensitive paths (Source: [nikto.log](scans/nikto.log))
* **Multiple Virtual Hosts:** Subdomain enumeration revealed additional attack surface (Source: [gobuster.log](scans/gobuster.log))

---

## FINDING ID: PT-001

**Finding Title:** Exposed API Key in Hidden Administrative Directory

**Severity:** High
**Risk Rating:** CVSS v3.1: 7.5 (High) - AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N

**Mapped Controls:**
- NIST 800-53: SC-12 (Cryptographic Key Establishment and Management), SC-28 (Protection of Information at Rest)
- CWE-798: Use of Hard-coded Credentials
- OWASP Top 10: A01:2021 – Broken Access Control

**Impact:** Unauthorized access to API functionality; potential data exfiltration or service manipulation.

---

### SUMMARY

**[SOURCE: curl.log]**

A hidden administrative directory (`/admin_h1dd3n/`) was discovered on the `web1337.inlanefreight.htb` virtual host, which exposes an active API key in plain text within the HTML response body. This API key could be leveraged by an attacker to authenticate to backend API services.

---

### AFFECTED ASSETS

| Asset | IP / Hostname | Role | Environment |
| ----- | ------------- | ---- | ----------- |
| web1337.inlanefreight.htb:37666 | 83.136.249.34 | Web Application | Lab/Production |

---

### VULNERABILITY TYPE

* **Category:** Authentication, Secrets Management, Information Disclosure
* **Associated Weakness Class:** CWE-798: Use of Hard-coded Credentials, CWE-200: Exposure of Sensitive Information

---

### DESCRIPTION

**[FINDING - From curl.log]**

The hidden administrative directory `/admin_h1dd3n/` returns an HTML page containing an exposed API key. The directory name suggests an attempt at security through obscurity, which was trivially bypassed through robots.txt analysis and direct enumeration.

The exposed API key format (`e963d863ee0e82ba7080fbf558ca0d3f`) appears to be a 32-character hexadecimal string consistent with MD5 hash or UUID-derived key formats.

---

### ATTACK VECTOR

**[SOURCE: Expert Analysis]**

1. **Discovery Method:** The path `/admin_h1dd3n/` was disclosed in the `robots.txt` file (confirmed via [nikto.log](scans/nikto.log))
2. **Network Access:** Remote, unauthenticated
3. **Authentication Required:** None
4. **User Interaction:** None required

---

### PROOF OF CONCEPT / EVIDENCE

**[FINDING - Verbatim from curl.log]**

```
┌──(kali㉿kali)-[/mnt/htba/cases/info_gathering_web/lab/scans]
└─$ curl http://web1337.inlanefreight.htb:37666/admin_h1dd3n/
<!DOCTYPE html><html><head><title>web1337 admin</title></head><body><h1>Welcome to web1337 admin site</h1><h2>The admin panel is currently under maintenance, but the API is still accessible with the key e963d863ee0e82ba7080fbf558ca0d3f</h2></body></html>
```

**Extracted API Key:** `e963d863ee0e82ba7080fbf558ca0d3f`

---

### EXPLOITATION DETAILS

**[SOURCE: Expert Analysis - No active exploitation performed]**

Exploitation was not performed as this was an information gathering engagement. However, the exploitability is assessed as follows:

* **Exploit Complexity:** Very Low - simple HTTP GET request
* **Potential Access:** API authentication bypass
* **Tools Required:** Web browser or curl

---

### IMPACT

**[SOURCE: Expert Analysis]**

* **Data Exposure Risk:** HIGH - API keys typically grant access to backend data and functionality
* **Privilege Escalation Potential:** MEDIUM - depends on API permission scope
* **Lateral Movement Capability:** MEDIUM - API access may provide access to internal services
* **Service Availability Concerns:** LOW to MEDIUM - API abuse could impact service availability

---

### LIKELIHOOD

**[SOURCE: Expert Analysis]**

* **Attacker Skill Level Required:** Low (script kiddie level)
* **Exposure Surface:** Internet-accessible
* **Public Exploit Availability:** N/A (configuration issue, not software vulnerability)
* **Overall Likelihood:** HIGH - trivially discoverable via robots.txt

---

### RISK JUSTIFICATION

**[SOURCE: Expert Analysis]**

The High severity rating is justified because:
1. The API key is exposed without any authentication
2. Discovery requires only basic reconnaissance (robots.txt enumeration)
3. The potential impact of API key compromise is significant
4. No compensating controls (WAF, authentication) are in place

---

### RECOMMENDATIONS

**[SOURCE: Industry Best Practice]**

**Immediate Mitigation:**
1. Immediately rotate the exposed API key `e963d863ee0e82ba7080fbf558ca0d3f`
2. Remove the API key from the HTML response body
3. Restrict access to the `/admin_h1dd3n/` directory via IP allowlisting or authentication

**Long-term Corrective Actions:**
1. Implement a secrets management solution (HashiCorp Vault, AWS Secrets Manager)
2. Never embed API keys in client-facing HTML/JavaScript
3. Implement API key rotation policies
4. Use environment variables or secure configuration files for secrets

---

### VALIDATION / VERIFICATION STEPS

**[SOURCE: Expert Generated]**

1. Attempt to access `http://web1337.inlanefreight.htb:37666/admin_h1dd3n/`
2. Verify the response no longer contains the API key
3. Confirm the original API key has been invalidated
4. Verify new authentication controls are in place

---

### REFERENCES

* CWE-798: Use of Hard-coded Credentials - https://cwe.mitre.org/data/definitions/798.html
* CWE-200: Exposure of Sensitive Information - https://cwe.mitre.org/data/definitions/200.html
* OWASP API Security Top 10 - https://owasp.org/www-project-api-security/

---

### STATUS

**Open**

---

### NOTES

**[SOURCE: curl.log]**

The administrative page indicates the admin panel is "under maintenance" but the API remains accessible, suggesting this may be a temporary state with the expectation of re-enabling full admin functionality.

---

### RELATED FINDINGS

* PT-002: Future API Key Disclosed in HTML Source Comments
* PT-003: Sensitive Directory Paths Disclosed in robots.txt

---

## FINDING ID: PT-002

**Finding Title:** Future API Key Disclosed in HTML Source Comments

**Severity:** High
**Risk Rating:** CVSS v3.1: 7.5 (High) - AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N

**Mapped Controls:**
- NIST 800-53: SC-12 (Cryptographic Key Establishment and Management), CM-7 (Least Functionality)
- CWE-615: Inclusion of Sensitive Information in Source Code Comments
- OWASP Top 10: A01:2021 – Broken Access Control

**Impact:** Pre-compromise of future API credentials; attacker can prepare for credential rotation.

---

### SUMMARY

**[SOURCE: spider_results.json]**

Web crawling of the development subdomain `dev.web1337.inlanefreight.htb` revealed an HTML comment containing a future API key. This comment indicates developers are planning to rotate the current API key to a new value, but have inadvertently disclosed the new key before deployment.

---

### AFFECTED ASSETS

| Asset | IP / Hostname | Role | Environment |
| ----- | ------------- | ---- | ----------- |
| dev.web1337.inlanefreight.htb:34778 | 83.136.249.34 | Development Web Application | Development |

---

### VULNERABILITY TYPE

* **Category:** Information Disclosure, Secrets Management
* **Associated Weakness Class:** CWE-615: Inclusion of Sensitive Information in Source Code Comments

---

### DESCRIPTION

**[FINDING - From spider_results.json]**

The ReconSpider tool crawled 100 pages on the development subdomain and extracted HTML comments from the source code. One comment contained a developer note referencing an upcoming API key change:

```html
<!-- Remember to change the API key to ba988b835be4aa97d068941dc852ff33 -->
```

This represents a critical operational security failure where the new secret is exposed before it replaces the current one.

---

### ATTACK VECTOR

**[SOURCE: Expert Analysis]**

1. **Discovery Method:** Automated web spidering with comment extraction
2. **Network Access:** Remote, unauthenticated
3. **Authentication Required:** None
4. **User Interaction:** None required

---

### PROOF OF CONCEPT / EVIDENCE

**[FINDING - Verbatim from spider_results.json]**

```json
{
    "emails": [
        "1337testing@inlanefreight.htb"
    ],
    ...
    "comments": [
        "<!-- Remember to change the API key to ba988b835be4aa97d068941dc852ff33 -->"
    ]
}
```

**Extracted Future API Key:** `ba988b835be4aa97d068941dc852ff33`

**[FINDING - From recon_spider.log - Scan Statistics]**
```
'downloader/response_count': 100,
'downloader/response_status_count/200': 100,
'elapsed_time_seconds': 19.498102,
'request_depth_max': 99,
```

---

### EXPLOITATION DETAILS

**[SOURCE: Expert Analysis - No active exploitation performed]**

While active exploitation was not performed, the strategic implications are significant:

* **Pre-Rotation Compromise:** Attacker possesses the new API key before it becomes active
* **Persistence Strategy:** Attacker can maintain access through credential rotation
* **Detection Evasion:** Organization may believe rotation resolved the compromise

---

### IMPACT

**[SOURCE: Expert Analysis]**

* **Data Exposure Risk:** HIGH - Future credentials pre-compromised
* **Privilege Escalation Potential:** MEDIUM - depends on API scope
* **Lateral Movement Capability:** MEDIUM - API access to internal services
* **Service Availability Concerns:** LOW

---

### LIKELIHOOD

**[SOURCE: Expert Analysis]**

* **Attacker Skill Level Required:** Low
* **Exposure Surface:** Internet-accessible development environment
* **Overall Likelihood:** HIGH - automated tools easily extract HTML comments

---

### RISK JUSTIFICATION

**[SOURCE: Expert Analysis]**

High severity is appropriate because:
1. The future credential is exposed before deployment
2. Standard security response (key rotation) would be ineffective
3. Development environment is internet-accessible without access controls

---

### RECOMMENDATIONS

**[SOURCE: Industry Best Practice]**

**Immediate Mitigation:**
1. Do NOT use the disclosed key `ba988b835be4aa97d068941dc852ff33`
2. Generate a completely new API key that has never been exposed
3. Remove all HTML comments containing sensitive information
4. Restrict access to development environments

**Long-term Corrective Actions:**
1. Implement pre-commit hooks to scan for secrets (git-secrets, detect-secrets)
2. Use code review processes with security checklists
3. Never include credentials in source code or comments
4. Segment development environments from public access

---

### VALIDATION / VERIFICATION STEPS

**[SOURCE: Expert Generated]**

1. Re-crawl the development subdomain
2. Verify no HTML comments contain secrets
3. Confirm the exposed key was not deployed
4. Verify development environment access is restricted

---

### REFERENCES

* CWE-615: Inclusion of Sensitive Information in Source Code Comments - https://cwe.mitre.org/data/definitions/615.html
* OWASP: Information Exposure Through Comments - https://owasp.org/www-project-web-security-testing-guide/

---

### STATUS

**Open**

---

### NOTES

**[SOURCE: Expert Analysis]**

The presence of developer comments in production-accessible pages suggests a lack of build pipeline that strips comments from production deployments. Modern build tools (webpack, parcel) typically remove comments during minification.

---

### RELATED FINDINGS

* PT-001: Exposed API Key in Hidden Administrative Directory
* PT-006: Undocumented Virtual Hosts and Development Environments

---

## FINDING ID: PT-003

**Finding Title:** Sensitive Directory Paths Disclosed in robots.txt

**Severity:** Medium
**Risk Rating:** CVSS v3.1: 5.3 (Medium) - AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N

**Mapped Controls:**
- NIST 800-53: SC-7 (Boundary Protection), AC-3 (Access Enforcement)
- CWE-200: Exposure of Sensitive Information to an Unauthorized Actor
- OWASP: WSTG-INFO-01 (Conduct Search Engine Discovery)

**Impact:** Information disclosure facilitating targeted attacks on hidden resources.

---

### SUMMARY

**[SOURCE: nikto.log]**

The `robots.txt` file on `web1337.inlanefreight.htb` contains entries that disclose the existence of sensitive directories, including `/admin_h1dd3n/`. While robots.txt is intended to guide web crawlers, it paradoxically advertises the locations of hidden resources to attackers.

---

### AFFECTED ASSETS

| Asset | IP / Hostname | Role | Environment |
| ----- | ------------- | ---- | ----------- |
| web1337.inlanefreight.htb:37666 | 83.136.249.34 | Web Application | Lab/Production |

---

### VULNERABILITY TYPE

* **Category:** Information Disclosure, Misconfiguration
* **Associated Weakness Class:** CWE-200: Exposure of Sensitive Information

---

### DESCRIPTION

**[FINDING - From nikto.log]**

Nikto scan identified the robots.txt file contains 4 entries that should be manually reviewed. Critically, the `/admin_h1dd3n/` path was found to return HTTP 200 (accessible) rather than 403 (forbidden), indicating the robots.txt is actively advertising accessible sensitive content.

---

### PROOF OF CONCEPT / EVIDENCE

**[FINDING - Verbatim from nikto.log]**

```
+ /robots.txt: Entry '/index.html' is returned a non-forbidden or redirect HTTP code (200). See: https://portswigger.net/kb/issues/00600600_robots-txt-file
+ /robots.txt: Entry '/admin_h1dd3n/' is returned a non-forbidden or redirect HTTP code (200). See: https://portswigger.net/kb/issues/00600600_robots-txt-file
+ /robots.txt: contains 4 entries which should be manually viewed.
```

---

### RECOMMENDATIONS

**[SOURCE: Industry Best Practice]**

1. Remove references to sensitive directories from robots.txt
2. Implement proper access controls (authentication) on sensitive directories
3. Use robots.txt only for SEO purposes, not security
4. Monitor for robots.txt-based reconnaissance in web server logs

---

### STATUS

**Open**

---

### RELATED FINDINGS

* PT-001: Exposed API Key in Hidden Administrative Directory

---

## FINDING ID: PT-004

**Finding Title:** Missing Security Headers

**Severity:** Medium
**Risk Rating:** CVSS v3.1: 4.3 (Medium) - AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N

**Mapped Controls:**
- NIST 800-53: SC-8 (Transmission Confidentiality and Integrity)
- CWE-1021: Improper Restriction of Rendered UI Layers or Frames
- CWE-693: Protection Mechanism Failure
- OWASP: WSTG-CONF-07 (Test HTTP Strict Transport Security)

**Impact:** Increased susceptibility to clickjacking, MIME-type confusion, and other client-side attacks.

---

### SUMMARY

**[SOURCE: nikto.log]**

Security header analysis across all tested virtual hosts revealed the absence of critical security headers, specifically `X-Frame-Options` and `X-Content-Type-Options`. These headers provide defense-in-depth against common web attacks.

---

### AFFECTED ASSETS

| Asset | IP / Hostname | Role | Environment |
| ----- | ------------- | ---- | ----------- |
| inlanefreight.htb:37666 | 83.136.249.34 | Web Application | Lab/Production |
| web1337.inlanefreight.htb:37666 | 83.136.249.34 | Web Application | Lab/Production |
| dev.web1337.inlanefreight.htb:34778 | 83.136.249.34 | Development | Development |

---

### VULNERABILITY TYPE

* **Category:** Misconfiguration, Missing Security Controls
* **Associated Weakness Class:** CWE-1021, CWE-693

---

### DESCRIPTION

**[FINDING - From nikto.log]**

The following security headers are missing from HTTP responses:

| Header | Purpose | Status |
| ------ | ------- | ------ |
| X-Frame-Options | Prevents clickjacking attacks | **MISSING** |
| X-Content-Type-Options | Prevents MIME-type sniffing | **MISSING** |

---

### PROOF OF CONCEPT / EVIDENCE

**[FINDING - Verbatim from nikto.log]**

```
+ /: The anti-clickjacking X-Frame-Options header is not present. See: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options
+ /: The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type. See: https://www.netsparker.com/web-vulnerability-scanner/vulnerabilities/missing-content-type-header/
```

**[FINDING - From curl.log - Response Headers]**
```
HTTP/1.1 200 OK
Server: nginx/1.26.1
Date: Sun, 04 Jan 2026 00:21:35 GMT
Content-Type: text/html
Content-Length: 120
Last-Modified: Thu, 01 Aug 2024 09:35:23 GMT
Connection: keep-alive
ETag: "66ab56db-78"
Accept-Ranges: bytes
```

**[ANALYSIS - Expert]:** The response headers confirm only standard headers are present; no security headers are configured.

---

### RECOMMENDATIONS

**[SOURCE: Industry Best Practice]**

Add the following headers to nginx configuration:

```nginx
# Expert-generated configuration example
add_header X-Frame-Options "SAMEORIGIN" always;
add_header X-Content-Type-Options "nosniff" always;
add_header X-XSS-Protection "1; mode=block" always;
add_header Referrer-Policy "strict-origin-when-cross-origin" always;
add_header Content-Security-Policy "default-src 'self';" always;
add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;
```

---

### STATUS

**Open**

---

## FINDING ID: PT-005

**Finding Title:** Email Address Disclosure via Web Crawling

**Severity:** Low
**Risk Rating:** CVSS v3.1: 3.1 (Low) - AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N

**Mapped Controls:**
- NIST 800-53: AC-22 (Publicly Accessible Content)
- CWE-200: Exposure of Sensitive Information

**Impact:** Potential for targeted phishing attacks or social engineering.

---

### SUMMARY

**[SOURCE: spider_results.json]**

Web crawling discovered an email address embedded in the web application: `1337testing@inlanefreight.htb`. While email disclosure is common, this information could be leveraged for social engineering or phishing attacks.

---

### AFFECTED ASSETS

| Asset | IP / Hostname | Role | Environment |
| ----- | ------------- | ---- | ----------- |
| dev.web1337.inlanefreight.htb:34778 | 83.136.249.34 | Development | Development |

---

### PROOF OF CONCEPT / EVIDENCE

**[FINDING - Verbatim from spider_results.json]**

```json
{
    "emails": [
        "1337testing@inlanefreight.htb"
    ],
    ...
}
```

---

### RECOMMENDATIONS

**[SOURCE: Industry Best Practice]**

1. Review necessity of publishing email addresses
2. Use contact forms instead of direct email links
3. Implement email address obfuscation techniques
4. Train staff on phishing awareness

---

### STATUS

**Open**

---

## FINDING ID: PT-006

**Finding Title:** Undocumented Virtual Hosts and Development Environments

**Severity:** Medium
**Risk Rating:** CVSS v3.1: 5.3 (Medium) - AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N

**Mapped Controls:**
- NIST 800-53: CM-7 (Least Functionality), AC-3 (Access Enforcement)
- CWE-16: Configuration

**Impact:** Expanded attack surface; development environments often have weaker security controls.

---

### SUMMARY

**[SOURCE: gobuster.log]**

Virtual host enumeration discovered two additional subdomains not documented in the original scope:
- `web1337.inlanefreight.htb` (port 37666)
- `dev.web1337.inlanefreight.htb` (port 34778)

The development subdomain was internet-accessible and contained sensitive information (see PT-002).

---

### AFFECTED ASSETS

| Asset | IP / Hostname | Role | Environment |
| ----- | ------------- | ---- | ----------- |
| web1337.inlanefreight.htb:37666 | 83.136.249.34 | Web Application | Production |
| dev.web1337.inlanefreight.htb:34778 | 83.136.249.34 | Development | Development |

---

### PROOF OF CONCEPT / EVIDENCE

**[FINDING - Verbatim from gobuster.log]**

```
┌──(kali㉿kali)-[/mnt/htba/cases/info_gathering_web/lab/scans]
└─$ gobuster vhost -u http://inlanefreight.htb:37666 -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt --append-domain -t 25
===============================================================
Gobuster v3.8
...
web1337.inlanefreight.htb:37666 Status: 200 [Size: 104]
...

┌──(kali㉿kali)-[/mnt/htba/cases/info_gathering_web/lab/scans]
└─$ gobuster vhost -u http://web1337.inlanefreight.htb:34778 -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt --append-domain -t 25
...
dev.web1337.inlanefreight.htb:34778 Status: 200 [Size: 123]
...
```

---

### RECOMMENDATIONS

**[SOURCE: Industry Best Practice]**

1. Restrict development environment access to internal networks or VPN
2. Implement authentication on all non-production environments
3. Maintain an inventory of all virtual hosts and subdomains
4. Regularly audit DNS and virtual host configurations

---

### STATUS

**Open**

---

### RELATED FINDINGS

* PT-002: Future API Key Disclosed in HTML Source Comments

---

## FINDING ID: PT-007

**Finding Title:** No Web Application Firewall Detected

**Severity:** Informational
**Risk Rating:** N/A (Informational finding - defense-in-depth consideration)

**Mapped Controls:**
- NIST 800-53: SC-7 (Boundary Protection)
- CWE-693: Protection Mechanism Failure

**Impact:** Reduced defense-in-depth; attacks may not be detected or blocked at the network perimeter.

---

### SUMMARY

**[SOURCE: wafw00f.log]**

Web Application Firewall (WAF) detection using wafw00f confirmed that no WAF is protecting any of the tested endpoints. While not a vulnerability per se, the absence of a WAF reduces the organization's ability to detect and block web-based attacks.

---

### AFFECTED ASSETS

| Asset | IP / Hostname | Role | Environment |
| ----- | ------------- | ---- | ----------- |
| inlanefreight.htb:37666 | 83.136.249.34 | Web Application | Lab/Production |
| web1337.inlanefreight.htb:34778 | 83.136.249.34 | Web Application | Lab/Production |
| dev.web1337.inlanefreight.htb:34778 | 83.136.249.34 | Development | Development |

---

### PROOF OF CONCEPT / EVIDENCE

**[FINDING - Verbatim from wafw00f.log]**

```
[*] Checking http://inlanefreight.htb:37666
[+] Generic Detection results:
[-] No WAF detected by the generic detection
[~] Number of requests: 7

[*] Checking http://web1337.inlanefreight.htb:34778
[+] Generic Detection results:
[-] No WAF detected by the generic detection
[~] Number of requests: 7

[*] Checking http://dev.web1337.inlanefreight.htb:34778
[+] Generic Detection results:
[-] No WAF detected by the generic detection
[~] Number of requests: 7
```

---

### RECOMMENDATIONS

**[SOURCE: Industry Best Practice]**

1. Consider implementing a WAF solution (e.g., ModSecurity, AWS WAF, Cloudflare)
2. Configure WAF rules to detect common attack patterns (SQLi, XSS, LFI)
3. Enable WAF logging and integrate with SIEM
4. Regularly update WAF rule sets

---

### STATUS

**Open**

---

## INTERNAL NETWORK COMPROMISE WALKTHROUGH

**[SOURCE: Expert Analysis - Attack Chain Reconstruction]**

This section documents a representative attack path demonstrating how the discovered findings could be chained to achieve compromise.

### DETAILED WALKTHROUGH

**Phase 1: Reconnaissance**

1. **WHOIS Lookup** (Source: [final_recon.log](scans/final_recon.log))
   - Identified registrar: Amazon Registrar, Inc.
   - IANA ID: 468
   - Gathered organizational context and DNS infrastructure details

2. **Web Server Fingerprinting** (Source: [whatweb.log](scans/whatweb.log), [curl.log](scans/curl.log))
   - Identified web server: nginx/1.26.1
   - Confirmed HTTP 200 responses on target ports

**Phase 2: Virtual Host Discovery**

3. **Subdomain Enumeration** (Source: [gobuster.log](scans/gobuster.log))
   - Discovered `web1337.inlanefreight.htb` on port 37666
   - Discovered `dev.web1337.inlanefreight.htb` on port 34778
   - Wordlist: `/usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt`

**Phase 3: Sensitive Resource Discovery**

4. **Nikto Scan** (Source: [nikto.log](scans/nikto.log))
   - Identified robots.txt with 4 entries
   - Discovered `/admin_h1dd3n/` path disclosed and accessible

5. **Hidden Directory Access** (Source: [curl.log](scans/curl.log))
   - Accessed `http://web1337.inlanefreight.htb:37666/admin_h1dd3n/`
   - **Extracted API Key:** `e963d863ee0e82ba7080fbf558ca0d3f`

**Phase 4: Web Crawling**

6. **ReconSpider Execution** (Source: [recon_spider.log](scans/recon_spider.log), [spider_results.json](scans/spider_results.json))
   - Crawled 100 pages on development subdomain
   - Extracted email: `1337testing@inlanefreight.htb`
   - **Extracted Future API Key from Comment:** `ba988b835be4aa97d068941dc852ff33`

**Attack Chain Summary:**

```
[Reconnaissance] → [VHost Discovery] → [robots.txt Disclosure] → [Admin Directory Access] → [API Key Extraction] → [Web Crawling] → [Future API Key Extraction]
```

**[ANALYSIS - Expert Interpretation]:**

This attack chain demonstrates how basic reconnaissance techniques, requiring minimal skill, can lead to complete credential compromise. The organization's secrets management and access control deficiencies allowed an unauthenticated attacker to obtain both current and future API credentials within a single reconnaissance session.

---

## REMEDIATION SUMMARY

**[SOURCE: Industry Best Practice - Prioritized by Risk and Effort]**

This section provides a prioritized remediation roadmap based on risk and implementation effort.

### SHORT TERM

**Actions to complete within 0–30 days:**

| Priority | Action | Related Finding | Effort |
| -------- | ------ | --------------- | ------ |
| 1 | Immediately rotate API key `e963d863ee0e82ba7080fbf558ca0d3f` | PT-001 | Low |
| 2 | Do NOT deploy planned key `ba988b835be4aa97d068941dc852ff33`; generate new key | PT-002 | Low |
| 3 | Remove API key references from `/admin_h1dd3n/` HTML response | PT-001 | Low |
| 4 | Remove sensitive paths from robots.txt | PT-003 | Low |
| 5 | Remove HTML comments containing secrets from source code | PT-002 | Low |
| 6 | Implement authentication on `/admin_h1dd3n/` directory | PT-001 | Medium |
| 7 | Restrict access to development subdomain (VPN/IP allowlist) | PT-006 | Medium |

### MEDIUM TERM

**Actions to complete within 30–90 days:**

| Priority | Action | Related Finding | Effort |
| -------- | ------ | --------------- | ------ |
| 1 | Implement security headers on all web servers | PT-004 | Low |
| 2 | Deploy pre-commit hooks for secret scanning (git-secrets) | PT-001, PT-002 | Medium |
| 3 | Establish code review process with security checklists | PT-002 | Medium |
| 4 | Implement centralized secrets management solution | PT-001, PT-002 | High |
| 5 | Audit and document all virtual hosts and subdomains | PT-006 | Medium |
| 6 | Configure WAF for production environments | PT-007 | High |

### LONG TERM

**Actions requiring sustained effort or architectural changes:**

| Priority | Action | Related Finding | Effort |
| -------- | ------ | --------------- | ------ |
| 1 | Implement CI/CD pipeline with automated security scanning | All | High |
| 2 | Establish regular penetration testing cadence | All | Medium |
| 3 | Develop and enforce secure configuration baselines | PT-004 | High |
| 4 | Implement network segmentation for dev/staging/prod | PT-006 | High |
| 5 | Deploy comprehensive logging and SIEM integration | PT-007 | High |

---

## ANSWERS TO ASSESSMENT QUESTIONS

**[SOURCE: Evidence extracted from scan logs]**

This section provides direct answers to the assessment questions based on evidence gathered during the engagement.

### Question 1: What is the IANA ID of the registrar of the inlanefreight.com domain?

**Answer:** `468`

**[EVIDENCE - From final_recon.log]:**
```
Registrar: Amazon Registrar, Inc.
Registrar IANA ID: 468
```

---

### Question 2: What HTTP server software is powering the inlanefreight.htb site on the target system?

**Answer:** `nginx`

**[EVIDENCE - From curl.log]:**
```
HTTP/1.1 200 OK
Server: nginx/1.26.1
```

**[EVIDENCE - From whatweb.log]:**
```
http://inlanefreight.htb:37666 [200 OK] ... HTTPServer[nginx/1.26.1] ... nginx[1.26.1]
```

---

### Question 3: What is the API key in the hidden admin directory that you have discovered on the target system?

**Answer:** `e963d863ee0e82ba7080fbf558ca0d3f`

**[EVIDENCE - From curl.log]:**
```
└─$ curl http://web1337.inlanefreight.htb:37666/admin_h1dd3n/
<!DOCTYPE html><html><head><title>web1337 admin</title></head><body><h1>Welcome to web1337 admin site</h1><h2>The admin panel is currently under maintenance, but the API is still accessible with the key e963d863ee0e82ba7080fbf558ca0d3f</h2></body></html>
```

---

### Question 4: After crawling the inlanefreight.htb domain on the target system, what is the email address you have found?

**Answer:** `1337testing@inlanefreight.htb`

**[EVIDENCE - From spider_results.json]:**
```json
{
    "emails": [
        "1337testing@inlanefreight.htb"
    ],
    ...
}
```

---

### Question 5: What is the API key the inlanefreight.htb developers will be changing to?

**Answer:** `ba988b835be4aa97d068941dc852ff33`

**[EVIDENCE - From spider_results.json]:**
```json
{
    ...
    "comments": [
        "<!-- Remember to change the API key to ba988b835be4aa97d068941dc852ff33 -->"
    ]
}
```

---

## APPENDICES

### APPENDIX A – FINDING SEVERITIES

**[SOURCE: Industry Best Practice - CVSS v3.1 and Qualitative Assessment]**

| Severity | CVSS Score Range | Description |
| -------- | ---------------- | ----------- |
| **Critical** | 9.0 - 10.0 | Immediate exploitation possible with severe impact; requires emergency response |
| **High** | 7.0 - 8.9 | Exploitation likely with significant impact; prioritize for immediate remediation |
| **Medium** | 4.0 - 6.9 | Exploitation possible with moderate impact; address in normal patch cycle |
| **Low** | 0.1 - 3.9 | Exploitation difficult or impact minimal; address as resources permit |
| **Informational** | N/A | No direct security impact; best practice recommendations |

**Findings by Severity:**

| Severity | Count | Findings |
| -------- | ----- | -------- |
| High | 2 | PT-001, PT-002 |
| Medium | 3 | PT-003, PT-004, PT-006 |
| Low | 1 | PT-005 |
| Informational | 1 | PT-007 |

---

### APPENDIX B – TOOLS USED

**[SOURCE: Scan log headers and command outputs]**

| Tool | Version | Purpose |
| ---- | ------- | ------- |
| Nmap | 7.98 | Port scanning and service enumeration |
| Gobuster | 3.8 | Virtual host and directory brute-forcing |
| Nikto | 2.5.0 | Web vulnerability scanning |
| WhatWeb | (unspecified) | Web technology fingerprinting |
| wafw00f | 2.3.2 | Web Application Firewall detection |
| ReconSpider | (custom) | Web crawling and data extraction |
| FinalRecon | 1.1.7 | WHOIS and header analysis |
| curl | (system) | HTTP request testing |

---

### APPENDIX C – LOG FILE REFERENCES

**[SOURCE: ./cases/info_gathering_web/lab/scans/]**

| Log File | Description | Key Findings |
| -------- | ----------- | ------------ |
| [nmap.log](scans/nmap.log) | Port scan and service enumeration | Open ports, SSH/HTTP services |
| [curl.log](scans/curl.log) | HTTP header and response testing | nginx version, API key exposure |
| [gobuster.log](scans/gobuster.log) | Virtual host enumeration | web1337, dev subdomains |
| [nikto.log](scans/nikto.log) | Web vulnerability scan | Missing headers, robots.txt |
| [whatweb.log](scans/whatweb.log) | Technology fingerprinting | nginx/1.26.1 confirmation |
| [wafw00f.log](scans/wafw00f.log) | WAF detection | No WAF present |
| [recon_spider.log](scans/recon_spider.log) | Web spider execution log | 100 pages crawled |
| [spider_results.json](scans/spider_results.json) | Extracted spider data | Email, comments, links |
| [final_recon.log](scans/final_recon.log) | WHOIS and header recon | Registrar info, IANA ID |

---

### APPENDIX D – CHANGES/HOST CLEANUP

**[SOURCE: Assessment Documentation]**

| Action | Description | Status |
| ------ | ----------- | ------ |
| Host file modification | Added virtual hosts to local /etc/hosts | Documented in nikto.log |
| Data extraction | API keys extracted but not used | No exploitation performed |
| Web crawling | 100 pages accessed via spider | Read-only access |

**[CAVEAT]:** This was an information gathering engagement. No exploitation, file modifications, or persistent access was established on target systems.

---

### APPENDIX E – PASSWORD REVIEW

**[SOURCE: Not Applicable]**

No password-based authentication testing was performed during this information gathering engagement. The discovered API keys are documented in findings PT-001 and PT-002.

---

## REPORT GENERATION METADATA

**[SOURCE: Report Generation Process]**

| Attribute | Value |
| --------- | ----- |
| Report Generated | 2026-01-04 |
| Report Template | [media/pentest_report_template.md](../../media/pentest_report_template.md) |
| Evidence Location | [cases/info_gathering_web/lab/scans/](scans/) |
| Analyst | GitHub Copilot (Claude Opus 4.5) |

**Source Attribution Legend:**
- `[FINDING - From <log>]` - Direct evidence extracted from scan logs
- `[SOURCE: <log>]` - Section derived from specified log file
- `[ANALYSIS - Expert]` - Interpretation and analysis by security analyst
- `[RECOMMENDATION - Industry Best Practice]` - Standard security guidance
- `[CAVEAT]` - Limitations or assumptions
- `[Expert-generated]` - Code or configuration created by analyst

---

*End of Report*
