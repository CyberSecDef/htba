Target: 
    10.129.168.72

First Task:
    Our client wants to know if we can identify which operating system their provided machine
    is running on. Submit the OS name as the answer.

    We are currently going over the many nmap scans that can be run.

    Our target machine is protected with an IDS/IPS, so we need to be careful with our scanning techniques.

    Next Step (quiet Nmap)
        Goal: Identify a small set of responsive ports with minimal noise so OS fingerprinting (-O) has enough signal.

        Command:
            nmap -sS -Pn -n -T2 --max-retries 1 --scan-delay 200ms --max-rate 25 --top-ports 20 --reason -oN nmap_quiet_top20.txt 10.129.168.72

        Notes:
            - If the target appears very sensitive, increase delay/rate: e.g., --scan-delay 500ms --max-rate 10
            - Once you have at least 1 open and 1 closed port, run OS detection against only those ports with -O and --osscan-limit.    

        Results:
            Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-12-26 16:18 CST
            Nmap scan report for 10.129.168.72
            Host is up, received user-set (0.0091s latency).

            PORT     STATE    SERVICE       REASON
            21/tcp   closed   ftp           reset ttl 63
            22/tcp   open     ssh           syn-ack ttl 63
            23/tcp   closed   telnet        reset ttl 63
            25/tcp   filtered smtp          no-response
            53/tcp   filtered domain        no-response
            80/tcp   open     http          syn-ack ttl 63
            110/tcp  filtered pop3          no-response
            111/tcp  filtered rpcbind       no-response
            135/tcp  filtered msrpc         no-response
            139/tcp  filtered netbios-ssn   no-response
            143/tcp  filtered imap          no-response
            443/tcp  filtered https         no-response
            445/tcp  filtered microsoft-ds  no-response
            993/tcp  filtered imaps         no-response
            995/tcp  filtered pop3s         no-response
            1723/tcp closed   pptp          reset ttl 63
            3306/tcp closed   mysql         reset ttl 63
            3389/tcp closed   ms-wbt-server reset ttl 63
            5900/tcp closed   vnc           reset ttl 63
            8080/tcp closed   http-proxy    reset ttl 63

            Nmap done: 1 IP address (1 host up) scanned in 10.69 seconds


    Next Step (quiet OS fingerprinting)
        Goal: Run OS detection with minimal packets by limiting to known responsive ports.

        Command (uses 2 open + 1 closed port):
            nmap -sS -Pn -n -T2 --max-retries 1 --scan-delay 200ms --max-rate 25 -O --osscan-limit --max-os-tries 1 -p 22,80,21 --reason -oN nmap_quiet_os.txt 10.129.168.72

        Notes:
            - If OS detection is inconclusive, increase --max-os-tries to 2 (still fairly quiet).
            - Avoid adding scripts (-sC/--script) or version detection (-sV) until OS ID is complete; those are typically noisier.

        Results:
            Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-12-26 16:20 CST
            Nmap scan report for 10.129.168.72
            Host is up, received user-set (0.026s latency).

            PORT   STATE  SERVICE REASON
            21/tcp closed ftp     reset ttl 63
            22/tcp open   ssh     syn-ack ttl 63
            80/tcp open   http    syn-ack ttl 63
            Aggressive OS guesses: Linux 5.0 - 5.5 (95%), 
                Linux 3.1 (95%), 
                Linux 3.2 (95%), 
                AXIS 210A or 211 Network Camera (Linux 2.6.17) (94%), 
                Linux 4.15 - 5.8 (94%), 
                Linux 5.3 - 5.4 (94%), 
                Linux 2.6.32 (94%), 
                ASUS RT-N56U WAP (Linux 3.4) (93%), 
                Linux 3.16 (93%), 
                Sony X75CH-series Android TV (Android 5.0) (92%)
            No exact OS matches for host (test conditions non-ideal).
            Network Distance: 2 hops

            OS detection performed. Please report any incorrect results at https://nmap.org/submit/ .
            Nmap done: 1 IP address (1 host up) scanned in 6.21 seconds

        Conclusion:
            Because Port 80 was open, we performed captured a banner from the web server:
                nc 10.129.168.72 80
            This showed the server was running "Apache/2.4.29 (Ubuntu)"
    
Next Task:
    Target: 10.129.168.60

    Requirement: 
        After the configurations are transferred to the system, our client wants to know if it is 
        possible to find out our target's DNS server version. Submit the DNS server version of the 
        target as the answer.


    Next Step (quiet DNS version fingerprint)
        Goal: Touch only DNS (port 53) and do the lightest possible version detection.

        Command:
            nmap -sS -sU -Pn -n -T2 --max-retries 1 --scan-delay 300ms --max-rate 20 -p T:53,U:53 -sV --version-light --script dns-nsid --reason -oN nmap_dns_version_53.txt 10.129.168.60

        Notes:
            - If UDP 53 is heavily filtered, you may still get results from TCP 53.
            - Some DNS servers disable version disclosure; in that case Nmap may only identify the product family (e.g., "ISC BIND") or just "domain".
            - If this returns no version info, the next-lowest-noise non-Nmap check is a single CHAOS query:
                dig @10.129.168.60 chaos txt version.bind +short

        Results:
            Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-12-26 16:33 CST
            Nmap scan report for 10.129.168.60
            Host is up, received user-set (0.0098s latency).

            PORT   STATE    SERVICE REASON              VERSION
            53/tcp filtered domain  no-response
            53/udp open     domain  udp-response ttl 63 (unknown banner: HTB{GoTtgUnyze9Psw4vGjcuMpHRp})
            | dns-nsid: 
            |_  bind.version: HTB{GoTtgUnyze9Psw4vGjcuMpHRp}

            Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
            Nmap done: 1 IP address (1 host up) scanned in 17.88 seconds

        Conclusion:
            The DNS server version is "HTB{GoTtgUnyze9Psw4vGjcuMpHRp}"

Next Task:
    Now our client wants to know if it is possible to find out the version of the running services.
    Identify the version of service our client was talking about and submit the flag as the answer.

    Target:
        10.129.197.76

    Next Step (quiet service version fingerprint)
        Goal: Identify service versions on a small set of responsive ports with minimal noise.

        Step 1 (quiet port discovery â€” do this first):
            nmap -sS -Pn -n -T2 --max-retries 1 --scan-delay 200ms --max-rate 25 --top-ports 50 --reason -oN svcdisc_top50.txt 10.129.197.76

        Notes:
            - This keeps noise down by avoiding -sV until we know which ports are open.
            - After Step 1, run -sV only against the discovered OPEN ports (Step 2).
        
        Results:
            Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-12-26 16:42 CST
            Warning: 10.129.197.76 giving up on port because retransmission cap hit (1).
            Nmap scan report for 10.129.197.76
            Host is up, received user-set (0.068s latency).

            PORT      STATE    SERVICE          REASON
            21/tcp    closed   ftp              reset ttl 63
            22/tcp    open     ssh              syn-ack ttl 63
            23/tcp    closed   telnet           reset ttl 63
            25/tcp    filtered smtp             no-response
            26/tcp    filtered rsftp            no-response
            53/tcp    filtered domain           no-response
            80/tcp    open     http             syn-ack ttl 63
            81/tcp    filtered hosts2-ns        no-response
            110/tcp   filtered pop3             no-response
            111/tcp   filtered rpcbind          no-response
            113/tcp   filtered ident            no-response
            135/tcp   filtered msrpc            no-response
            139/tcp   filtered netbios-ssn      no-response
            143/tcp   filtered imap             no-response
            179/tcp   filtered bgp              no-response
            199/tcp   filtered smux             no-response
            443/tcp   filtered https            no-response
            445/tcp   filtered microsoft-ds     no-response
            465/tcp   filtered smtps            no-response
            514/tcp   filtered shell            no-response
            515/tcp   filtered printer          no-response
            548/tcp   filtered afp              no-response
            554/tcp   filtered rtsp             no-response
            587/tcp   filtered submission       no-response
            646/tcp   filtered ldp              no-response
            993/tcp   filtered imaps            no-response
            995/tcp   filtered pop3s            no-response
            1025/tcp  closed   NFS-or-IIS       reset ttl 63
            1026/tcp  closed   LSA-or-nterm     reset ttl 63
            1027/tcp  closed   IIS              reset ttl 63
            1433/tcp  closed   ms-sql-s         reset ttl 63
            1720/tcp  closed   h323q931         reset ttl 63
            1723/tcp  closed   pptp             reset ttl 63
            2000/tcp  closed   cisco-sccp       reset ttl 63
            2001/tcp  closed   dc               reset ttl 63
            3306/tcp  closed   mysql            reset ttl 63
            3389/tcp  closed   ms-wbt-server    reset ttl 63
            5060/tcp  closed   sip              reset ttl 63
            5666/tcp  closed   nrpe             reset ttl 63
            5900/tcp  closed   vnc              reset ttl 63
            6001/tcp  closed   X11:1            reset ttl 63
            8000/tcp  closed   http-alt         reset ttl 63
            8008/tcp  closed   http             reset ttl 63
            8080/tcp  closed   http-proxy       reset ttl 63
            8443/tcp  closed   https-alt        reset ttl 63
            8888/tcp  closed   sun-answerbook   reset ttl 63
            10000/tcp closed   snet-sensor-mgmt reset ttl 63
            32768/tcp closed   filenet-tms      reset ttl 63
            49152/tcp closed   unknown          reset ttl 63
            49154/tcp closed   unknown          reset ttl 63

            Nmap done: 1 IP address (1 host up) scanned in 17.14 seconds
        
        Step 2 (quiet version detection on open ports):
            nmap -sS -Pn -n -T2 --max-retries 1 --scan-delay 200ms --max-rate 25 -sV --version-light -p 22,80 --reason -oN svcfp_versions.txt 10.129.197.76

            Results:
                Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-12-26 16:44 CST
                Nmap scan report for 10.129.197.76
                Host is up, received user-set (0.0095s latency).

                PORT   STATE SERVICE REASON         VERSION
                22/tcp open  ssh     syn-ack ttl 63 OpenSSH 7.6p1 Ubuntu 4ubuntu0.7 (Ubuntu Linux; protocol 2.0)
                80/tcp open  http    syn-ack ttl 63 Apache httpd 2.4.29 ((Ubuntu))
                Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

                Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
                Nmap done: 1 IP address (1 host up) scanned in 6.70 seconds

        Step 3:
            nmap --script banner -p 1433,3306,5432,1521,27017,6379,9042,9200,7474 10.129.197.76

            Results:
                Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-12-26 16:49 CST
                Nmap scan report for 10.129.197.76
                Host is up (0.0094s latency).

                PORT      STATE  SERVICE
                1433/tcp  closed ms-sql-s
                1521/tcp  closed oracle
                3306/tcp  closed mysql
                5432/tcp  closed postgresql
                6379/tcp  closed redis
                7474/tcp  closed neo4j
                9042/tcp  closed unknown
                9200/tcp  closed wap-wsp
                27017/tcp closed mongod

                Nmap done: 1 IP address (1 host up) scanned in 0.21 seconds
