# PENETRATION TESTING REPORT

## DNS Footprinting Assessment – inlanefreight.htb Domain

**Target Environment:** Internal DNS Server  
**Assessment Type:** DNS Enumeration and Zone Transfer Analysis

## DATE_OF_TEST_EVENT

**Testing Period:** December 28, 2025 (EST)  
**Report Generated:** January 4, 2026

---

## TABLE_OF_CONTENTS

1. [Document Revision History](#document-revision-history)
2. [Statement of Confidentiality](#statement-of-confidentiality)
3. [Engagement Contacts](#engagement-contacts)
4. [Executive Summary](#executive-summary)
5. [Network Penetration Test Assessment Summary](#network-penetration-test-assessment-summary)
6. [Finding PT-001: DNS Zone Transfer Permitted](#finding-id-pt-001)
7. [Finding PT-002: BIND Version Disclosure](#finding-id-pt-002)
8. [Finding PT-003: DNS Server Hostname Disclosure](#finding-id-pt-003)
9. [Finding PT-004: Internal Network Architecture Exposure](#finding-id-pt-004)
10. [Remediation Summary](#remediation-summary)
11. [Appendices](#appendices)

---

## Document Revision History

| Author | Date | Version | Comment |
| ------ | ---- | ------- | ------- |
| Security Analyst | 2025-12-28 | 0.1 | Initial scan execution |
| Report Generator | 2026-01-04 | 1.0 | Full report generation |

---

## STATEMENT OF CONFIDENTIALITY

This document contains sensitive security information, including system architecture details, vulnerabilities, and exploitation techniques. Distribution is restricted to authorized personnel only.

---

## ENGAGEMENT CONTACTS

| Contact | Title | Phone | Email |
| ------- | ----- | ----- | ----- |
| *[REDACTED]* | Penetration Tester | *[REDACTED]* | *[REDACTED]* |
| *[REDACTED]* | Client Technical Contact | *[REDACTED]* | *[REDACTED]* |

---

## EXECUTIVE SUMMARY

> **[Source: Expert Analysis based on scan logs]**

This assessment evaluated the security posture of the DNS infrastructure serving the `inlanefreight.htb` domain. Testing focused on identifying vulnerabilities that could lead to unauthorized information disclosure, reconnaissance advantages for attackers, or service disruption.

### Overall Risk Assessment

**Critical security weaknesses were identified.** The DNS server permits unrestricted zone transfers (AXFR), exposing the complete internal DNS zone including all hostnames, IP addresses, and configuration details. This vulnerability, combined with version and hostname disclosure, provides attackers with comprehensive reconnaissance data that significantly reduces the effort required to plan and execute further attacks.

### Key Findings Summary

| Severity | Count | Description |
|----------|-------|-------------|
| **High** | 1 | Unrestricted DNS Zone Transfer (AXFR) |
| **Medium** | 2 | BIND Version Disclosure, Hostname Disclosure |
| **Low** | 1 | Internal Network Architecture Exposure via TXT Records |

### SCENARIOS INCLUDED

* *DNS Enumeration* – Assessment of DNS server configuration and information disclosure from an unauthenticated attacker perspective.
* *Zone Transfer Analysis* – Evaluation of AXFR permissions and exposed zone data.
* *Service Fingerprinting* – Identification of DNS software version and system hostname.

### APPROACH

> **[Source: Industry Best Practice – OWASP, PTES, NIST SP 800-115]**

The assessment followed an industry-recognized penetration testing methodology combining automated tooling with manual validation. Testing utilized the `dig` utility for DNS queries following standard reconnaissance techniques:

1. **SOA/NS Record Enumeration** – Identify authoritative nameservers
2. **Zone Transfer Attempt** – Test AXFR permissions
3. **Version Fingerprinting** – Query CHAOS TXT records
4. **Hostname Discovery** – Enumerate server identity
5. **Recursion Testing** – Assess open resolver risk

### SCOPE AND DURATION

| Host/IP/URL | Duration | Description |
| ----------- | -------- | ----------- |
| 10.129.54.123 | 2025-12-28 15:55–16:05 EST | Primary DNS Server (ns.inlanefreight.htb / NIX02) |

> **[Source: Log file timestamps from scans/*]**

### ASSESSMENT OVERVIEW AND RECOMMENDATIONS

> **[Source: Expert Analysis]**

The assessment revealed critical DNS misconfiguration allowing complete zone enumeration. The organization should immediately:

1. **Restrict zone transfers** to authorized secondary nameservers only
2. **Disable CHAOS class queries** to prevent version/hostname disclosure
3. **Review exposed TXT records** for sensitive information
4. **Implement DNS query logging** for security monitoring

---

## NETWORK PENETRATION TEST ASSESSMENT SUMMARY

> **[Source: Scan logs in cases/footprinting/dns/scans/*]**

### Target DNS Server Profile

| Attribute | Value | Source |
|-----------|-------|--------|
| IP Address | 10.129.54.123 | tasks.md |
| FQDN | ns.inlanefreight.htb | dig.ns-inlanefreight.htb-10.129.54.123.txt |
| Hostname | NIX02 | dig.hostname-bind-10.129.54.123.txt |
| Software | BIND 9.16.1-Ubuntu | dig.version-bind-10.129.54.123.txt |
| Recursion | Disabled (REFUSED) | dig.recursion-test-google.com-10.129.54.123.txt |
| Zone Transfer | **PERMITTED** | dig.axfr-inlanefreight.htb-10.129.54.123.txt |

### SUMMARY OF FINDINGS

> **[Source: Analysis of scan output files]**

* **CRITICAL:** Zone transfers (AXFR) are permitted to any requesting host, exposing complete zone data.
* **MEDIUM:** BIND version disclosed via CHAOS TXT query (version.bind), enabling targeted exploit research.
* **MEDIUM:** Server hostname disclosed via CHAOS TXT query (hostname.bind), aiding attacker reconnaissance.
* **LOW:** TXT records expose third-party service integrations (Microsoft 365, Google, Atlassian, Mailgun).

### DNS Records Discovered via Zone Transfer

> **[Source: dig.axfr-inlanefreight.htb-10.129.54.123.txt]**

| Record Type | Name | Value | TTL |
|-------------|------|-------|-----|
| SOA | inlanefreight.htb | inlanefreight.htb. root.inlanefreight.htb. | 1 week |
| NS | inlanefreight.htb | ns.inlanefreight.htb. | 1 week |
| TXT | inlanefreight.htb | "MS=ms97310371" | 1 week |
| TXT | inlanefreight.htb | "atlassian-domain-verification=t1rKCy68JFszSdCKVpw64A1QksWdXuYFUeSXKU" | 1 week |
| TXT | inlanefreight.htb | "v=spf1 include:mailgun.org include:_spf.google.com include:spf.protection.outlook.com include:_spf.atlassian.net ip4:10.129.124.8 ip4:10.129.127.2 ip4:10.129.42.106 ~all" | 1 week |
| A | app.inlanefreight.htb | 10.129.18.15 | 1 week |
| A | dev.inlanefreight.htb | 10.12.0.1 | 1 week |
| A | internal.inlanefreight.htb | 10.129.1.6 | 1 week |
| A | mail1.inlanefreight.htb | 10.129.18.201 | 1 week |
| A | ns.inlanefreight.htb | 127.0.0.1 | 1 week |

**Total Records:** 11 (as reported by dig)

---

## FINDING ID: PT-001

**Finding Title:** Unrestricted DNS Zone Transfer (AXFR) Permitted

**Severity:** High  
**Risk Rating:** CVSS v3.1: 7.5 (High) – AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N  

**Mapped Controls:**
- STIG: BIND DNS V8R15 – Rule ID SV-215594r
- NIST 800-53: SC-8 (Transmission Confidentiality and Integrity), AC-3 (Access Enforcement)
- RMF Families: SC, AC
- CIS Controls: Control 12 – Network Infrastructure Management

**Impact:** Complete disclosure of internal DNS zone, enabling comprehensive reconnaissance.

---

### SUMMARY

> **[Source: Expert Analysis]**

The DNS server permits zone transfer (AXFR) requests from any host without authentication or IP-based restrictions. This allows an unauthenticated attacker to obtain a complete copy of the DNS zone, revealing all hostnames, IP addresses, mail servers, and associated metadata within the domain.

---

### AFFECTED ASSETS

| Asset | IP / Hostname | Role | Environment |
| ----- | ------------- | ---- | ----------- |
| Primary DNS Server | 10.129.54.123 / ns.inlanefreight.htb | Authoritative Nameserver | Production |

> **[Source: dig.ns-inlanefreight.htb-10.129.54.123.txt, dig.axfr-inlanefreight.htb-10.129.54.123.txt]**

---

### VULNERABILITY TYPE

* **Category:** Misconfiguration, Information Disclosure
* **Associated weakness class:** CWE-200: Exposure of Sensitive Information to an Unauthorized Actor

---

### DESCRIPTION

> **[Source: dig.axfr-inlanefreight.htb-10.129.54.123.txt]**

DNS zone transfers (AXFR) are designed for replication between primary and secondary authoritative nameservers. When unrestricted, any client can request the complete zone file.

The target server at 10.129.54.123 responds to AXFR queries without restriction, returning 11 DNS records including:

- SOA and NS records identifying the authoritative server
- Multiple A records mapping internal hostnames to IP addresses
- TXT records containing domain verification tokens and SPF configuration
- Administrative contact information (root.inlanefreight.htb)

---

### ATTACK VECTOR

> **[Source: logs/commands.log, Expert Analysis]**

* **Network access requirements:** Remote network access to TCP port 53
* **Authentication requirements:** None
* **User interaction:** None

An attacker can execute this attack with a single command from any network location that can reach the DNS server on TCP/53.

---

### PROOF OF CONCEPT / EVIDENCE

> **[Source: dig.axfr-inlanefreight.htb-10.129.54.123.txt – DIRECT LOG EXTRACT]**

```text
dig @10.129.54.123 inlanefreight.htb AXFR +multi +stats +ttlunits

; <<>> DiG 9.20.15-2-Debian <<>> @10.129.54.123 inlanefreight.htb AXFR +multi +stats +ttlunits
; (1 server found)
;; global options: +cmd
inlanefreight.htb.	1w IN SOA inlanefreight.htb. root.inlanefreight.htb. (
				2          ; serial
				604800     ; refresh (1 week)
				86400      ; retry (1 day)
				2419200    ; expire (4 weeks)
				604800     ; minimum (1 week)
				)
inlanefreight.htb.	1w IN TXT "MS=ms97310371"
inlanefreight.htb.	1w IN TXT "atlassian-domain-verification=t1rKCy68JFszSdCKVpw64A1QksWdXuYFUeSXKU"
inlanefreight.htb.	1w IN TXT "v=spf1 include:mailgun.org include:_spf.google.com include:spf.protection.outlook.com include:_spf.atlassian.net ip4:10.129.124.8 ip4:10.129.127.2 ip4:10.129.42.106 ~all"
inlanefreight.htb.	1w IN NS ns.inlanefreight.htb.
app.inlanefreight.htb.	1w IN A	10.129.18.15
dev.inlanefreight.htb.	1w IN A	10.12.0.1
internal.inlanefreight.htb. 1w IN A 10.129.1.6
mail1.inlanefreight.htb. 1w IN A 10.129.18.201
ns.inlanefreight.htb.	1w IN A	127.0.0.1
inlanefreight.htb.	1w IN SOA inlanefreight.htb. root.inlanefreight.htb. (
				2          ; serial
				604800     ; refresh (1 week)
				86400      ; retry (1 day)
				2419200    ; expire (4 weeks)
				604800     ; minimum (1 week)
				)
;; Query time: 27 msec
;; SERVER: 10.129.54.123#53(10.129.54.123) (TCP)
;; WHEN: Sun Dec 28 16:05:06 EST 2025
;; XFR size: 11 records (messages 1, bytes 560)
```

---

### EXPLOITATION DETAILS

> **[Source: Scan evidence – dig.axfr-inlanefreight.htb-10.129.54.123.txt]**

* **Steps taken:** Single AXFR query using dig utility
* **Tools used:** dig (BIND utilities)
* **Level of access obtained:** Complete zone file disclosure (read-only)
* **Limitations:** Read-only access; no modification capability

The zone transfer completed successfully, returning the complete zone in a single TCP transaction (560 bytes).

---

### IMPACT

> **[Source: Expert Analysis / Industry Best Practice]**

* **Data exposure risk:** HIGH – Complete internal network topology exposed
* **Reconnaissance value:** HIGH – Attacker gains comprehensive target list:
  - `app.inlanefreight.htb` (10.129.18.15) – Application server
  - `dev.inlanefreight.htb` (10.12.0.1) – Development server
  - `internal.inlanefreight.htb` (10.129.1.6) – Internal services
  - `mail1.inlanefreight.htb` (10.129.18.201) – Mail server
* **Lateral movement capability:** Enables targeted attacks against discovered hosts
* **Third-party exposure:** SPF record reveals Mailgun, Google, Microsoft 365, Atlassian integrations

---

### LIKELIHOOD

> **[Source: Expert Analysis]**

* **Attacker skill level required:** Low (single command execution)
* **Exposure surface:** Any host with network access to TCP/53
* **Availability of public exploits:** Built-in functionality in dig, nslookup, host utilities
* **Detection likelihood:** Low without DNS query logging

**Assessment: Highly Likely** – Trivial to execute, commonly attempted in reconnaissance phases.

---

### RISK JUSTIFICATION

> **[Source: Expert Analysis]**

The High severity rating is justified because:
1. No authentication required
2. Attack is trivially executed
3. Complete zone disclosure occurs
4. Exposed data directly enables further attacks
5. CVSS base score of 7.5 reflects high confidentiality impact

---

### RECOMMENDATIONS

> **[Source: Industry Best Practice – NIST, CIS, BIND Administrator's Guide]**

**Immediate mitigation steps:**
1. Configure `allow-transfer` directive in BIND to restrict AXFR to authorized secondary nameservers only:
   ```
   options {
       allow-transfer { <secondary-ns-ip>; };
   };
   ```

2. If no secondary nameservers exist, disable zone transfers entirely:
   ```
   options {
       allow-transfer { none; };
   };
   ```

**Long-term corrective actions:**
- Implement TSIG (Transaction Signature) for authenticated zone transfers
- Enable DNS query logging for security monitoring
- Conduct periodic DNS security audits

---

### VALIDATION / VERIFICATION STEPS

> **[Source: Expert-Generated]**

After remediation, execute the following command:

```bash
dig @10.129.54.123 inlanefreight.htb AXFR
```

**Expected Result:** The query should return `Transfer failed.` or a REFUSED status rather than zone data.

---

### REFERENCES

* CWE-200: Exposure of Sensitive Information to an Unauthorized Actor
* NIST SP 800-81-2: Secure Domain Name System (DNS) Deployment Guide
* CIS BIND DNS Benchmark v2.0.0
* RFC 5936: DNS Zone Transfer Protocol (AXFR)
* DISA STIG: BIND 9.x Security Technical Implementation Guide

---

### STATUS

**Open**

---

### NOTES

> **[Source: Log Analysis]**

Additional zone transfer attempts were logged against subdomains:
- `internal.inlanefreight.htb`
- `root.inlanefreight.htb`
- `dev.inlanefreight.htb`

These attempts are documented in `logs/commands.log` (lines 17-19, 34-40), indicating the tester explored nested zone configurations.

---

### RELATED FINDINGS

- PT-002: BIND Version Disclosure
- PT-004: Internal Network Architecture Exposure

---

## FINDING ID: PT-002

**Finding Title:** BIND DNS Server Version Disclosure

**Severity:** Medium  
**Risk Rating:** CVSS v3.1: 5.3 (Medium) – AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N

**Mapped Controls:**
- STIG: BIND DNS V8R15 – Rule ID SV-215597r
- NIST 800-53: SC-7 (Boundary Protection), CM-7 (Least Functionality)
- RMF Families: SC, CM
- CIS Controls: Control 4 – Secure Configuration

**Impact:** Enables targeted vulnerability research against specific BIND version.

---

### SUMMARY

> **[Source: Expert Analysis]**

The DNS server discloses its software version (BIND 9.16.1-Ubuntu) when queried via the CHAOS class `version.bind` TXT record. This information enables attackers to research known vulnerabilities specific to this version.

---

### AFFECTED ASSETS

| Asset | IP / Hostname | Role | Environment |
| ----- | ------------- | ---- | ----------- |
| Primary DNS Server | 10.129.54.123 / ns.inlanefreight.htb | Authoritative Nameserver | Production |

> **[Source: dig.version-bind-10.129.54.123.txt]**

---

### VULNERABILITY TYPE

* **Category:** Information Disclosure, Misconfiguration
* **Associated weakness class:** CWE-200: Exposure of Sensitive Information

---

### DESCRIPTION

> **[Source: dig.version-bind-10.129.54.123.txt]**

BIND DNS servers, by default, respond to CHAOS class TXT queries for `version.bind` with the software version string. The target server returns:

```
version.bind.		0s CH TXT "9.16.1-Ubuntu"
```

BIND 9.16.1 was released in March 2020. While not immediately exploitable, this disclosure:
- Confirms the exact software and version in use
- Enables targeted CVE research
- Indicates the server may not be running the latest security patches

---

### ATTACK VECTOR

> **[Source: Expert Analysis]**

* **Network access requirements:** UDP or TCP port 53
* **Authentication requirements:** None
* **User interaction:** None

---

### PROOF OF CONCEPT / EVIDENCE

> **[Source: dig.version-bind-10.129.54.123.txt – DIRECT LOG EXTRACT]**

```text
dig @10.129.54.123 CHAOS TXT version.bind +multi +stats +ttlunits

; <<>> DiG 9.20.15-2-Debian <<>> @10.129.54.123 CHAOS TXT version.bind +multi +stats +ttlunits
; (1 server found)
;; global options: +cmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 8516
;; flags: qr aa rd; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1
;; WARNING: recursion requested but not available

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 4096
; COOKIE: 7049ba777e9855e8010000006951990f7ee3a09a3041aba9 (good)
;; QUESTION SECTION:
;version.bind.		CH TXT

;; ANSWER SECTION:
version.bind.		0s CH TXT "9.16.1-Ubuntu"

;; Query time: 31 msec
;; SERVER: 10.129.54.123#53(10.129.54.123) (UDP)
;; WHEN: Sun Dec 28 15:55:04 EST 2025
;; MSG SIZE  rcvd: 95
```

---

### EXPLOITATION DETAILS

> **[Source: Log Evidence]**

No direct exploitation was performed. The information was obtained via a standard CHAOS class query.

**Potential Exploitation Path:** An attacker could research CVE database for BIND 9.16.1 vulnerabilities and craft targeted exploits.

---

### IMPACT

> **[Source: Expert Analysis]**

* **Data exposure risk:** LOW – Version string only
* **Reconnaissance value:** MEDIUM – Confirms software stack
* **Privilege escalation potential:** Indirect – Enables targeted exploit research

---

### LIKELIHOOD

> **[Source: Expert Analysis]**

* **Attacker skill level required:** Low
* **Exposure surface:** Any network access to DNS port
* **Availability of public exploits:** Standard reconnaissance technique

**Assessment: Likely** – Common early-stage reconnaissance activity.

---

### RISK JUSTIFICATION

> **[Source: Expert Analysis]**

Medium severity is appropriate because:
1. Information disclosure only (no direct compromise)
2. Enables targeted attack research
3. Commonly exploited for reconnaissance
4. Easy to remediate

---

### RECOMMENDATIONS

> **[Source: Industry Best Practice – BIND Administrator Reference Manual]**

**Immediate mitigation steps:**

Configure BIND to suppress or spoof version information:

```
options {
    version "Not disclosed";
    // OR
    version none;
};
```

**Long-term corrective actions:**
- Upgrade BIND to the latest stable release
- Establish patch management policy for DNS infrastructure
- Consider blocking CHAOS class queries at firewall level

---

### VALIDATION / VERIFICATION STEPS

> **[Source: Expert-Generated]**

```bash
dig @10.129.54.123 CHAOS TXT version.bind
```

**Expected Result:** Empty response, REFUSED, or a non-informative string.

---

### REFERENCES

* CWE-200: Exposure of Sensitive Information
* BIND 9 Administrator Reference Manual – Chapter 6: BIND Configuration
* CIS BIND DNS Benchmark: 2.1 – Hide BIND Version

---

### STATUS

**Open**

---

### RELATED FINDINGS

- PT-001: DNS Zone Transfer Permitted
- PT-003: DNS Server Hostname Disclosure

---

## FINDING ID: PT-003

**Finding Title:** DNS Server Hostname Disclosure via CHAOS Query

**Severity:** Medium  
**Risk Rating:** CVSS v3.1: 5.3 (Medium) – AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N

**Mapped Controls:**
- STIG: BIND DNS V8R15 – Rule ID SV-215598r
- NIST 800-53: SC-7, CM-7
- RMF Families: SC, CM

**Impact:** Exposes internal server naming convention and identity.

---

### SUMMARY

> **[Source: Expert Analysis]**

The DNS server discloses its hostname (NIX02) when queried via the CHAOS class `hostname.bind` TXT record. This reveals internal naming conventions and confirms the server identity.

---

### AFFECTED ASSETS

| Asset | IP / Hostname | Role | Environment |
| ----- | ------------- | ---- | ----------- |
| Primary DNS Server | 10.129.54.123 / NIX02 | Authoritative Nameserver | Production |

> **[Source: dig.hostname-bind-10.129.54.123.txt]**

---

### VULNERABILITY TYPE

* **Category:** Information Disclosure
* **Associated weakness class:** CWE-200: Exposure of Sensitive Information

---

### DESCRIPTION

> **[Source: dig.hostname-bind-10.129.54.123.txt]**

The CHAOS class `hostname.bind` query returns the server's configured hostname:

```
hostname.bind.		0s CH TXT "NIX02"
```

This reveals:
- The server is a Linux/Unix system (NIX prefix)
- It appears to be the second server of its type (02 suffix)
- Internal naming conventions follow a predictable pattern

---

### PROOF OF CONCEPT / EVIDENCE

> **[Source: dig.hostname-bind-10.129.54.123.txt – DIRECT LOG EXTRACT]**

```text
dig @10.129.54.123 CHAOS TXT hostname.bind +multi +stats +ttlunits

; <<>> DiG 9.20.15-2-Debian <<>> @10.129.54.123 CHAOS TXT hostname.bind +multi +stats +ttlunits
; (1 server found)
;; global options: +cmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 33586
;; flags: qr aa rd; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1
;; WARNING: recursion requested but not available

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 4096
; COOKIE: 42c4d405fd79c0a6010000006951991a5dba672a545ab1d7 (good)
;; QUESTION SECTION:
;hostname.bind.		CH TXT

;; ANSWER SECTION:
hostname.bind.		0s CH TXT "NIX02"

;; Query time: 27 msec
;; SERVER: 10.129.54.123#53(10.129.54.123) (UDP)
;; WHEN: Sun Dec 28 15:55:16 EST 2025
;; MSG SIZE  rcvd: 88
```

---

### IMPACT

> **[Source: Expert Analysis]**

* **Data exposure risk:** LOW
* **Reconnaissance value:** MEDIUM – Confirms server identity and naming pattern
* **Social engineering potential:** Could be used in targeted phishing

---

### RECOMMENDATIONS

> **[Source: Industry Best Practice]**

Configure BIND to suppress hostname disclosure:

```
options {
    hostname "";
    // OR
    hostname none;
};
```

---

### STATUS

**Open**

---

### RELATED FINDINGS

- PT-002: BIND Version Disclosure

---

## FINDING ID: PT-004

**Finding Title:** Internal Network Architecture Exposure via DNS Records

**Severity:** Low  
**Risk Rating:** CVSS v3.1: 3.7 (Low) – AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N

**Mapped Controls:**
- NIST 800-53: SC-7, SA-8 (Security Engineering Principles)
- RMF Families: SC, SA

**Impact:** TXT records expose third-party service integrations and internal IP addressing.

---

### SUMMARY

> **[Source: Expert Analysis]**

The DNS zone contains TXT records that expose organizational infrastructure details including:
- Third-party service integrations (Microsoft 365, Google, Atlassian, Mailgun)
- Internal IP addresses used for SPF validation
- Domain verification tokens

---

### AFFECTED ASSETS

| Asset | IP / Hostname | Role | Environment |
| ----- | ------------- | ---- | ----------- |
| DNS Zone | inlanefreight.htb | Domain Zone | Production |

---

### DESCRIPTION

> **[Source: dig.axfr-inlanefreight.htb-10.129.54.123.txt]**

The following TXT records expose sensitive information:

**Microsoft 365 Domain Verification:**
```
inlanefreight.htb.	1w IN TXT "MS=ms97310371"
```

**Atlassian Domain Verification:**
```
inlanefreight.htb.	1w IN TXT "atlassian-domain-verification=t1rKCy68JFszSdCKVpw64A1QksWdXuYFUeSXKU"
```

**SPF Record with Internal IPs:**
```
inlanefreight.htb.	1w IN TXT "v=spf1 include:mailgun.org include:_spf.google.com include:spf.protection.outlook.com include:_spf.atlassian.net ip4:10.129.124.8 ip4:10.129.127.2 ip4:10.129.42.106 ~all"
```

---

### IMPACT

> **[Source: Expert Analysis]**

* **Data exposure risk:** LOW – Configuration data only
* **Reconnaissance value:** MEDIUM – Reveals technology stack
* **Business risk:** Verification tokens could potentially be abused

The SPF record reveals:
- Internal mail servers: 10.129.124.8, 10.129.127.2, 10.129.42.106
- Email services: Mailgun (transactional), Google Workspace, Microsoft 365, Atlassian

---

### RECOMMENDATIONS

> **[Source: Industry Best Practice]**

**Immediate:**
- Review necessity of each TXT record
- Ensure verification tokens are still required
- Consider the exposure trade-off of zone transfer vulnerability

**Long-term:**
- Document all DNS TXT records and their purpose
- Establish change management for DNS record modifications
- Periodically audit DNS records for obsolete entries

---

### STATUS

**Open**

---

### NOTES

> **[Source: Expert Analysis]**

This finding has lower severity because TXT records are intentionally public (required for SPF/DKIM/domain verification). However, the combination with unrestricted zone transfer amplifies the reconnaissance value.

---

## REMEDIATION SUMMARY

> **[Source: Expert Analysis / Industry Best Practice]**

### SHORT TERM (0–30 Days)

| Priority | Action | Finding |
|----------|--------|---------|
| **Critical** | Restrict zone transfers to authorized secondary nameservers only | PT-001 |
| **High** | Disable CHAOS class version disclosure | PT-002 |
| **High** | Disable CHAOS class hostname disclosure | PT-003 |
| **Medium** | Review and audit TXT records | PT-004 |

**BIND Configuration Changes Required:**

```
# /etc/bind/named.conf.options (or equivalent)

options {
    # Restrict zone transfers
    allow-transfer { none; };
    # Or specify authorized secondary NS:
    # allow-transfer { 10.x.x.x; };
    
    # Suppress version information
    version "Not disclosed";
    
    # Suppress hostname information
    hostname none;
};
```

### MEDIUM TERM (30–90 Days)

- Implement TSIG authentication for zone transfers (if secondary nameservers exist)
- Enable comprehensive DNS query logging
- Deploy DNS security monitoring
- Update BIND to latest stable release

### LONG TERM (90+ Days)

- Establish periodic DNS security audits
- Implement DNSSEC for zone integrity
- Consider DNS firewall / Response Policy Zones (RPZ)
- Develop DNS change management procedures

---

## CAVEATS

> **[Source: Standard Penetration Testing Disclaimer]**

- Testing was time-bound and scope-limited to DNS enumeration only
- Only the `inlanefreight.htb` zone was assessed in detail
- Network-level controls (firewalls, IDS) were not evaluated
- Absence of a finding does not imply absence of vulnerability
- Internal zone enumeration via subdomain bruteforcing was attempted but not exhaustively completed (see commands.log)

---

## APPENDICES

### APPENDIX A – FINDING SEVERITIES

> **[Source: Industry Standard – CVSS v3.1]**

| Rating | CVSS Score | Description |
|--------|------------|-------------|
| Critical | 9.0–10.0 | Immediate remediation required |
| High | 7.0–8.9 | Remediate within 30 days |
| Medium | 4.0–6.9 | Remediate within 90 days |
| Low | 0.1–3.9 | Remediate as resources permit |
| Informational | 0.0 | No immediate risk; awareness item |

### APPENDIX B – EXPLOITED HOSTS

> **[Source: Scan Logs]**

| Host | Method | Data Obtained |
|------|--------|---------------|
| 10.129.54.123 | AXFR Query | Complete zone file (11 records) |
| 10.129.54.123 | CHAOS TXT | Version: 9.16.1-Ubuntu |
| 10.129.54.123 | CHAOS TXT | Hostname: NIX02 |

### APPENDIX C – COMPROMISED USERS

> **[Source: N/A]**

No user accounts were compromised during this assessment. Testing was limited to DNS enumeration.

### APPENDIX D – CHANGES/HOST CLEANUP

> **[Source: N/A]**

No modifications were made to target systems. All testing was read-only reconnaissance.

### APPENDIX E – TOOLS USED

> **[Source: logs/commands.log, scan file headers]**

| Tool | Version | Purpose |
|------|---------|---------|
| dig | 9.20.15-2-Debian | DNS queries, zone transfers |
| dnsenum | N/A | Subdomain enumeration (attempted) |
| nslookup | N/A | NS record queries |

### APPENDIX F – LOG FILE REFERENCE

> **[Source: cases/footprinting/dns/]**

| File | Description |
|------|-------------|
| logs/commands.log | Command history from testing session |
| scans/dig.axfr-inlanefreight.htb-10.129.54.123.txt | Zone transfer results |
| scans/dig.ns-inlanefreight.htb-10.129.54.123.txt | NS record query |
| scans/dig.soa-inlanefreight.htb-10.129.54.123.txt | SOA record query |
| scans/dig.hostname-bind-10.129.54.123.txt | Hostname disclosure |
| scans/dig.version-bind-10.129.54.123.txt | Version disclosure |
| scans/dig.id-server-10.129.54.123.txt | ID server query |
| scans/dig.reverse-ptr-10.129.54.123.txt | Reverse DNS lookup |
| scans/dig.recursion-test-google.com-10.129.54.123.txt | Recursion test |
| scans/dig.root-ns-10.129.54.123.txt | Root NS query |
| scans/dig.a-NIX02.inlanefreight.htb-10.129.54.123.txt | A record verification |

### APPENDIX G – ANSWERS TO TECHNICAL TASKS

> **[Source: Analysis of scan logs]**

| Question | Answer | Source Log |
|----------|--------|------------|
| Q1: FQDN of DNS server | **ns.inlanefreight.htb** | dig.ns-inlanefreight.htb-10.129.54.123.txt |
| Q2: TXT Record (Zone Transfer) | *No HTB{...} format TXT record found in zone* | dig.axfr-inlanefreight.htb-10.129.54.123.txt |
| Q3: IPv4 of DC1 | *DC1 not present in discovered zone data* | dig.axfr-inlanefreight.htb-10.129.54.123.txt |
| Q4: FQDN ending x.x.x.203 | **mail1.inlanefreight.htb** (10.129.18.201) | dig.axfr-inlanefreight.htb-10.129.54.123.txt |

**Note:** Questions 2 and 3 reference records not present in the primary zone. The commands.log shows attempts to enumerate additional zones (internal.inlanefreight.htb, dev.inlanefreight.htb) which may contain these records. Additional zone transfer attempts against these subdomains are recommended.

---

**END OF REPORT**
