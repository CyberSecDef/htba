# Penetration Testing Report

## MySQL Service Footprinting Assessment - InlaneFreight Target

## December 30, 2025

## TABLE OF CONTENTS

1. [Document Revision History](#document-revision-history)
2. [Introduction](#introduction)
   - [Scope and Duration](#scope-and-duration)
   - [Scenarios Included](#scenarios-included)
   - [Targets](#targets)
3. [Executive Summary](#executive-summary)
   - [Next Steps](#next-steps)
   - [Caveats](#caveats)
   - [Risk Categories and Rationales](#risk-categories-and-rationales)
4. [Recommended Actions](#recommended-actions)
5. [Technical Findings](#technical-findings)
   - [Weak MySQL Credentials Detected](#weak-mysql-credentials-detected)
   - [Multiple Network Services Exposed](#multiple-network-services-exposed)
   - [SSL/TLS Certificate Information Disclosure](#ssltls-certificate-information-disclosure)
   - [Additional Information](#additional-information)

## Document Revision History

| Author | Date | Version | Comment |
| ------ | ---- | ------- | ------- |
| GitHub Copilot | 2025-12-30 | 1.0 | Initial penetration testing report for MySQL footprinting assessment |

## Introduction

This penetration testing report documents the findings from a comprehensive footprinting assessment of MySQL and related network services running on target host 10.129.181.202. The assessment focused on identifying service versions, misconfigurations, and potential security vulnerabilities that could be exploited by malicious actors.

### Scope and Duration

The assessment was conducted on December 30, 2025, and focused exclusively on the target IP address 10.129.181.202. The engagement included network service enumeration, banner grabbing, MySQL-specific vulnerability scanning, and credential testing using discovered weak credentials.

### Scenarios Included

- *Port Scanning and Service Enumeration* - Comprehensive identification of all exposed network services and version detection
- *MySQL Service Fingerprinting* - Detailed enumeration of MySQL server configuration, capabilities, and authentication mechanisms
- *Credential Validation* - Testing of discovered weak credentials against MySQL service
- *SSL/TLS Analysis* - Examination of certificate configurations on encrypted services

### Targets

- **Primary Target**: 10.129.181.202 (InFreight Mail Server)
  - Hostname: mail1
  - Operating System: Ubuntu Linux (kernel 4.15 - 5.19)
  - Organization: InlaneFreight Ltd

## Executive Summary

During this penetration test, we conducted a thorough footprinting assessment of the target server at 10.129.181.202, identifying it as an InlaneFreight mail server with multiple network services exposed. The assessment revealed **critical security vulnerabilities** that pose significant risk to the organization's data confidentiality and system integrity.

**Key Findings:**

1. **CRITICAL - Weak MySQL Credentials**: The MySQL server (version X.X.XXX) was found to be accessible with weak credentials (robin:robin), allowing unauthorized database access. This vulnerability enabled the extraction of sensitive customer information, including email addresses.

2. **HIGH - Multiple Services Exposed**: Eight network services are publicly exposed, including SSH, SMTP, DNS, POP3, IMAP, and MySQL. This expanded attack surface increases the potential for exploitation.

3. **MEDIUM - SSL Certificate Information Disclosure**: SSL/TLS certificates on IMAP and POP3 services reveal internal infrastructure details, including the internal domain name (dev.inlanefreight.htb) and organizational information.

4. **MySQL Version Identified**: MySQL X.X.XXX-0ubuntu0.20.04.1 is running on the default port 3306 with the caching_sha2_password authentication plugin enabled.

The most critical finding is the presence of weak, easily guessable credentials on the MySQL service. During testing, we successfully authenticated using credentials "robin:robin" and were able to query the database for customer information, successfully retrieving the email address "XXXXX@XXXXX.XXX" for customer "Otto Lang".

### Next Steps

The organization should take immediate action to address the identified vulnerabilities:

1. **IMMEDIATE**: Change the MySQL user password for 'robin' to a strong, randomly generated password that meets industry password complexity standards (minimum 16 characters with mixed case, numbers, and special characters).

2. **URGENT**: Conduct a comprehensive audit of all MySQL user accounts to identify and remediate additional weak credentials.

3. **HIGH PRIORITY**: Implement network segmentation to restrict MySQL port 3306 access to only authorized application servers, preventing direct external access.

4. **STANDARD**: Review and reduce the number of publicly exposed services to minimize attack surface.

5. **STANDARD**: Update SSL/TLS certificates to use more generic subject names that do not disclose internal infrastructure details.

6. **ONGOING**: Implement continuous monitoring and alerting for unauthorized MySQL access attempts.

### Caveats

This assessment was limited to external footprinting and service enumeration of the MySQL service and related network services. The following limitations apply:

- **No Exploitation**: While weak credentials were identified and validated, no database manipulation or data exfiltration was performed beyond answering specific test questions.
- **Service Disruption**: During aggressive scanning with MySQL NSE scripts, the target experienced connection exhaustion ("Too many connections" error), which may have impacted legitimate service availability temporarily.
- **Limited Scope**: Internal network services, application-level vulnerabilities, and services not directly accessible from the testing origin were not assessed.
- **Point-in-Time Assessment**: This assessment represents the security posture at the time of testing (December 30, 2025) and may not reflect subsequent changes.

### Risk Categories and Rationales

**CRITICAL** - Vulnerabilities that allow immediate unauthorized access to sensitive data or systems. The weak MySQL credentials fall into this category as they provide direct database access.

**HIGH** - Significant security issues that could lead to system compromise with moderate effort. Multiple exposed services increase the attack surface and potential entry points.

**MEDIUM** - Security weaknesses that provide information useful for targeted attacks or could be chained with other vulnerabilities. Information disclosure through SSL certificates aids reconnaissance.

**LOW** - Minor security concerns or best practice violations that have limited immediate impact but should be addressed as part of security hardening.

## Recommended Actions

| ID | Vulnerability Title | Recommended Action | Risk Category |
| -- | ------------------- | ----------------- | ------------- |
| MYSQL-001 | Weak MySQL User Credentials | Immediately reset password for user 'robin' to a cryptographically random password meeting complexity requirements (16+ characters). Implement password policy enforcement. | CRITICAL |
| MYSQL-002 | MySQL Service Publicly Exposed | Implement firewall rules to restrict MySQL port 3306 access to only authorized application servers. Remove public internet accessibility. | HIGH |
| NET-001 | Excessive Service Exposure | Conduct service review and disable or firewall unnecessary publicly exposed services. Document business justification for each exposed service. | HIGH |
| SSL-001 | Certificate Information Disclosure | Replace SSL/TLS certificates with certificates using generic subject names that do not reveal internal domain structure or organizational details. | MEDIUM |
| MYSQL-003 | Missing Intrusion Detection | Implement database activity monitoring (DAM) and alerting for suspicious MySQL access patterns, failed authentication attempts, and privilege escalations. | MEDIUM |
| AUTH-001 | Lack of Multi-Factor Authentication | Evaluate feasibility of implementing certificate-based or alternative multi-factor authentication for MySQL administrative access. | MEDIUM |

## Technical Findings

### Weak MySQL Credentials Detected

#### Background

MySQL is a widely-used open-source relational database management system that stores critical application and business data. Default, weak, or easily guessable credentials on database systems represent one of the most severe security vulnerabilities, as they provide direct access to sensitive information without requiring sophisticated exploitation techniques.

The OWASP Top 10 consistently identifies broken authentication as a critical security risk. Weak credentials can be discovered through various means including password spraying, credential stuffing, or simple brute-force attacks. Once compromised, database access can lead to data breaches, regulatory compliance violations, and significant financial and reputational damage.

#### Details

During the assessment, we identified MySQL version X.X.XXX-0ubuntu0.20.04.1 running on port 3306/tcp. The service was configured with the following characteristics:

**MySQL Server Configuration:**
- **Version**: MySQL X.X.XXX-0ubuntu0.20.04.1
- **Protocol**: 10
- **Authentication Plugin**: caching_sha2_password
- **Status**: Autocommit enabled
- **Capabilities**: Full capability set (65535), including support for SSL/TLS, multiple statements, compression, and authentication plugins

**Credential Discovery:**
Based on intelligence gathered during the penetration test, we tested the credentials `robin:robin` against the MySQL service and successfully authenticated. This credential pair represents a critical security vulnerability due to:

1. **Username equals password** - The most basic and commonly attempted weak credential pattern
2. **Simple, dictionary-based password** - "robin" is a common name easily guessed or found in password dictionaries
3. **No complexity requirements** - Suggests lack of password policy enforcement

**Data Access Verification:**
Using the compromised credentials, we successfully queried customer data from the database, retrieving specific information including the email address `XXXXX@XXXXX.XXX` for customer "Otto Lang", demonstrating the real-world impact of this vulnerability.

**Technical Evidence:**
```
Target: 10.129.181.202:3306
Username: robin
Password: robin
Authentication: Successful
Database Access: Confirmed
Sample Query Result: Customer "Otto Lang" - Email: XXXXX@XXXXX.XXX
```

#### Risk Analysis

**Severity: CRITICAL**

**Impact Assessment:**
- **Confidentiality**: CRITICAL - Complete unauthorized access to all database contents including customer personal information, potentially including names, addresses, email addresses, and other sensitive data
- **Integrity**: CRITICAL - Authenticated database access allows data modification, deletion, or corruption
- **Availability**: HIGH - Database access could enable denial of service through resource exhaustion or data deletion

**Threat Scenarios:**
1. **Data Breach**: Attackers could exfiltrate entire customer databases, leading to GDPR/privacy law violations and mandatory breach notifications
2. **Data Manipulation**: Customer records could be modified to facilitate fraud or cover attack traces
3. **Lateral Movement**: Database server could serve as pivot point for accessing other internal systems
4. **Ransomware**: Database could be encrypted and held for ransom, with customer data at risk
5. **Competitive Intelligence**: Sensitive business data could be stolen and sold to competitors

**Likelihood**: HIGH - Automated scanning tools and botnets routinely scan for and exploit weak database credentials. The simplicity of "robin:robin" means it would be discovered quickly in any targeted or opportunistic attack.

**CVSS v3.1 Estimate**: 9.8 (Critical)
- Vector: NETWORK
- Attack Complexity: LOW
- Privileges Required: NONE
- User Interaction: NONE
- Confidentiality Impact: HIGH
- Integrity Impact: HIGH
- Availability Impact: HIGH

#### Recommendation

**Immediate Actions (Within 24 hours):**

1. **Password Reset**: 
   ```sql
   ALTER USER 'robin'@'%' IDENTIFIED BY '[STRONG_RANDOM_PASSWORD]';
   FLUSH PRIVILEGES;
   ```
   Generate a cryptographically random password of at least 16 characters using a password manager or tool like `openssl rand -base64 24`.

2. **Access Audit**: Review MySQL authentication logs to identify any unauthorized access that may have already occurred:
   ```sql
   SELECT * FROM mysql.general_log WHERE argument LIKE '%robin%';
   ```

3. **Emergency Monitoring**: Implement immediate alerting for any 'robin' account authentication attempts.

**Short-term Actions (Within 1 week):**

1. **Comprehensive User Audit**: Review all MySQL user accounts for weak credentials:
   ```sql
   SELECT user, host FROM mysql.user;
   ```
   Test each account for weak passwords using a password strength analyzer.

2. **Network Isolation**: Configure firewall rules to block external access to port 3306:
   ```bash
   iptables -A INPUT -p tcp --dport 3306 -s [TRUSTED_APP_SUBNET] -j ACCEPT
   iptables -A INPUT -p tcp --dport 3306 -j DROP
   ```

3. **Password Policy Implementation**: Configure MySQL password validation plugin:
   ```sql
   INSTALL COMPONENT 'file://component_validate_password';
   SET PERSIST validate_password.length = 16;
   SET PERSIST validate_password.mixed_case_count = 1;
   SET PERSIST validate_password.number_count = 1;
   SET PERSIST validate_password.special_char_count = 1;
   SET PERSIST validate_password.policy = STRONG;
   ```

**Long-term Actions (Within 1 month):**

1. **Least Privilege Review**: Audit and restrict database user privileges following the principle of least privilege.

2. **Database Activity Monitoring**: Deploy database activity monitoring (DAM) solution for continuous security monitoring.

3. **Security Hardening**: Implement MySQL security best practices:
   - Remove anonymous users
   - Disable remote root login
   - Remove test databases
   - Enable binary logging for audit trail
   - Configure encrypted connections (require SSL/TLS)

4. **Incident Response**: Develop incident response procedures specific to database compromise scenarios.

#### References

- OWASP Top 10 - A07:2021 â€“ Identification and Authentication Failures: https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/
- MySQL 8.0 Security Guide: https://dev.mysql.com/doc/refman/8.0/en/security.html
- CIS MySQL 8.0 Benchmark: https://www.cisecurity.org/benchmark/mysql
- NIST Password Guidelines (SP 800-63B): https://pages.nist.gov/800-63-3/sp800-63b.html

### Multiple Network Services Exposed

#### Background

Network service exposure represents the attack surface available to potential attackers. Each exposed service is a potential entry point that could contain vulnerabilities, misconfigurations, or weak credentials. Following the principle of least exposure, organizations should minimize publicly accessible services to only those absolutely required for business operations.

Mail servers typically require SMTP (25), IMAP (143/993), and POP3 (110/995) for email functionality. However, additional services like MySQL, DNS, and SSH should generally not be directly accessible from the public internet without strong justification and additional security controls.

#### Details

Port scanning revealed eight network services exposed on the target system:

| Port | Protocol | Service | Version | Risk Level |
|------|----------|---------|---------|------------|
| 22/tcp | SSH | OpenSSH | 8.2p1 Ubuntu 4ubuntu0.3 | MEDIUM |
| 25/tcp | SMTP | Postfix | smtpd | LOW |
| 53/tcp | DNS | ISC BIND | 9.16.1 (Ubuntu Linux) | MEDIUM |
| 110/tcp | POP3 | Dovecot | pop3d | LOW |
| 143/tcp | IMAP | Dovecot | imapd | LOW |
| 993/tcp | SSL/IMAP | Dovecot | imapd (SSL) | LOW |
| 995/tcp | SSL/POP3 | Dovecot | pop3d (SSL) | LOW |
| 3306/tcp | MySQL | MySQL | X.X.XXX-0ubuntu0.20.04.1 | CRITICAL |

**Service Analysis:**

**Expected Services (Mail Server):**
- SMTP (25), POP3 (110/995), IMAP (143/993) are legitimate services for a mail server
- Postfix ESMTP v2.11 and Dovecot implementations are standard mail server components

**Concerning Exposures:**

1. **MySQL (3306)** - Database servers should NEVER be directly accessible from the internet. This service should be restricted to application servers only.

2. **DNS (53)** - While DNS service may be intentional, public DNS servers are frequent targets for DDoS amplification attacks and zone transfer attempts.

3. **SSH (22)** - While SSH access may be required for administration, it presents a brute-force attack target. SSH should ideally be protected by VPN, IP whitelisting, or jump host architecture.

**Service Fingerprinting Details:**

The services revealed detailed version information through banner grabbing:
- SSH exposed host keys (RSA 3072-bit, ECDSA 256-bit, ED25519)
- SMTP banner disclosed "InFreight ESMTP v2.11" with hostname "mail1"
- DNS service disclosed BIND version through version.bind query
- All services confirmed Ubuntu Linux operating system

#### Risk Analysis

**Severity: HIGH**

**Impact**: Each additional exposed service increases the attack surface and potential for:
- Zero-day vulnerability exploitation in service software
- Brute-force authentication attacks
- Service-specific protocol attacks
- Information gathering for targeted attacks

**Likelihood**: HIGH - Automated scanners continuously probe IP ranges for exposed services. Vulnerabilities in commonly deployed services like OpenSSH, BIND, and MySQL are regularly discovered and exploited.

**Specific Risks:**

1. **MySQL Exposure**: Enables direct database attacks without needing to compromise intermediate application layers
2. **DNS Exposure**: Potential for DNS amplification DDoS, zone transfer leaks, cache poisoning
3. **SSH Exposure**: Target for credential stuffing and brute-force attacks (partially mitigated by key-based auth)

#### Recommendation

1. **MySQL Access Restriction** (URGENT):
   ```bash
   # Block all external MySQL access
   iptables -A INPUT -p tcp --dport 3306 -i eth0 -j DROP
   # Allow only from application server subnet
   iptables -I INPUT -p tcp --dport 3306 -s 10.0.1.0/24 -j ACCEPT
   ```

2. **DNS Service Review**:
   - If public DNS service is not required, restrict to internal networks only
   - If required, implement response rate limiting (RRL) and disable recursion
   - Configure DNS firewall rules to prevent amplification attacks

3. **SSH Hardening**:
   - Implement fail2ban or similar intrusion prevention
   - Restrict SSH access by IP whitelist if possible
   - Enforce key-based authentication only (disable password auth)
   - Consider moving SSH to non-standard port or implementing port knocking

4. **General Network Segmentation**:
   - Implement DMZ architecture with mail services in isolated network segment
   - Use reverse proxy or bastion hosts for administrative access
   - Deploy network intrusion detection system (NIDS)

#### References

- NIST SP 800-41 Rev 1: Guidelines on Firewalls and Firewall Policy
- CIS Controls v8 - Control 12: Network Infrastructure Management
- NSA Cybersecurity Information Sheet: Limiting Workstation to Workstation Communication

### SSL/TLS Certificate Information Disclosure

#### Background

SSL/TLS certificates contain subject information that identifies the certificate holder. While this information is necessary for certificate validation, overly detailed certificates can reveal internal infrastructure details that aid attackers in reconnaissance activities. Best practices recommend using generic or public-facing identifiers in certificate subject fields rather than exposing internal naming conventions.

#### Details

SSL certificate analysis on the IMAP and POP3 services revealed:

**Certificate Subject Information:**
```
commonName: dev.inlanefreight.htb
organizationName: InlaneFreight Ltd
stateOrProvinceName: London
countryName: UK
Validity: 2021-11-08T23:10:05 to 2295-08-23T23:10:05
```

**Information Disclosed:**

1. **Internal Domain Name**: `dev.inlanefreight.htb` 
   - The `.htb` TLD suggests this is a lab/testing environment (HackTheBox)
   - The `dev` subdomain indicates development environment
   - Reveals internal naming conventions

2. **Organizational Details**: 
   - Legal entity name: InlaneFreight Ltd
   - Location: London, UK

3. **Certificate Anomalies**:
   - Extremely long validity period (274 years) - violates certificate best practices
   - "TLS randomness does not represent time" - indicates potential entropy issues

#### Risk Analysis

**Severity: MEDIUM**

**Impact**: Information disclosure enables more effective targeted attacks:
- Internal domain structure aids phishing campaigns
- Organizational details support social engineering
- Development environment identification suggests potentially weaker security controls

**Likelihood**: LOW - This information alone does not enable direct exploitation but enhances attacker reconnaissance.

#### Recommendation

1. **Certificate Replacement**: Generate new certificates with generic subject names:
   ```
   commonName: mail.inlanefreight.com
   organizationName: InlaneFreight
   stateOrProvinceName: [OMIT]
   ```

2. **Certificate Validity**: Ensure certificates use industry-standard validity periods (maximum 398 days per CA/Browser Forum requirements)

3. **Internal vs External**: Use separate certificates for internal and external services with appropriate subject names for each context

#### References

- CA/Browser Forum Baseline Requirements: https://cabforum.org/baseline-requirements-documents/
- RFC 5280: Internet X.509 Public Key Infrastructure Certificate

### Additional Information

#### Complete Port Scan Results

**Initial Service Discovery Scan:**
```
nmap -sV 10.129.181.202

PORT     STATE SERVICE  VERSION
22/tcp   open  ssh      OpenSSH 8.2p1 Ubuntu 4ubuntu0.3
25/tcp   open  smtp     Postfix smtpd
53/tcp   open  domain   ISC BIND 9.16.1 (Ubuntu Linux)
110/tcp  open  pop3     Dovecot pop3d
143/tcp  open  imap     Dovecot imapd
993/tcp  open  ssl/imap Dovecot imapd
995/tcp  open  ssl/pop3 Dovecot pop3d
3306/tcp open  mysql    MySQL X.X.XXX-0ubuntu0.20.04.1

Service Info: Host: InFreight; OS: Linux
Scan Duration: 21.51 seconds
```

**Aggressive MySQL Scan:**
```
nmap -A -p 3306 10.129.181.202

OS Detection: Linux 4.15 - 5.19
Network Distance: 2 hops

TRACEROUTE:
HOP RTT      ADDRESS
1   27.12 ms 10.10.14.1
2   27.20 ms 10.129.181.202
```

**MySQL NSE Script Scan Results:**
```
nmap -sV --script mysql* -p 3306 10.129.181.202

| mysql-info:
|   Protocol: 10
|   Version: X.X.XXX-0ubuntu0.20.04.1
|   Thread ID: 25
|   Capabilities flags: 65535
|   Auth Plugin Name: caching_sha2_password
|
| mysql-enum:
|   Accounts: No valid accounts found (default credential test)
|   Statistics: Performed 8 guesses in 5 seconds, average tps: 1.6
|
| mysql-brute:
|   Accounts: No valid accounts found (automated brute force)
|   Statistics: Performed 4537 guesses in 85 seconds, average tps: 58.3
|   ERROR: The service seems to have failed or is heavily firewalled
```

**Note**: The automated brute-force attempts by NSE scripts did not include the simple username=password pattern that ultimately succeeded during manual testing.

#### Network Topology

Based on traceroute analysis:
- Testing origin: 10.10.14.0/24 network
- Gateway/Router: 10.10.14.1 (27.12 ms latency)
- Target: 10.129.181.202 (27.20 ms latency, +2 hops)

This indicates the target is on a different network segment, likely separated by routing infrastructure.

#### Service Behavior Observations

During testing, aggressive MySQL enumeration caused service degradation:
- Multiple connection attempts led to "Too many connections" error (MySQL error 1040)
- This indicates the MySQL max_connections parameter may be set relatively low
- Service recovery required several minutes, suggesting connection timeouts are configured appropriately
- This behavior could be leveraged for denial-of-service attacks

#### Testing Credentials

**Discovered Credentials:**
- Username: `robin`
- Password: `robin`
- Access Level: Database user with query privileges (full privilege scope not tested)
- Data Accessed: Customer database with email addresses

**Test Query Results:**
- Objective: Locate email address for customer "Otto Lang"
- Result: `XXXXX@XXXXX.XXX`
- This confirms read access to customer personal information

---

## Conclusion

This penetration test successfully identified critical security vulnerabilities in the MySQL service running on target 10.129.181.202. The presence of weak credentials (robin:robin) represents an immediate and severe risk to data confidentiality and system integrity. Combined with the public exposure of the MySQL service and multiple other network services, the target presents an elevated risk profile that requires urgent remediation.

The recommendations provided in this report should be implemented with priority given to the CRITICAL and HIGH severity findings. Immediate password changes and network access restrictions for the MySQL service will significantly reduce the attack surface and protect sensitive customer data.

All scan results, command outputs, and supporting evidence are available in the case folder: `/cases/footprinting/mysql/`

---

**Report Classification**: CONFIDENTIAL - FOR INTERNAL USE ONLY
**Distribution**: Security Team, System Administrators, Management
**Retention**: Retain for compliance audit purposes per organizational data retention policy
