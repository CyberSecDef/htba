# OpenVAS Scan

**Technical Report, Red Team Playbooks, and Blue Team Playbooks**

---

## 1. Technical Report: Performing and Managing OpenVAS Scans

---

## 1.1 Purpose of the OpenVAS Scan Section

This section focuses on **executing vulnerability scans in OpenVAS (GVM)** using the **Greenbone Security Assistant (GSA)** interface. Unlike setup-centric sections, this material emphasizes:

* How scans (tasks) are created and managed
* How targets and credentials influence results
* Which scan configurations are safe and appropriate
* How scan runtime and performance should be handled

A key theme is **operational patience**: OpenVAS scans are thorough but slow, and analysts are encouraged to review findings incrementally rather than waiting for full completion .

---

## 1.2 The Scans Tab and Task Management

Within GSA, the **Scans** tab displays:

* Previously executed scans (tasks)
* Severity summaries
* Scan status (e.g., Done)
* Historical trends

### Tasks vs. Scans

In OpenVAS terminology:

* A **Task** defines *what* to scan and *how*
* A **Scan** is the execution instance of that task

Tasks are reusable and rely on:

* Targets
* Scan configurations
* Schedules
* Optional alerts

---

## 1.3 Scan Runtime Considerations

OpenVAS scans can take **30–120 minutes** depending on:

* Target size
* Network latency
* Scan configuration
* Credentialed vs unauthenticated scanning

Best practice is to:

* Review vulnerabilities as they appear
* Avoid waiting for full completion before analysis
* Expect longer runtimes compared to commercial scanners like Nessus

---

## 1.4 Target Configuration

### Why Targets Matter

Before creating a scan, **targets must be defined** under:
**Configuration → Targets**

Targets specify:

* Host(s) or host lists
* Port lists
* Alive test methods
* Authentication credentials

For this module:

* **Windows target:** `172.16.16.100`
* **Linux target:** `172.16.16.160` 

---

### Alive Test (Host Reachability)

The **Alive Test** determines how OpenVAS checks if a host is reachable.

* Default: **Scan Config Default**
* This leverages the **NVT Ping Host** test within an NVT Family

Misconfigured alive tests can result in:

* Missed hosts (false negatives)
* Excessive scan time
* Incomplete results

---

### Port Lists

Targets may define:

* All IANA-assigned TCP ports
* Custom port lists

Broader port lists increase coverage but also:

* Increase scan duration
* Increase network load
* Increase noise

---

## 1.5 Credentialed vs Unauthenticated Scanning

### Credentialed Scans

Authenticated scans typically use **high-privilege accounts**, such as:

* `root` (Linux)
* `Administrator` (Windows)

Advantages:

* Maximum vulnerability visibility
* Accurate patch detection
* Reduced false positives

Provided lab credentials:

* **Linux:** `htb-student_adm : HTB_@cademy_student!`
* **Windows:** `administrator : Academy_VA_adm1!` 

---

### Unauthenticated Scans

Unauthenticated scans rely on:

* Network probing
* Banner grabbing
* Service fingerprinting

They are:

* Less intrusive
* Less accurate
* More prone to false positives and negatives

---

## 1.6 Network Vulnerability Test (NVT) Families

OpenVAS scans rely on **NVT Families**, which group checks by category, such as:

* Windows
* Linux
* Web applications
* General services

Scan configurations select which NVT Families are active. This directly controls:

* Scan depth
* Risk of disruption
* Runtime

---

## 1.7 OpenVAS Scan Configurations

OpenVAS provides multiple predefined scan configurations. The module explicitly recommends **only the following**, as others may cause system disruptions:

### Base

* Enumerates host status and OS information
* **No vulnerability checks**

### Discovery

* Enumerates services, ports, hardware, and software
* **No vulnerability checks**

### Host Discovery

* Determines whether hosts are alive
* Uses ping
* **No vulnerability checks**

### System Discovery

* Expands on Discovery
* Attempts OS and hardware identification

### Full and Fast (Recommended)

* Uses intelligence to select optimal NVTs
* Balances safety and coverage
* Considered the safest vulnerability-focused option by OpenVAS 

---

## 1.8 Creating a New Scan Task

To create a scan:

1. Navigate to **Scans**
2. Click the **wizard icon**
3. Configure the task parameters

Key task fields include:

* **Name**
* **Scan Targets**
* **Alerts**
* **Schedule**
* **Scanner** (OpenVAS Default)
* **Scan Config** (e.g., Full and fast)
* **Apply Overrides**
* **Minimum QoD (Quality of Detection)**

---

### Quality of Detection (QoD)

**Min QoD** filters findings based on confidence:

* Higher QoD → fewer, more reliable results
* Lower QoD → more findings, higher false-positive risk

In the example:

* Min QoD set to **70%**

---

## 1.9 Task Execution and Results Association

Once saved:

* The task appears in the Scans list
* Results are tied to the associated target
* Historical tasks using the same target are visible

This allows:

* Trend analysis
* Repeated assessments
* Validation after remediation .

---

## 1.10 Key Operational Takeaways

* Targets must be configured before scans
* Credentialed scans provide exponentially better results
* Scan configuration choice impacts safety and runtime
* “Full and fast” is the safest vulnerability scan
* OpenVAS rewards patience and careful review
* Tasks and targets are reusable assessment building blocks

---

# 2. Red Team Playbooks

---

## Red Team Playbook 1: OpenVAS for Internal Enumeration

**Objective:**
Rapidly identify weak points after initial access.

**Approach:**

* Run unauthenticated scans for service discovery
* Pivot to authenticated scans once credentials are obtained
* Identify:

  * Missing patches
  * Weak configurations
  * Privilege escalation vectors

OpenVAS provides structured intelligence faster than manual enumeration alone.

---

## Red Team Playbook 2: Credential Abuse via Scan Accounts

**Objective:**
Exploit over-privileged scan credentials.

**Techniques:**

* Target OpenVAS admin accounts
* Extract stored credentials
* Reuse credentials for lateral movement

Scan accounts are often granted excessive access “for coverage.”

---

## Red Team Playbook 3: Timing Attacks Around Scan Windows

**Objective:**
Evade detection.

**Methods:**

* Operate between scheduled scans
* Temporarily revert changes before next scan
* Abuse systems excluded from scanning

Scanners report snapshots, not continuous truth.

---

# 3. Blue Team Playbooks

---

## Blue Team Playbook 1: Target and Credential Governance

**Objective:**
Prevent scanner misuse.

**Controls:**

* Least-privilege scan accounts
* Separate credentials per OS and environment
* Audit target definitions regularly
* Restrict who can modify targets

---

## Blue Team Playbook 2: Safe Scan Configuration Enforcement

**Objective:**
Avoid self-inflicted outages.

**Practices:**

* Standardize approved scan configs
* Prefer “Full and fast”
* Avoid experimental or aggressive NVT families
* Test new configurations in non-production environments

---

## Blue Team Playbook 3: Result Validation and Remediation Workflow

**Objective:**
Turn scan data into security improvements.

**Process:**

1. Review findings incrementally
2. Validate high-severity issues
3. Prioritize using CVSS + asset criticality
4. Remediate
5. Re-scan using same task for comparison

---

## Blue Team Playbook 4: Monitoring and Detection

**Objective:**
Detect abuse of scanning infrastructure.

**Indicators:**

* Credential use outside scan windows
* Scan activity from unexpected IPs
* Unauthorized target modifications

Scanner misuse should be treated as a **security incident**.

---

## Summary

* OpenVAS scanning is task- and target-driven
* Proper target and credential configuration is critical
* Scan configurations determine safety and depth
* “Full and fast” is the recommended vulnerability scan
* Credentialed scans provide maximum insight but carry risk
* Both attackers and defenders can exploit misconfigured scanning

