# Advanced Settings (Nessus)

**Technical Report, Red Team Playbooks, and Blue Team Playbooks**

---

## 1. Technical Report: Advanced Nessus Configuration

---

## 1.1 Purpose of Advanced Settings

The Advanced Settings section moves Nessus from a **generic vulnerability scanner** into a **precision assessment platform**. These settings allow analysts to:

* Create reusable, targeted scan configurations
* Control which vulnerabilities are tested and reported
* Reduce false positives and noise
* Perform deep, credentialed assessments across hosts, services, and databases
* Align scanning behavior with operational and business constraints

In short, this is where Nessus becomes **useful at scale**, rather than merely informative .

---

## 1.2 Scan Policies

### 1.2.1 What Scan Policies Are

A **scan policy** is a saved, reusable scan configuration. Policies allow an organization to define *how* Nessus scans, independent of *what* it scans.

Key characteristics:

* Stored centrally
* Reusable across scans
* Exportable and importable between Nessus instances
* Appear as templates under **User Defined** scan templates

This enables consistent scanning across:

* Clients
* Environments
* Assessment types (internal, external, web, evasive, compliance)

---

### 1.2.2 Use Cases for Scan Policies

Common real-world scenarios include:

* **Low-and-slow scans** to reduce detection
* **Web-focused scans** with crawling and RFI testing enabled
* **Credentialed internal scans** using multiple credential sets
* **Client-specific scans** matching contractual scope

Policies prevent analysts from **re-inventing scan configurations** for every engagement.

---

## 1.3 Creating a Scan Policy

To create a policy:

1. Select **New Policy**
2. Choose a base scan type
3. Customize settings, credentials, and plugins
4. Save the policy

The module uses **Advanced Scan** as the base, which provides:

* No preset assumptions
* Maximum configurability
* Full control over scan behavior

Once saved, the policy appears under **User Defined** scan templates and can be selected when creating new scans .

---

## 1.4 Nessus Plugins

### 1.4.1 Plugin Architecture

Nessus operates using plugins written in **Nessus Attack Scripting Language (NASL)**. Each plugin represents a specific check and includes:

* Vulnerability description
* Severity
* Detection logic
* Remediation guidance

At the time of writing:

* ~145,000 plugins
* Covering ~58,000 CVEs
* Including ~30,000 Bugtraq IDs

This breadth is why Nessus remains a dominant scanner.

---

### 1.4.2 Plugin Severity Levels

Plugins are categorized as:

* **Critical**
* **High**
* **Medium**
* **Low**
* **Informational**

Severity influences:

* Reporting
* Prioritization
* Alerting workflows

However, severity does **not automatically equal risk**.

---

## 1.5 Handling False Positives with Plugin Rules

### 1.5.1 Why Plugin Rules Matter

Not all findings are actionable. Some detections are:

* Environment-specific
* Intentionally configured
* Non-exploitable by design

Example given:

* Microsoft DirectAccess allowing weak or null cipher suites
* This behavior is intentional for performance reasons

Blindly fixing such findings can **break production systems**.

---

### 1.5.2 Plugin Rules

Plugin rules allow analysts to:

* Hide specific findings
* Change severity
* Scope exclusions to:

  * Specific hosts
  * Specific plugins
  * Optional expiration dates

Rules are managed under **Resources → Plugin Rules**.

Common exclusions:

* SSL Self-Signed Certificate
* Legacy protocol findings where compensating controls exist

This reduces noise **without disabling detection globally** .

---

## 1.6 Credentialed Scanning

### 1.6.1 Purpose of Credentialed Scans

Credentialed scans dramatically increase accuracy by allowing Nessus to:

* Inspect patch levels directly
* Query system configuration
* Enumerate users, services, and permissions

This eliminates guesswork based solely on banners or versions.

---

### 1.6.2 Supported Authentication Methods

#### Host Authentication

**Linux / Unix**

* SSH (password, key, certificate)
* Kerberos

**Windows**

* Password
* Kerberos
* LM hash
* NTLM hash

Global options include:

* Never sending credentials in the clear
* Disabling NTLMv1
* Optional service activation (e.g., Remote Registry)

---

### 1.6.3 Database Authentication

Nessus supports credentialed scanning for:

* Oracle
* PostgreSQL
* DB2
* MySQL
* SQL Server
* MongoDB
* Sybase

This allows detection of:

* Weak database credentials
* Missing patches
* Insecure configurations

---

### 1.6.4 Plaintext Service Authentication

Nessus can authenticate to services such as:

* FTP
* HTTP
* IMAP
* IPMI
* Telnet

While powerful, plaintext authentication:

* Must be used cautiously
* Should be restricted to test environments or explicit authorization

---

### 1.6.5 Verifying Credential Success

Nessus reports whether authentication succeeded. Example output:

* “Microsoft SQL Server Login Possible”

This confirmation is critical—failed authentication silently degrades scan quality.

---

## 1.7 Key Operational Takeaways

* Scan policies enable consistency and scale
* Plugins are powerful but must be curated
* Plugin rules are essential for managing false positives
* Credentialed scans provide the highest value
* Credentials used for scanning are **high-risk assets**

---

# 2. Red Team Playbooks

---

## Red Team Playbook 1: Targeting Scan Policies

**Objective:**
Exploit predictable scanning behavior.

**Techniques:**

* Identify standard scan schedules
* Profile scan aggressiveness
* Operate between scans
* Deploy changes temporarily reverted after scans

**Insight:**
Organizations often rely on scan results as truth—timing matters.

---

## Red Team Playbook 2: Credential Abuse via Scanners

**Objective:**
Leverage scanning credentials for lateral movement.

**Approach:**

* Compromise Nessus host or credentials
* Reuse scanning accounts elsewhere
* Abuse excessive privileges granted “for scanning convenience”

Scanner credentials are frequently **over-privileged**.

---

## Red Team Playbook 3: Living in the Noise

**Objective:**
Blend malicious activity with expected scanner behavior.

**Examples:**

* RID enumeration
* Service probing
* Auth attempts

If it looks like Nessus, it often gets ignored.

---

# 3. Blue Team Playbooks

---

## Blue Team Playbook 1: Scan Policy Governance

**Objective:**
Prevent unsafe or inconsistent scanning.

**Controls:**

* Standardize approved policies
* Version-control exported policies
* Require review before policy changes
* Separate aggressive scans from production scans

---

## Blue Team Playbook 2: Plugin Rule Hygiene

**Objective:**
Reduce noise without masking risk.

**Practices:**

* Document justification for every plugin rule
* Set expiration dates where possible
* Periodically review hidden findings
* Avoid global exclusions unless absolutely necessary

---

## Blue Team Playbook 3: Securing Scan Credentials

**Objective:**
Prevent scanner compromise becoming a breach.

**Controls:**

* Least-privilege scan accounts
* Separate credentials per environment
* Rotate regularly
* Monitor for credential reuse outside Nessus

---

## Blue Team Playbook 4: Detecting Scanner Abuse

**Objective:**
Identify misuse of scanning capabilities.

**Indicators:**

* Authentication attempts outside scan windows
* Credential use from non-scanner hosts
* Enumeration without corresponding scans

Treat this as **incident-level activity**, not a configuration issue.

---

## Summary

* Advanced Settings are where Nessus becomes operationally effective
* Scan policies provide consistency and efficiency
* Plugins and plugin rules must be actively managed
* Credentialed scanning is high-value but high-risk
* Both attackers and defenders can abuse misconfigured scanners

