# Getting Started with OpenVAS

**Technical Report, Red Team Playbooks, and Blue Team Playbooks**

---

## 1. Technical Report: OpenVAS Overview and Initial Setup

---

## 1.1 What OpenVAS Is and Why It Matters

**OpenVAS** is an open-source vulnerability scanning engine developed by **Greenbone Networks** and delivered as part of the broader **Greenbone Vulnerability Management (GVM)** framework. Unlike many commercial scanners, OpenVAS is:

* Publicly available
* Free to use
* Fully capable of enterprise-grade vulnerability assessments

OpenVAS supports:

* Network-based vulnerability scanning
* Authenticated and unauthenticated testing
* Continuous feed updates for vulnerability checks

Because of its accessibility and depth, OpenVAS is widely used by:

* Red teams
* Blue teams
* Security researchers
* Organizations with limited licensing budgets .

---

## 1.2 OpenVAS Within Greenbone Vulnerability Management (GVM)

OpenVAS is **not a standalone product** in practice—it operates as a scanning component within GVM, which includes:

* **OpenVAS Scanner** – executes vulnerability tests
* **Greenbone Vulnerability Manager (gvmd)** – manages scan data, users, and results
* **Greenbone Security Assistant (GSA)** – web-based user interface
* **Feed Services** – vulnerability tests (NVTs), CVE data, and metadata

Understanding this architecture is important because troubleshooting, performance tuning, and security hardening often involve **multiple services**, not just the scanner binary.

---

## 1.3 Platform and Installation Context

The module demonstrates OpenVAS installation on **Parrot Security OS**, though OpenVAS is also available on Kali and other Debian-based distributions.

Important notes:

* In later lab sections, OpenVAS is **pre-installed**
* Manual installation is still critical knowledge for:

  * Self-hosted deployments
  * Production environments
  * Troubleshooting broken installations

---

## 1.4 Installing OpenVAS / GVM

### Step 1: System Update

Before installation, the system is fully updated:

```
sudo apt-get update && apt-get -y full-upgrade
```

This ensures:

* Dependency compatibility
* Reduced installation errors
* Stable feed synchronization

---

### Step 2: Install GVM and OpenVAS

Installation is performed with:

```
sudo apt-get install gvm && openvas
```

This installs:

* Core GVM services
* OpenVAS scanner
* Supporting libraries and dependencies

---

### Step 3: Initial Setup (`gvm-setup`)

The `gvm-setup` command initializes the OpenVAS environment:

```
gvm-setup
```

This process:

* Creates scanner certificates
* Initializes and migrates databases
* Creates an administrative user
* Downloads and synchronizes vulnerability feeds
* Generates and displays an **admin password**

⚠️ **Operational note:**
This process can take **up to 30 minutes**, largely due to feed synchronization. Interrupting it can corrupt the installation and require a full rebuild .

---

## 1.5 Starting OpenVAS Services

Once setup is complete, OpenVAS services are started with:

```
gvm-start
```

This launches:

* OpenVAS scanner daemon
* Greenbone Vulnerability Manager
* Greenbone Security Assistant (web UI)

The output confirms:

* Service startup status
* Listening ports
* Web UI URL

---

## 1.6 Accessing the OpenVAS Web Interface

OpenVAS is managed through the **Greenbone Security Assistant (GSA)**.

Typical access:

* Local deployment: `https://127.0.0.1:9392`
* Hack The Box lab environment: `https://<IP>:8080`

Authentication uses:

* Admin credentials generated during setup
* Or lab-provided credentials

The web interface is used for:

* Creating targets
* Configuring scans
* Managing credentials
* Reviewing reports .

---

## 1.7 Hack The Box OpenVAS Lab Environment

Hack The Box provides a preconfigured OpenVAS VM for skills assessments.

Key details:

* OpenVAS pre-installed
* Targets already running
* Web UI accessible via HTTPS
* Credentials provided:

  * Username: `htb-student`
  * Password: `HTB_@cademy_student!`

This environment allows learners to focus on **scanner usage and interpretation**, not setup complexity.

---

## 1.8 Key Operational Characteristics of OpenVAS

* Feed updates are critical to accuracy
* Initial setup is resource-intensive
* OpenVAS is powerful but less “polished” than commercial tools
* Misconfiguration can result in:

  * Incomplete scans
  * Slow performance
  * Authentication failures

Despite this, OpenVAS remains one of the most capable **free vulnerability scanners** available.

---

# 2. Red Team Playbooks

---

## Red Team Playbook 1: OpenVAS for Internal Reconnaissance

**Objective:**
Rapidly enumerate vulnerabilities after gaining internal access.

**Approach:**

1. Deploy or access OpenVAS internally
2. Run unauthenticated scans to map services
3. Use authenticated scans if credentials are obtained
4. Identify:

   * Patch gaps
   * Weak services
   * Misconfigurations

**Why OpenVAS Works:**
Its extensive NVT feed rivals commercial scanners when properly updated.

---

## Red Team Playbook 2: Targeting OpenVAS Infrastructure

**Objective:**
Abuse poorly secured scanning infrastructure.

**Targets:**

* OpenVAS admin accounts
* Stored scan credentials
* GVM databases

Compromising OpenVAS can provide:

* Network topology insight
* Credential reuse opportunities
* Scan blind spot manipulation

---

## Red Team Playbook 3: Exploiting Scanner Trust

**Objective:**
Blend into expected security activity.

**Techniques:**

* Perform reconnaissance during scan windows
* Mimic OpenVAS traffic patterns
* Abuse environments where scanning noise is ignored

---

# 3. Blue Team Playbooks

---

## Blue Team Playbook 1: Secure OpenVAS Deployment

**Objective:**
Prevent scanner compromise.

**Controls:**

* Restrict web UI access
* Enforce strong authentication
* Patch OpenVAS host regularly
* Monitor GVM service logs

---

## Blue Team Playbook 2: Feed and Update Management

**Objective:**
Ensure scan accuracy.

**Practices:**

* Verify feed synchronization regularly
* Monitor for feed update failures
* Validate scan results against known CVEs

Out-of-date feeds equal **false security**.

---

## Blue Team Playbook 3: Credentialed Scan Governance

**Objective:**
Balance visibility with risk.

**Actions:**

* Use least-privilege scan accounts
* Separate credentials by environment
* Rotate credentials regularly
* Monitor authentication success rates

---

## Blue Team Playbook 4: Operational Integration

**Objective:**
Turn OpenVAS into a vulnerability management tool, not a one-off scanner.

**Workflow:**

* Schedule regular scans
* Export and analyze results
* Integrate findings with ticketing and SIEM
* Track remediation trends over time

---

## Summary

* OpenVAS is a powerful, open-source vulnerability scanner
* It operates as part of the GVM ecosystem
* Installation and setup are non-trivial but manageable
* Feed updates are critical
* OpenVAS is valuable for both offensive and defensive teams
* Security and governance of the scanner itself are essential
