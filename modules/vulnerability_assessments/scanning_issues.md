# Scanning Issues

**Technical Report, Red Team Playbooks, and Blue Team Playbooks**

---

## 1. Technical Report: Scanning Issues and Operational Risk

---

## 1.1 Why Scanning Issues Matter

While Nessus is a powerful and widely adopted vulnerability scanning platform, **improperly planned or poorly tuned scans can cause real harm**. Common consequences include:

* False positives that waste remediation effort
* False negatives that create blind spots
* Performance degradation
* Network congestion
* Service crashes or outages

For this reason, vulnerability scanning must be treated as an **operational activity**, not a purely technical one. Communication, scoping, and tuning are as important as the scan itself .

---

## 1.2 Pre-Scan Communication and Scoping

Before running any scan, it is critical to communicate with:

* Clients (external engagements)
* Internal stakeholders (internal scanning)
* Network and system owners

Key scoping questions include:

* Are there **legacy or fragile systems** that must be excluded?
* Are there **high-availability or mission-critical systems**?
* Should some systems be scanned:

  * Outside business hours
  * With reduced aggressiveness
  * Separately from the main scan set

Failure to address these questions can result in **unplanned outages** and strained trust.

---

## 1.3 Unexpected Scan Results

Nessus scans may occasionally return confusing or incorrect results, such as:

* All ports reported open
* No ports reported open
* Excessive informational findings

These issues often stem from **firewall behavior**, not from the target host itself.

---

## 1.4 Firewall-Induced False Positives

Some firewalls respond to probes in ways that confuse scanners:

* Sending `ICMP Unreachable` responses
* Responding generically to port probes

Nessus may interpret these responses as:

* A live host
* Open services
* Informational vulnerabilities

### Mitigation Technique

A common fix is to:

* Use an **Advanced Scan**
* Disable **“Ping the remote host”**

This prevents Nessus from relying on ICMP to determine host liveness and forces it to proceed with service-level testing instead, significantly reducing false positives in these scenarios .

---

## 1.5 Rate Limiting and Performance Tuning

In sensitive or heavily loaded environments, scan aggressiveness must be tuned.

### Performance Options

Key setting:

* **Max Concurrent Checks Per Host**

Reducing this value:

* Limits how many plugins run simultaneously
* Reduces CPU, memory, and network load
* Lowers the risk of service degradation

This is especially important for:

* Public-facing web applications
* Systems under constant production load
* Low-resource hosts

---

## 1.6 Excluding Fragile and Legacy Systems

Certain systems should often be excluded entirely, including:

* Legacy operating systems
* Unsupported applications
* Network printers
* Specialized or proprietary devices

If a host is of particular concern, options include:

* Removing it from scan scope
* Scanning it separately
* Using custom rules via the `nessusd.rules` file

This allows fine-grained control without compromising the overall assessment .

---

## 1.7 Safe Checks and Denial-of-Service Risks

### Safe Checks

The **Safe Checks** option should almost always be enabled.

Safe checks:

* Disable potentially dangerous plugins
* Avoid tests that could crash services or daemons
* Reduce scan duration

While safe checks **do not guarantee zero impact**, they significantly lower risk.

---

### Denial-of-Service (DoS) Plugins

Unless explicitly authorized:

* **DoS checks should never be run**

These plugins can:

* Crash services
* Exhaust resources
* Cause outages indistinguishable from real attacks

---

## 1.8 Logging and Change Control

After scans complete:

* Maintain detailed scan logs
* Record:

  * Timeframes
  * Targets
  * Scan profiles
  * Credentials used

These logs are essential if:

* An incident occurs
* Performance issues are reported
* Attribution is required

Scanning without logs is operational malpractice.

---

## 1.9 Network Impact of Vulnerability Scanning

Vulnerability scanning generates **substantial network traffic**, even for a single host.

The section demonstrates this using `vnstat` to monitor interface traffic before and during a scan.

### Observed Effects

* Traffic increases from negligible levels to:

  * Hundreds of kilobits per second
  * Hundreds of packets per second
* Total packets and bytes transferred rise dramatically in under a minute

This illustrates that:

* Scanning can saturate low-bandwidth links
* Congested networks amplify scan impact
* Untuned scans can disrupt normal operations .

---

## 1.10 Key Operational Takeaways

* Vulnerability scans are **not passive**
* Firewalls can distort results
* Rate limiting is mandatory in sensitive environments
* Safe checks should be enabled by default
* Network impact must be measured and managed
* Communication prevents incidents

---

# 2. Red Team Playbooks

---

## Red Team Playbook 1: Hiding Behind Scan Noise

**Objective:**
Blend malicious activity with expected scanning traffic.

**Techniques:**

* Conduct reconnaissance during scheduled scan windows
* Mimic scanner behaviors (port sweeps, service probes)
* Abuse environments where scanning noise is ignored

**Insight:**
High scan noise often trains defenders to ignore early indicators.

---

## Red Team Playbook 2: Exploiting Scan Avoidance

**Objective:**
Target systems excluded from scans.

**Targets:**

* Legacy systems
* Printers
* OT/ICS devices
* High-availability systems excluded for safety

These systems frequently:

* Lack patches
* Run outdated software
* Receive less scrutiny

---

## Red Team Playbook 3: Firewall Behavior Abuse

**Objective:**
Leverage firewall quirks to evade detection.

**Approach:**

* Exploit ICMP handling oddities
* Use non-standard ports
* Hide services behind misleading responses

Scanners trust network behavior more than attackers do.

---

# 3. Blue Team Playbooks

---

## Blue Team Playbook 1: Scan Readiness Checklist

**Objective:**
Prevent scan-induced incidents.

**Checklist:**

* Stakeholder notification completed
* Sensitive systems identified
* Scan profile approved
* Safe checks enabled
* Rate limits configured

---

## Blue Team Playbook 2: False Positive Triage

**Objective:**
Prevent remediation waste.

**Process:**

1. Identify patterns of false positives
2. Correlate with firewall behavior
3. Adjust scan options (e.g., disable ping)
4. Document tuning decisions

---

## Blue Team Playbook 3: Network Impact Monitoring

**Objective:**
Detect and manage scan-related congestion.

**Actions:**

* Monitor traffic during scans
* Establish baseline scan bandwidth
* Alert on excessive deviations
* Reschedule or throttle problematic scans

---

## Blue Team Playbook 4: Incident Correlation

**Objective:**
Distinguish scans from attacks.

**Controls:**

* Centralized scan logging
* Change management records
* Clear scanner IP allowlists

If you can’t prove it was a scan, assume it wasn’t.

---

## Summary

* Vulnerability scanning introduces real operational risk
* Misconfigured scans cause false results and outages
* Firewalls frequently distort scan accuracy
* Rate limiting and safe checks are essential controls
* Network impact must be measured, not assumed
* Communication is the most effective mitigation
